/*! For license information please see gridviz-parquet.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.gviz_par=e():t.gviz_par=e()}(self,(()=>(()=>{"use strict";var t={d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(){}function i(t){return null==t?n:function(){return this.querySelector(t)}}function r(){return[]}function s(t){return null==t?r:function(){return this.querySelectorAll(t)}}function o(t){return function(){return this.matches(t)}}function a(t){return function(e){return e.matches(t)}}t.r(e),t.d(e,{ParquetGrid:()=>jc,TiledParquetGrid:()=>Qc,addMultiScaleParquetGridLayer:()=>il,addMultiScaleTiledParquetGridLayer:()=>al,addParquetGridLayer:()=>el,addTiledParquetGridLayer:()=>sl,makeMultiScaleParquetGridDataset:()=>nl,makeMultiScaleTiledParquetGridDataset:()=>ol,makeParquetGridDataset:()=>tl,makeTiledParquetGridDataset:()=>rl});var u=Array.prototype.find;function c(){return this.firstElementChild}var l=Array.prototype.filter;function h(){return Array.from(this.children)}function d(t){return new Array(t.length)}function f(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function p(t,e,n,i,r,s){for(var o,a=0,u=e.length,c=s.length;a<c;++a)(o=e[a])?(o.__data__=s[a],i[a]=o):n[a]=new f(t,s[a]);for(;a<u;++a)(o=e[a])&&(r[a]=o)}function y(t,e,n,i,r,s,o){var a,u,c,l=new Map,h=e.length,d=s.length,p=new Array(h);for(a=0;a<h;++a)(u=e[a])&&(p[a]=c=o.call(u,u.__data__,a,e)+"",l.has(c)?r[a]=u:l.set(c,u));for(a=0;a<d;++a)c=o.call(t,s[a],a,s)+"",(u=l.get(c))?(i[a]=u,u.__data__=s[a],l.delete(c)):n[a]=new f(t,s[a]);for(a=0;a<h;++a)(u=e[a])&&l.get(p[a])===u&&(r[a]=u)}function b(t){return t.__data__}function v(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function m(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}f.prototype={constructor:f,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var g="http://www.w3.org/1999/xhtml";const _={svg:"http://www.w3.org/2000/svg",xhtml:g,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function w(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),_.hasOwnProperty(e)?{space:_[e],local:t}:t}function S(t){return function(){this.removeAttribute(t)}}function x(t){return function(){this.removeAttributeNS(t.space,t.local)}}function I(t,e){return function(){this.setAttribute(t,e)}}function A(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function T(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function M(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function B(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function O(t){return function(){this.style.removeProperty(t)}}function D(t,e,n){return function(){this.style.setProperty(t,e,n)}}function N(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function F(t,e){return t.style.getPropertyValue(e)||B(t).getComputedStyle(t,null).getPropertyValue(e)}function L(t){return function(){delete this[t]}}function E(t,e){return function(){this[t]=e}}function U(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function C(t){return t.trim().split(/^|\s+/)}function k(t){return t.classList||new P(t)}function P(t){this._node=t,this._names=C(t.getAttribute("class")||"")}function z(t,e){for(var n=k(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function R(t,e){for(var n=k(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function j(t){return function(){z(this,t)}}function V(t){return function(){R(this,t)}}function $(t,e){return function(){(e.apply(this,arguments)?z:R)(this,t)}}function Y(){this.textContent=""}function G(t){return function(){this.textContent=t}}function W(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function q(){this.innerHTML=""}function Z(t){return function(){this.innerHTML=t}}function H(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function X(){this.nextSibling&&this.parentNode.appendChild(this)}function K(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function J(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===g&&e.documentElement.namespaceURI===g?e.createElement(t):e.createElementNS(n,t)}}function Q(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function tt(t){var e=w(t);return(e.local?Q:J)(e)}function et(){return null}function nt(){var t=this.parentNode;t&&t.removeChild(this)}function it(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function rt(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function st(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,s=e.length;i<s;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function ot(t,e,n){return function(){var i,r=this.__on,s=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),void(i.value=e);this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function at(t,e,n){var i=B(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function ut(t,e){return function(){return at(this,t,e)}}function ct(t,e){return function(){return at(this,t,e.apply(this,arguments))}}P.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var lt=[null];function ht(t,e){this._groups=t,this._parents=e}function dt(){return new ht([[document.documentElement]],lt)}ht.prototype=dt.prototype={constructor:ht,select:function(t){"function"!=typeof t&&(t=i(t));for(var e=this._groups,n=e.length,r=new Array(n),s=0;s<n;++s)for(var o,a,u=e[s],c=u.length,l=r[s]=new Array(c),h=0;h<c;++h)(o=u[h])&&(a=t.call(o,o.__data__,h,u))&&("__data__"in o&&(a.__data__=o.__data__),l[h]=a);return new ht(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):s(t);for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var a,u=e[o],c=u.length,l=0;l<c;++l)(a=u[l])&&(i.push(t.call(a,a.__data__,l,u)),r.push(a));return new ht(i,r)},selectChild:function(t){return this.select(null==t?c:function(t){return function(){return u.call(this.children,t)}}("function"==typeof t?t:a(t)))},selectChildren:function(t){return this.selectAll(null==t?h:function(t){return function(){return l.call(this.children,t)}}("function"==typeof t?t:a(t)))},filter:function(t){"function"!=typeof t&&(t=o(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,a=e[r],u=a.length,c=i[r]=[],l=0;l<u;++l)(s=a[l])&&t.call(s,s.__data__,l,a)&&c.push(s);return new ht(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,b);var n,i=e?y:p,r=this._parents,s=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=s.length,a=new Array(o),u=new Array(o),c=new Array(o),l=0;l<o;++l){var h=r[l],d=s[l],f=d.length,m=v(t.call(h,h&&h.__data__,l,r)),g=m.length,_=u[l]=new Array(g),w=a[l]=new Array(g);i(h,d,_,w,c[l]=new Array(f),m,e);for(var S,x,I=0,A=0;I<g;++I)if(S=_[I]){for(I>=A&&(A=I+1);!(x=w[A])&&++A<g;);S._next=x||null}}return(a=new ht(a,r))._enter=u,a._exit=c,a},enter:function(){return new ht(this._enter||this._groups.map(d),this._parents)},exit:function(){return new ht(this._exit||this._groups.map(d),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,s=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&(r=e(r))&&(r=r.selection()),null==n?s.remove():n(s),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,o=Math.min(r,s),a=new Array(r),u=0;u<o;++u)for(var c,l=n[u],h=i[u],d=l.length,f=a[u]=new Array(d),p=0;p<d;++p)(c=l[p]||h[p])&&(f[p]=c);for(;u<r;++u)a[u]=n[u];return new ht(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],s=r.length-1,o=r[s];--s>=0;)(i=r[s])&&(o&&4^i.compareDocumentPosition(o)&&o.parentNode.insertBefore(i,o),o=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=m);for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var o,a=n[s],u=a.length,c=r[s]=new Array(u),l=0;l<u;++l)(o=a[l])&&(c[l]=o);c.sort(e)}return new ht(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,s=e[n],o=0,a=s.length;o<a;++o)(r=s[o])&&t.call(r,r.__data__,o,s);return this},attr:function(t,e){var n=w(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?x:S:"function"==typeof e?n.local?M:T:n.local?A:I)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?O:"function"==typeof e?N:D)(t,e,null==n?"":n)):F(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?L:"function"==typeof e?U:E)(t,e)):this.node()[t]},classed:function(t,e){var n=C(t+"");if(arguments.length<2){for(var i=k(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?$:e?j:V)(n,e))},text:function(t){return arguments.length?this.each(null==t?Y:("function"==typeof t?W:G)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?q:("function"==typeof t?H:Z)(t)):this.node().innerHTML},raise:function(){return this.each(X)},lower:function(){return this.each(K)},append:function(t){var e="function"==typeof t?t:tt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:tt(t),r=null==e?et:"function"==typeof e?e:i(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(nt)},clone:function(t){return this.select(t?rt:it)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,s=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),o=s.length;if(!(arguments.length<2)){for(a=e?ot:st,i=0;i<o;++i)this.each(a(s[i],e,n));return this}var a=this.node().__on;if(a)for(var u,c=0,l=a.length;c<l;++c)for(i=0,u=a[c];i<o;++i)if((r=s[i]).type===u.type&&r.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?ct:ut)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],s=0,o=r.length;s<o;++s)(i=r[s])&&(yield i)}};const ft=dt;function pt(t){return"string"==typeof t?new ht([[document.querySelector(t)]],[document.documentElement]):new ht([[t]],lt)}var yt={value:()=>{}};function bt(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new vt(i)}function vt(t){this._=t}function mt(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function gt(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=yt,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}vt.prototype=bt.prototype={constructor:vt,on:function(t,e){var n,i,r=this._,s=(i=r,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),o=-1,a=s.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=s[o]).type)r[n]=gt(r[n],t.name,e);else if(null==e)for(n in r)r[n]=gt(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=s[o]).type)&&(n=mt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new vt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),s=0;s<n;++s)r[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=0,n=(i=this._[t]).length;s<n;++s)i[s].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};const _t=bt,wt={capture:!0,passive:!1};function St(t){t.preventDefault(),t.stopImmediatePropagation()}function xt(t){return((t=Math.exp(t))+1/t)/2}const It=function t(e,n,i){function r(t,r){var s,o,a=t[0],u=t[1],c=t[2],l=r[0],h=r[1],d=r[2],f=l-a,p=h-u,y=f*f+p*p;if(y<1e-12)o=Math.log(d/c)/e,s=function(t){return[a+t*f,u+t*p,c*Math.exp(e*t*o)]};else{var b=Math.sqrt(y),v=(d*d-c*c+i*y)/(2*c*n*b),m=(d*d-c*c-i*y)/(2*d*n*b),g=Math.log(Math.sqrt(v*v+1)-v),_=Math.log(Math.sqrt(m*m+1)-m);o=(_-g)/e,s=function(t){var i,r=t*o,s=xt(g),l=c/(n*b)*(s*(i=e*r+g,((i=Math.exp(2*i))-1)/(i+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[a+l*f,u+l*p,c*s/xt(e*r+g)]}}return s.duration=1e3*o*e/Math.SQRT2,s}return r.rho=function(e){var n=Math.max(.001,+e),i=n*n;return t(n,i,i*i)},r}(Math.SQRT2,2,4);function At(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}var Tt,Mt,Bt=0,Ot=0,Dt=0,Nt=1e3,Ft=0,Lt=0,Et=0,Ut="object"==typeof performance&&performance.now?performance:Date,Ct="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function kt(){return Lt||(Ct(Pt),Lt=Ut.now()+Et)}function Pt(){Lt=0}function zt(){this._call=this._time=this._next=null}function Rt(t,e,n){var i=new zt;return i.restart(t,e,n),i}function jt(){Lt=(Ft=Ut.now())+Et,Bt=Ot=0;try{!function(){kt(),++Bt;for(var t,e=Tt;e;)(t=Lt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Bt}()}finally{Bt=0,function(){for(var t,e,n=Tt,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Tt=e);Mt=t,$t(i)}(),Lt=0}}function Vt(){var t=Ut.now(),e=t-Ft;e>Nt&&(Et-=e,Ft=t)}function $t(t){Bt||(Ot&&(Ot=clearTimeout(Ot)),t-Lt>24?(t<1/0&&(Ot=setTimeout(jt,t-Ut.now()-Et)),Dt&&(Dt=clearInterval(Dt))):(Dt||(Ft=Ut.now(),Dt=setInterval(Vt,Nt)),Bt=1,Ct(jt)))}function Yt(t,e,n){var i=new zt;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}zt.prototype=Rt.prototype={constructor:zt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?kt():+n)+(null==e?0:+e),this._next||Mt===this||(Mt?Mt._next=this:Tt=this,Mt=this),this._call=t,this._time=n,$t()},stop:function(){this._call&&(this._call=null,this._time=1/0,$t())}};var Gt=_t("start","end","cancel","interrupt"),Wt=[],qt=0,Zt=2,Ht=3,Xt=5,Kt=6;function Jt(t,e,n,i,r,s){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function s(u){var c,l,h,d;if(1!==n.state)return a();for(c in r)if((d=r[c]).name===n.name){if(d.state===Ht)return Yt(s);4===d.state?(d.state=Kt,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=Kt,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Yt((function(){n.state===Ht&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(u))})),n.state=Zt,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Zt){for(n.state=Ht,i=new Array(h=n.tween.length),c=0,l=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++l]=d);i.length=l+1}}function o(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=Xt,1),s=-1,o=i.length;++s<o;)i[s].call(t,r);n.state===Xt&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var i in n.state=Kt,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=Rt((function(t){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=t&&s(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:r,on:Gt,tween:Wt,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:qt})}function Qt(t,e){var n=ee(t,e);if(n.state>qt)throw new Error("too late; already scheduled");return n}function te(t,e){var n=ee(t,e);if(n.state>Ht)throw new Error("too late; already running");return n}function ee(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ne(t,e){var n,i,r,s=t.__transition,o=!0;if(s){for(r in e=null==e?null:e+"",s)(n=s[r]).name===e?(i=n.state>Zt&&n.state<Xt,n.state=Kt,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete s[r]):o=!1;o&&delete t.__transition}}function ie(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var re,se=180/Math.PI,oe={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ae(t,e,n,i,r,s){var o,a,u;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(u=t*n+e*i)&&(n-=t*u,i-=e*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),t*i<e*n&&(t=-t,e=-e,u=-u,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*se,skewX:Math.atan(u)*se,scaleX:o,scaleY:a}}function ue(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(s,o){var a=[],u=[];return s=t(s),o=t(o),function(t,i,r,s,o,a){if(t!==r||i!==s){var u=o.push("translate(",null,e,null,n);a.push({i:u-4,x:ie(t,r)},{i:u-2,x:ie(i,s)})}else(r||s)&&o.push("translate("+r+e+s+n)}(s.translateX,s.translateY,o.translateX,o.translateY,a,u),function(t,e,n,s){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),s.push({i:n.push(r(n)+"rotate(",null,i)-2,x:ie(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(s.rotate,o.rotate,a,u),function(t,e,n,s){t!==e?s.push({i:n.push(r(n)+"skewX(",null,i)-2,x:ie(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(s.skewX,o.skewX,a,u),function(t,e,n,i,s,o){if(t!==n||e!==i){var a=s.push(r(s)+"scale(",null,",",null,")");o.push({i:a-4,x:ie(t,n)},{i:a-2,x:ie(e,i)})}else 1===n&&1===i||s.push(r(s)+"scale("+n+","+i+")")}(s.scaleX,s.scaleY,o.scaleX,o.scaleY,a,u),s=o=null,function(t){for(var e,n=-1,i=u.length;++n<i;)a[(e=u[n]).i]=e.x(t);return a.join("")}}}var ce=ue((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?oe:ae(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),le=ue((function(t){return null==t?oe:(re||(re=document.createElementNS("http://www.w3.org/2000/svg","g")),re.setAttribute("transform",t),(t=re.transform.baseVal.consolidate())?ae((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):oe)}),", ",")",")");function he(t,e){var n,i;return function(){var r=te(this,t),s=r.tween;if(s!==n)for(var o=0,a=(i=n=s).length;o<a;++o)if(i[o].name===e){(i=i.slice()).splice(o,1);break}r.tween=i}}function de(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var s=te(this,t),o=s.tween;if(o!==i){r=(i=o).slice();for(var a={name:e,value:n},u=0,c=r.length;u<c;++u)if(r[u].name===e){r[u]=a;break}u===c&&r.push(a)}s.tween=r}}function fe(t,e,n){var i=t._id;return t.each((function(){var t=te(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return ee(t,i).value[e]}}function pe(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ye(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function be(){}var ve=.7,me=1/ve,ge="\\s*([+-]?\\d+)\\s*",_e="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",we="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Se=/^#([0-9a-f]{3,8})$/,xe=new RegExp(`^rgb\\(${ge},${ge},${ge}\\)$`),Ie=new RegExp(`^rgb\\(${we},${we},${we}\\)$`),Ae=new RegExp(`^rgba\\(${ge},${ge},${ge},${_e}\\)$`),Te=new RegExp(`^rgba\\(${we},${we},${we},${_e}\\)$`),Me=new RegExp(`^hsl\\(${_e},${we},${we}\\)$`),Be=new RegExp(`^hsla\\(${_e},${we},${we},${_e}\\)$`),Oe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function De(){return this.rgb().formatHex()}function Ne(){return this.rgb().formatRgb()}function Fe(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Se.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Le(e):3===n?new Ce(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ee(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ee(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=xe.exec(t))?new Ce(e[1],e[2],e[3],1):(e=Ie.exec(t))?new Ce(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Ae.exec(t))?Ee(e[1],e[2],e[3],e[4]):(e=Te.exec(t))?Ee(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Me.exec(t))?Ve(e[1],e[2]/100,e[3]/100,1):(e=Be.exec(t))?Ve(e[1],e[2]/100,e[3]/100,e[4]):Oe.hasOwnProperty(t)?Le(Oe[t]):"transparent"===t?new Ce(NaN,NaN,NaN,0):null}function Le(t){return new Ce(t>>16&255,t>>8&255,255&t,1)}function Ee(t,e,n,i){return i<=0&&(t=e=n=NaN),new Ce(t,e,n,i)}function Ue(t,e,n,i){return 1===arguments.length?((r=t)instanceof be||(r=Fe(r)),r?new Ce((r=r.rgb()).r,r.g,r.b,r.opacity):new Ce):new Ce(t,e,n,null==i?1:i);var r}function Ce(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function ke(){return`#${je(this.r)}${je(this.g)}${je(this.b)}`}function Pe(){const t=ze(this.opacity);return`${1===t?"rgb(":"rgba("}${Re(this.r)}, ${Re(this.g)}, ${Re(this.b)}${1===t?")":`, ${t})`}`}function ze(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Re(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function je(t){return((t=Re(t))<16?"0":"")+t.toString(16)}function Ve(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ye(t,e,n,i)}function $e(t){if(t instanceof Ye)return new Ye(t.h,t.s,t.l,t.opacity);if(t instanceof be||(t=Fe(t)),!t)return new Ye;if(t instanceof Ye)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,a=s-r,u=(s+r)/2;return a?(o=e===s?(n-i)/a+6*(n<i):n===s?(i-e)/a+2:(e-n)/a+4,a/=u<.5?s+r:2-s-r,o*=60):a=u>0&&u<1?0:o,new Ye(o,a,u,t.opacity)}function Ye(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Ge(t){return(t=(t||0)%360)<0?t+360:t}function We(t){return Math.max(0,Math.min(1,t||0))}function qe(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Ze(t,e,n,i,r){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*n+(1+3*t+3*s-3*o)*i+o*r)/6}pe(be,Fe,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:De,formatHex:De,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return $e(this).formatHsl()},formatRgb:Ne,toString:Ne}),pe(Ce,Ue,ye(be,{brighter(t){return t=null==t?me:Math.pow(me,t),new Ce(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?ve:Math.pow(ve,t),new Ce(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ce(Re(this.r),Re(this.g),Re(this.b),ze(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ke,formatHex:ke,formatHex8:function(){return`#${je(this.r)}${je(this.g)}${je(this.b)}${je(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Pe,toString:Pe})),pe(Ye,(function(t,e,n,i){return 1===arguments.length?$e(t):new Ye(t,e,n,null==i?1:i)}),ye(be,{brighter(t){return t=null==t?me:Math.pow(me,t),new Ye(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?ve:Math.pow(ve,t),new Ye(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Ce(qe(t>=240?t-240:t+120,r,i),qe(t,r,i),qe(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Ye(Ge(this.h),We(this.s),We(this.l),ze(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ze(this.opacity);return`${1===t?"hsl(":"hsla("}${Ge(this.h)}, ${100*We(this.s)}%, ${100*We(this.l)}%${1===t?")":`, ${t})`}`}}));const He=t=>()=>t;function Xe(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):He(isNaN(t)?e:t)}const Ke=function t(e){var n=function(t){return 1==(t=+t)?Xe:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):He(isNaN(e)?n:e)}}(e);function i(t,e){var i=n((t=Ue(t)).r,(e=Ue(e)).r),r=n(t.g,e.g),s=n(t.b,e.b),o=Xe(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=s(e),t.opacity=o(e),t+""}}return i.gamma=t,i}(1);function Je(t){return function(e){var n,i,r=e.length,s=new Array(r),o=new Array(r),a=new Array(r);for(n=0;n<r;++n)i=Ue(e[n]),s[n]=i.r||0,o[n]=i.g||0,a[n]=i.b||0;return s=t(s),o=t(o),a=t(a),i.opacity=1,function(t){return i.r=s(t),i.g=o(t),i.b=a(t),i+""}}}Je((function(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],s=t[i+1],o=i>0?t[i-1]:2*r-s,a=i<e-1?t[i+2]:2*s-r;return Ze((n-i/e)*e,o,r,s,a)}})),Je((function(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],s=t[i%e],o=t[(i+1)%e],a=t[(i+2)%e];return Ze((n-i/e)*e,r,s,o,a)}}));var Qe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,tn=new RegExp(Qe.source,"g");function en(t,e){var n,i,r,s=Qe.lastIndex=tn.lastIndex=0,o=-1,a=[],u=[];for(t+="",e+="";(n=Qe.exec(t))&&(i=tn.exec(e));)(r=i.index)>s&&(r=e.slice(s,r),a[o]?a[o]+=r:a[++o]=r),(n=n[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,u.push({i:o,x:ie(n,i)})),s=tn.lastIndex;return s<e.length&&(r=e.slice(s),a[o]?a[o]+=r:a[++o]=r),a.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,i=0;i<e;++i)a[(n=u[i]).i]=n.x(t);return a.join("")})}function nn(t,e){var n;return("number"==typeof e?ie:e instanceof Fe?Ke:(n=Fe(e))?(e=n,Ke):en)(t,e)}function rn(t){return function(){this.removeAttribute(t)}}function sn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function on(t,e,n){var i,r,s=n+"";return function(){var o=this.getAttribute(t);return o===s?null:o===i?r:r=e(i=o,n)}}function an(t,e,n){var i,r,s=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===s?null:o===i?r:r=e(i=o,n)}}function un(t,e,n){var i,r,s;return function(){var o,a,u=n(this);if(null!=u)return(o=this.getAttribute(t))===(a=u+"")?null:o===i&&a===r?s:(r=a,s=e(i=o,u));this.removeAttribute(t)}}function cn(t,e,n){var i,r,s;return function(){var o,a,u=n(this);if(null!=u)return(o=this.getAttributeNS(t.space,t.local))===(a=u+"")?null:o===i&&a===r?s:(r=a,s=e(i=o,u));this.removeAttributeNS(t.space,t.local)}}function ln(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,r)),n}return r._value=e,r}function hn(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,r)),n}return r._value=e,r}function dn(t,e){return function(){Qt(this,t).delay=+e.apply(this,arguments)}}function fn(t,e){return e=+e,function(){Qt(this,t).delay=e}}function pn(t,e){return function(){te(this,t).duration=+e.apply(this,arguments)}}function yn(t,e){return e=+e,function(){te(this,t).duration=e}}var bn=ft.prototype.constructor;function vn(t){return function(){this.style.removeProperty(t)}}var mn=0;function gn(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function _n(){return++mn}var wn=ft.prototype;gn.prototype=function(t){return ft().transition(t)}.prototype={constructor:gn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=i(t));for(var r=this._groups,s=r.length,o=new Array(s),a=0;a<s;++a)for(var u,c,l=r[a],h=l.length,d=o[a]=new Array(h),f=0;f<h;++f)(u=l[f])&&(c=t.call(u,u.__data__,f,l))&&("__data__"in u&&(c.__data__=u.__data__),d[f]=c,Jt(d[f],e,n,f,d,ee(u,n)));return new gn(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=s(t));for(var i=this._groups,r=i.length,o=[],a=[],u=0;u<r;++u)for(var c,l=i[u],h=l.length,d=0;d<h;++d)if(c=l[d]){for(var f,p=t.call(c,c.__data__,d,l),y=ee(c,n),b=0,v=p.length;b<v;++b)(f=p[b])&&Jt(f,e,n,b,p,y);o.push(p),a.push(c)}return new gn(o,a,e,n)},selectChild:wn.selectChild,selectChildren:wn.selectChildren,filter:function(t){"function"!=typeof t&&(t=o(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s,a=e[r],u=a.length,c=i[r]=[],l=0;l<u;++l)(s=a[l])&&t.call(s,s.__data__,l,a)&&c.push(s);return new gn(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),o=new Array(i),a=0;a<s;++a)for(var u,c=e[a],l=n[a],h=c.length,d=o[a]=new Array(h),f=0;f<h;++f)(u=c[f]||l[f])&&(d[f]=u);for(;a<i;++a)o[a]=e[a];return new gn(o,this._parents,this._name,this._id)},selection:function(){return new bn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=_n(),i=this._groups,r=i.length,s=0;s<r;++s)for(var o,a=i[s],u=a.length,c=0;c<u;++c)if(o=a[c]){var l=ee(o,e);Jt(o,t,n,c,a,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new gn(i,this._parents,t,n)},call:wn.call,nodes:wn.nodes,node:wn.node,size:wn.size,empty:wn.empty,each:wn.each,on:function(t,e){var n=this._id;return arguments.length<2?ee(this.node(),n).on.on(t):this.each(function(t,e,n){var i,r,s=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Qt:te;return function(){var o=s(this,t),a=o.on;a!==i&&(r=(i=a).copy()).on(e,n),o.on=r}}(n,t,e))},attr:function(t,e){var n=w(t),i="transform"===n?le:nn;return this.attrTween(t,"function"==typeof e?(n.local?cn:un)(n,i,fe(this,"attr."+t,e)):null==e?(n.local?sn:rn)(n):(n.local?an:on)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=w(t);return this.tween(n,(i.local?ln:hn)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?ce:nn;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var s=F(this,t),o=(this.style.removeProperty(t),F(this,t));return s===o?null:s===n&&o===i?r:r=e(n=s,i=o)}}(t,i)).on("end.style."+t,vn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,s;return function(){var o=F(this,t),a=n(this),u=a+"";return null==a&&(this.style.removeProperty(t),u=a=F(this,t)),o===u?null:o===i&&u===r?s:(r=u,s=e(i=o,a))}}(t,i,fe(this,"style."+t,e))).each(function(t,e){var n,i,r,s,o="style."+e,a="end."+o;return function(){var u=te(this,t),c=u.on,l=null==u.value[o]?s||(s=vn(e)):void 0;c===n&&r===l||(i=(n=c).copy()).on(a,r=l),u.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,s=n+"";return function(){var o=F(this,t);return o===s?null:o===i?r:r=e(i=o,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,function(t,e,n){var i,r;function s(){var s=e.apply(this,arguments);return s!==r&&(i=(r=s)&&function(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}(t,s,n)),i}return s._value=e,s}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(fe(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&function(t){return function(e){this.textContent=t.call(this,e)}}(i)),e}return i._value=t,i}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=ee(this.node(),n).tween,s=0,o=r.length;s<o;++s)if((i=r[s]).name===t)return i.value;return null}return this.each((null==e?he:de)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?dn:fn)(e,t)):ee(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?pn:yn)(e,t)):ee(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){te(this,t).ease=e}}(e,t)):ee(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;te(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(s,o){var a={value:o},u={value:function(){0==--r&&s()}};n.each((function(){var n=te(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(u)),n.on=e})),0===r&&s()}))},[Symbol.iterator]:wn[Symbol.iterator]};var Sn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function xn(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}ft.prototype.interrupt=function(t){return this.each((function(){ne(this,t)}))},ft.prototype.transition=function(t){var e,n;t instanceof gn?(e=t._id,t=t._name):(e=_n(),(n=Sn).time=kt(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var o,a=i[s],u=a.length,c=0;c<u;++c)(o=a[c])&&Jt(o,t,e,c,a,n||xn(o,e));return new gn(i,this._parents,t,e)};const In=t=>()=>t;function An(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function Tn(t,e,n){this.k=t,this.x=e,this.y=n}Tn.prototype={constructor:Tn,scale:function(t){return 1===t?this:new Tn(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Tn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Mn=new Tn(1,0,0);function Bn(t){t.stopImmediatePropagation()}function On(t){t.preventDefault(),t.stopImmediatePropagation()}function Dn(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function Nn(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Fn(){return this.__zoom||Mn}function Ln(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function En(){return navigator.maxTouchPoints||"ontouchstart"in this}function Un(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}Tn.prototype;class Cn{constructor(t,e,n,i){this.opts=i||{},this.canvas=t,this.w=this.canvas.offsetWidth,this.h=this.canvas.offsetHeight,this.canvas.width=this.w,this.canvas.height=this.h;const r=this.canvas.getContext("2d");if(!r)throw"Impossible to create canvas 2D context";if(this.ctx=r,this.center=e||{x:.5*this.w,y:.5*this.h},this.zf=n,this.backgroundColor=i.backgroundColor||"white",this.onZoomStartFun=i.onZoomStartFun,this.onZoomEndFun=i.onZoomEndFun,this.onZoomFun=i.onZoomFun,this.extGeo={xMin:NaN,xMax:NaN,yMin:NaN,yMax:NaN},this.updateExtentGeo(),!i.disableZoom){let t=Mn;(function(){var t,e,n,i=Dn,r=Nn,s=Un,o=Ln,a=En,u=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],l=250,h=It,d=_t("start","zoom","end"),f=500,p=150,y=0,b=10;function v(t){t.property("__zoom",Fn).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",T).filter(a).on("touchstart.zoom",M).on("touchmove.zoom",B).on("touchend.zoom touchcancel.zoom",O).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(t,e){return(e=Math.max(u[0],Math.min(u[1],e)))===t.k?t:new Tn(e,t.x,t.y)}function g(t,e,n){var i=e[0]-n[0]*t.k,r=e[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new Tn(t.k,i,r)}function _(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function w(t,e,n,i){t.on("start.zoom",(function(){S(this,arguments).event(i).start()})).on("interrupt.zoom end.zoom",(function(){S(this,arguments).event(i).end()})).tween("zoom",(function(){var t=this,s=arguments,o=S(t,s).event(i),a=r.apply(t,s),u=null==n?_(a):"function"==typeof n?n.apply(t,s):n,c=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),l=t.__zoom,d="function"==typeof e?e.apply(t,s):e,f=h(l.invert(u).concat(c/l.k),d.invert(u).concat(c/d.k));return function(t){if(1===t)t=d;else{var e=f(t),n=c/e[2];t=new Tn(n,u[0]-e[0]*n,u[1]-e[1]*n)}o.zoom(null,t)}}))}function S(t,e,n){return!n&&t.__zooming||new x(t,e)}function x(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=r.apply(t,e),this.taps=0}function I(t,...e){if(i.apply(this,arguments)){var n=S(this,e).event(t),r=this.__zoom,a=Math.max(u[0],Math.min(u[1],r.k*Math.pow(2,o.apply(this,arguments)))),l=At(t);if(n.wheel)n.mouse[0][0]===l[0]&&n.mouse[0][1]===l[1]||(n.mouse[1]=r.invert(n.mouse[0]=l)),clearTimeout(n.wheel);else{if(r.k===a)return;n.mouse=[l,r.invert(l)],ne(this),n.start()}On(t),n.wheel=setTimeout((function(){n.wheel=null,n.end()}),p),n.zoom("mouse",s(g(m(r,a),n.mouse[0],n.mouse[1]),n.extent,c))}}function A(t,...e){if(!n&&i.apply(this,arguments)){var r=t.currentTarget,o=S(this,e,!0).event(t),a=pt(t.view).on("mousemove.zoom",(function(t){if(On(t),!o.moved){var e=t.clientX-l,n=t.clientY-h;o.moved=e*e+n*n>y}o.event(t).zoom("mouse",s(g(o.that.__zoom,o.mouse[0]=At(t,r),o.mouse[1]),o.extent,c))}),!0).on("mouseup.zoom",(function(t){a.on("mousemove.zoom mouseup.zoom",null),function(t,e){var n=t.document.documentElement,i=pt(t).on("dragstart.drag",null);e&&(i.on("click.drag",St,wt),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(t.view,o.moved),On(t),o.event(t).end()}),!0),u=At(t,r),l=t.clientX,h=t.clientY;!function(t){var e=t.document.documentElement,n=pt(t).on("dragstart.drag",St,wt);"onselectstart"in e?n.on("selectstart.drag",St,wt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(t.view),Bn(t),o.mouse=[u,this.__zoom.invert(u)],ne(this),o.start()}}function T(t,...e){if(i.apply(this,arguments)){var n=this.__zoom,o=At(t.changedTouches?t.changedTouches[0]:t,this),a=n.invert(o),u=n.k*(t.shiftKey?.5:2),h=s(g(m(n,u),o,a),r.apply(this,e),c);On(t),l>0?pt(this).transition().duration(l).call(w,h,o,t):pt(this).call(v.transform,h,o,t)}}function M(n,...r){if(i.apply(this,arguments)){var s,o,a,u,c=n.touches,l=c.length,h=S(this,r,n.changedTouches.length===l).event(n);for(Bn(n),o=0;o<l;++o)u=[u=At(a=c[o],this),this.__zoom.invert(u),a.identifier],h.touch0?h.touch1||h.touch0[2]===u[2]||(h.touch1=u,h.taps=0):(h.touch0=u,s=!0,h.taps=1+!!t);t&&(t=clearTimeout(t)),s&&(h.taps<2&&(e=u[0],t=setTimeout((function(){t=null}),f)),ne(this),h.start())}}function B(t,...e){if(this.__zooming){var n,i,r,o,a=S(this,e).event(t),u=t.changedTouches,l=u.length;for(On(t),n=0;n<l;++n)r=At(i=u[n],this),a.touch0&&a.touch0[2]===i.identifier?a.touch0[0]=r:a.touch1&&a.touch1[2]===i.identifier&&(a.touch1[0]=r);if(i=a.that.__zoom,a.touch1){var h=a.touch0[0],d=a.touch0[1],f=a.touch1[0],p=a.touch1[1],y=(y=f[0]-h[0])*y+(y=f[1]-h[1])*y,b=(b=p[0]-d[0])*b+(b=p[1]-d[1])*b;i=m(i,Math.sqrt(y/b)),r=[(h[0]+f[0])/2,(h[1]+f[1])/2],o=[(d[0]+p[0])/2,(d[1]+p[1])/2]}else{if(!a.touch0)return;r=a.touch0[0],o=a.touch0[1]}a.zoom("touch",s(g(i,r,o),a.extent,c))}}function O(t,...i){if(this.__zooming){var r,s,o=S(this,i).event(t),a=t.changedTouches,u=a.length;for(Bn(t),n&&clearTimeout(n),n=setTimeout((function(){n=null}),f),r=0;r<u;++r)s=a[r],o.touch0&&o.touch0[2]===s.identifier?delete o.touch0:o.touch1&&o.touch1[2]===s.identifier&&delete o.touch1;if(o.touch1&&!o.touch0&&(o.touch0=o.touch1,delete o.touch1),o.touch0)o.touch0[1]=this.__zoom.invert(o.touch0[0]);else if(o.end(),2===o.taps&&(s=At(s,this),Math.hypot(e[0]-s[0],e[1]-s[1])<b)){var c=pt(this).on("dblclick.zoom");c&&c.apply(this,arguments)}}}return v.transform=function(t,e,n,i){var r=t.selection?t.selection():t;r.property("__zoom",Fn),t!==r?w(t,e,n,i):r.interrupt().each((function(){S(this,arguments).event(i).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},v.scaleBy=function(t,e,n,i){v.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),n,i)},v.scaleTo=function(t,e,n,i){v.transform(t,(function(){var t=r.apply(this,arguments),i=this.__zoom,o=null==n?_(t):"function"==typeof n?n.apply(this,arguments):n,a=i.invert(o),u="function"==typeof e?e.apply(this,arguments):e;return s(g(m(i,u),o,a),t,c)}),n,i)},v.translateBy=function(t,e,n,i){v.transform(t,(function(){return s(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),c)}),null,i)},v.translateTo=function(t,e,n,i,o){v.transform(t,(function(){var t=r.apply(this,arguments),o=this.__zoom,a=null==i?_(t):"function"==typeof i?i.apply(this,arguments):i;return s(Mn.translate(a[0],a[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,c)}),i,o)},x.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=pt(this.that).datum();d.call(t,this.that,new An(t,{sourceEvent:this.sourceEvent,target:v,type:t,transform:this.that.__zoom,dispatch:d}),e)}},v.wheelDelta=function(t){return arguments.length?(o="function"==typeof t?t:In(+t),v):o},v.filter=function(t){return arguments.length?(i="function"==typeof t?t:In(!!t),v):i},v.touchable=function(t){return arguments.length?(a="function"==typeof t?t:In(!!t),v):a},v.extent=function(t){return arguments.length?(r="function"==typeof t?t:In([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),v):r},v.scaleExtent=function(t){return arguments.length?(u[0]=+t[0],u[1]=+t[1],v):[u[0],u[1]]},v.translateExtent=function(t){return arguments.length?(c[0][0]=+t[0][0],c[1][0]=+t[1][0],c[0][1]=+t[0][1],c[1][1]=+t[1][1],v):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},v.constrain=function(t){return arguments.length?(s=t,v):s},v.duration=function(t){return arguments.length?(l=+t,v):l},v.interpolate=function(t){return arguments.length?(h=t,v):h},v.on=function(){var t=d.on.apply(d,arguments);return t===d?v:t},v.clickDistance=function(t){return arguments.length?(y=(t=+t)*t,v):Math.sqrt(y)},v.tapDistance=function(t){return arguments.length?(b=+t,v):b},v})().wheelDelta((t=>-t.deltaY*(1===t.deltaMode?.07:t.deltaMode?1:.004))).on("zoom",(e=>{const n=e.transform,i=t.k/n.k;if(1==i){const e=t.x-n.x,i=t.y-n.y;this.pan(e*this.getZf(),-i*this.getZf())}else{const t=e.sourceEvent;if(t instanceof WheelEvent)this.zoom(i,this.pixToGeoX(e.sourceEvent.offsetX),this.pixToGeoY(e.sourceEvent.offsetY));else if(t instanceof TouchEvent){let e=0,n=0;for(let i of t.targetTouches)e+=i.clientX,n+=i.clientY;e/=t.targetTouches.length,n/=t.targetTouches.length,this.zoom(i,this.pixToGeoX(e),this.pixToGeoY(n))}}t=n,this.onZoomFun&&this.onZoomFun(e)})).on("start",(t=>{this.canvasSave.c=document.createElement("canvas"),this.canvasSave.c.setAttribute("width",""+this.w),this.canvasSave.c.setAttribute("height",""+this.h),this.canvasSave.c.getContext("2d").drawImage(this.canvas,0,0),this.canvasSave.dx=0,this.canvasSave.dy=0,this.canvasSave.f=1,this.onZoomStartFun&&this.onZoomStartFun(t)})).on("end",(t=>{this.redraw(!0),this.canvasSave={c:null,dx:0,dy:0,f:1},this.onZoomEndFun&&this.onZoomEndFun(t)}))(pt(this.canvas))}this.zfExtent=[0,1/0],this.canvasSave={c:null,dx:0,dy:0,f:1}}setCenter(t){this.center=t}getCenter(){return this.center}setZf(t){this.zf=t,this.slider&&this.slider.attr("value",+this.zf)}getZf(){return this.zf}setZfExtent(t){this.zfExtent=t}getZfExtent(){return this.zfExtent}initCanvasTransform(){this.ctx.setTransform(1,0,0,1,0,0)}setCanvasTransform(){const t=1/this.getZf(),e=-this.center.x/this.getZf()+.5*this.w,n=this.center.y/this.getZf()+.5*this.h;this.ctx.setTransform(t,0,0,-t,e,n)}getWebGLTransform(){const t=2/(this.w*this.getZf()),e=2/(this.h*this.getZf());return[t,0,0,0,e,0,-t*this.center.x,-e*this.center.y,1]}redraw(t=!0){throw new Error("Method redraw not implemented.")}clear(t="white"){this.opts.transparentBackground?this.ctx.clearRect(0,0,this.w,this.h):(this.ctx&&(this.ctx.fillStyle=t),this.ctx.fillRect(0,0,this.w,this.h))}pan(t=0,e=0){this.center.x+=t,this.center.y+=e,this.updateExtentGeo(),this.canvasSave.c&&(this.canvasSave.dx-=t/this.getZf(),this.canvasSave.dy+=e/this.getZf(),this.clear(this.backgroundColor),this.ctx.drawImage(this.canvasSave.c,this.canvasSave.dx,this.canvasSave.dy))}zoom(t=1,e=this.center.x,n=this.center.y){if(this.zfExtent[0]==this.getZf()&&t<=1)return;if(this.zfExtent[1]==this.getZf()&&t>=1)return;const i=t*this.getZf();i<this.zfExtent[0]&&(t=this.zfExtent[0]/this.getZf()),i>this.zfExtent[1]&&(t=this.zfExtent[1]/this.getZf()),this.setZf(t*this.getZf());const r=(e-this.center.x)*(1-t);this.center.x+=r;const s=(n-this.center.y)*(1-t);this.center.y+=s,this.updateExtentGeo(),this.canvasSave.c&&(this.clear(this.backgroundColor),this.canvasSave.f/=t,this.canvasSave.dx=this.geoToPixX(e)*(1-this.canvasSave.f),this.canvasSave.dy=this.geoToPixY(n)*(1-this.canvasSave.f),this.clear(this.backgroundColor),this.ctx.drawImage(this.canvasSave.c,this.canvasSave.dx,this.canvasSave.dy,this.canvasSave.f*this.canvasSave.c.width,this.canvasSave.f*this.canvasSave.c.height))}updateExtentGeo(t=20){return this.extGeo={xMin:this.pixToGeoX(-t),xMax:this.pixToGeoX(this.w+t),yMin:this.pixToGeoY(this.h+t),yMax:this.pixToGeoY(-t)},this.extGeo}toDraw(t){return!(t.x<this.extGeo.xMin||t.x>this.extGeo.xMax||t.y<this.extGeo.yMin||t.y>this.extGeo.yMax)}geoToPixX(t){return(t-this.center.x)/this.getZf()+.5*this.w}geoToPixY(t){return-(t-this.center.y)/this.getZf()+.5*this.h}pixToGeoX(t){return(t-.5*this.w)*this.getZf()+this.center.x}pixToGeoY(t){return-(t-.5*this.h)*this.getZf()+this.center.y}setViewFromURL(){const t=Cn.getParameterByName("x"),e=Cn.getParameterByName("y"),n=Cn.getParameterByName("z"),i=this.getCenter();null==t||null==t||isNaN(+t)||(i.x=+t),null==e||null==e||isNaN(+e)||(i.y=+e),null==n||null==n||isNaN(+n)||this.setZf(+n)}addZoomSlider(t,e){(e=e||{}).width=e.width||"30px",e.height=e.height||"300px";const n=pt("#"+t);if(n.empty())return console.error("Could not find div element to build zoom slider. Id: "+t),this;const i=this;return this.slider=n.append("input").attr("type","range").attr("min",this.getZfExtent()[0]).attr("max",this.getZfExtent()[1]).attr("value",this.getZf()).on("input",(function(t){if(!this||!this.value)return;const e=+this.value;pt(this).attr("value",e),i.setZf(e),i.redraw()})).style("width",e.width).style("height",e.height).style("opacity",.7).on("mouseover",(function(t){pt(this).style("opacity",1)})).on("mouseout",(function(t){pt(this).style("opacity",.7)})).style("-webkit-appearance","slider-vertical").style("writing-mode","bt-lr").attr("orient","vertical").style("background","lightgray").style("outline","none").style("-webkit-transition",".2s").style("transition","opacity .2s"),this}static getParameterByName(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return e?decodeURIComponent(e[1].replace(/\+/g," ")):null}}class kn{constructor(t,e,n={}){if(n=n||{},this.datasetComponents=t,this.resolutions=e,this.datasetComponents.length>1&&this.datasetComponents.length!=this.resolutions.length)throw new Error("Uncompatible number of datasets and resolutions: "+this.datasetComponents.length+" "+this.resolutions.length);n.preprocess&&this.setPrepocesses(n.preprocess)}setPrepocesses(t){for(let e of this.datasetComponents)e.preprocess=t;return this}static make(t,e,n){const i=[];for(const n of t)i.push(e(n));return new kn(i,t,n)}}class Pn{constructor(t,e,n={}){n=n||{},this.url=t,this.resolution=e,this.preprocess=n.preprocess||void 0,this.cellsViewCache=[]}getData(t,e){throw new Error("Method getData not implemented.")}updateViewCache(t){throw new Error("Method updateViewCache not implemented.")}getCellFromPosition(t,e){const n=this.getResolution(),i=n*Math.floor(t.x/n),r=n*Math.floor(t.y/n);for(const t of e)if(t.x==i&&t.y==r)return t}getResolution(){return this.resolution}getViewCache(){return this.cellsViewCache}}class zn{constructor(t,e,n,i){this.cells=t,this.x=e,this.y=n;const r=i.resolutionGeo,s=i.tileSizeCell;this.extGeo={xMin:i.originPoint.x+r*s*this.x,xMax:i.originPoint.x+r*s*(this.x+1),yMin:i.originPoint.y+r*s*this.y,yMax:i.originPoint.y+r*s*(this.y+1)};for(let t of this.cells)t.x=this.extGeo.xMin+t.x*r,t.y=this.extGeo.yMin+t.y*r}}function Rn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}var jn,Vn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function $n(t){if(!(e=Vn.exec(t)))throw new Error("invalid format: "+t);var e;return new Yn({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Yn(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Gn(t,e){var n=Rn(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}$n.prototype=Yn.prototype,Yn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Wn={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Gn(100*t,e),r:Gn,s:function(t,e){var n=Rn(t,e);if(!n)return t+"";var i=n[0],r=n[1],s=r-(jn=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+Rn(t,Math.max(0,e+s-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function qn(t){return t}var Zn,Hn,Xn,Kn,Jn,Qn,ti,ei,ni,ii,ri,si,oi,ai,ui=Array.prototype.map,ci=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function li(t){return Zn=function(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?qn:(e=ui.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,s=[],o=0,a=e[0],u=0;r>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),s.push(t.substring(r-=a,r+a)),!((u+=a+1)>i));)a=e[o=(o+1)%e.length];return s.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",s=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?qn:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(ui.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"−":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=$n(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,y=t.comma,b=t.precision,v=t.trim,m=t.type;"n"===m?(y=!0,m="g"):Wn[m]||(void 0===b&&(b=12),v=!0,m="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var g="$"===d?r:"#"===d&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",_="$"===d?s:/[%p]/.test(m)?u:"",w=Wn[m],S=/[defgprs%]/.test(m);function x(t){var r,s,u,d=g,x=_;if("c"===m)x=w(t)+x,t="";else{var I=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:w(Math.abs(t),b),v&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),I&&0==+t&&"+"!==h&&(I=!1),d=(I?"("===h?h:c:"-"===h||"("===h?"":h)+d,x=("s"===m?ci[8+jn/3]:"")+x+(I&&"("===h?")":""),S)for(r=-1,s=t.length;++r<s;)if(48>(u=t.charCodeAt(r))||u>57){x=(46===u?o+t.slice(r+1):t.slice(r))+x,t=t.slice(0,r);break}}y&&!f&&(t=i(t,1/0));var A=d.length+t.length+x.length,T=A<p?new Array(p-A+1).join(e):"";switch(y&&f&&(t=i(T+t,T.length?p-x.length:1/0),T=""),n){case"<":t=d+t+x+T;break;case"=":t=d+T+t+x;break;case"^":t=T.slice(0,A=T.length>>1)+d+t+x+T.slice(A);break;default:t=T+d+t+x}return a(t)}return b=void 0===b?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b)),x.toString=function(){return t+""},x}return{format:h,formatPrefix:function(t,e){var n,i=h(((t=$n(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor((n=e,((n=Rn(Math.abs(n)))?n[1]:NaN)/3)))),s=Math.pow(10,-r),o=ci[8+r/3];return function(t){return i(s*t)+o}}}}(t),Zn.format,Zn.formatPrefix,Zn}function hi(t){if(null===t)return"null";if(void 0===t)return"undefined";switch(typeof t){case"number":case"bigint":return`${t}`;case"string":return`"${t}"`}return"function"==typeof t[Symbol.toPrimitive]?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof BigInt64Array||t instanceof BigUint64Array?`[${[...t].map((t=>hi(t)))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,((t,e)=>"bigint"==typeof e?`${e}`:e))}function di(t,e,n,i){return new(n||(n=Promise))((function(r,s){function o(t){try{u(i.next(t))}catch(t){s(t)}}function a(t){try{u(i.throw(t))}catch(t){s(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}u((i=i.apply(t,e||[])).next())}))}function fi(t){return this instanceof fi?(this.v=t,this):new fi(t)}function pi(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(t){r[t]&&(i[t]=function(e){return new Promise((function(n,i){s.push([t,e,n,i])>1||a(t,e)}))})}function a(t,e){try{(n=r[t](e)).value instanceof fi?Promise.resolve(n.value.v).then(u,c):l(s[0][2],n)}catch(t){l(s[0][3],t)}var n}function u(t){a("next",t)}function c(t){a("throw",t)}function l(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}}function yi(t){var e,n;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,r){e[i]=t[i]?function(e){return(n=!n)?{value:fi(t[i](e)),done:!1}:r?r(e):e}:r}}function bi(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(i,r){!function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)}(i,r,(e=t[n](e)).done,e.value)}))}}}li({thousands:",",grouping:[3],currency:["$",""]}),Cn.getParameterByName,li({decimal:".",thousands:" ",grouping:[3],currency:["","€"]}),function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(Hn||(Hn={})),(ai=Xn||(Xn={}))[ai.Sparse=0]="Sparse",ai[ai.Dense=1]="Dense",function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}(Kn||(Kn={})),(oi=Jn||(Jn={}))[oi.DAY=0]="DAY",oi[oi.MILLISECOND=1]="MILLISECOND",(si=Qn||(Qn={}))[si.SECOND=0]="SECOND",si[si.MILLISECOND=1]="MILLISECOND",si[si.MICROSECOND=2]="MICROSECOND",si[si.NANOSECOND=3]="NANOSECOND",(ri=ti||(ti={}))[ri.YEAR_MONTH=0]="YEAR_MONTH",ri[ri.DAY_TIME=1]="DAY_TIME",ri[ri.MONTH_DAY_NANO=2]="MONTH_DAY_NANO",function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"}(ei||(ei={})),function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"}(ni||(ni={})),function(t){t[t.OFFSET=0]="OFFSET",t[t.DATA=1]="DATA",t[t.VALIDITY=2]="VALIDITY",t[t.TYPE=3]="TYPE"}(ii||(ii={})),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const vi=new TextDecoder("utf-8"),mi=t=>vi.decode(t),gi=new TextEncoder,_i=t=>gi.encode(t),[wi,Si]=(()=>{const t=()=>{throw new Error("BigInt is not available in this environment")};function e(){throw t()}return e.asIntN=()=>{throw t()},e.asUintN=()=>{throw t()},"undefined"!=typeof BigInt?[BigInt,!0]:[e,!1]})(),[xi,Ii]=(()=>{const t=()=>{throw new Error("BigInt64Array is not available in this environment")};return"undefined"!=typeof BigInt64Array?[BigInt64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),[Ai,Ti]=(()=>{const t=()=>{throw new Error("BigUint64Array is not available in this environment")};return"undefined"!=typeof BigUint64Array?[BigUint64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),Mi=t=>"function"==typeof t,Bi=t=>null!=t&&Object(t)===t,Oi=t=>Bi(t)&&Mi(t.then),Di=t=>Bi(t)&&Mi(t[Symbol.iterator]),Ni=t=>Bi(t)&&Mi(t[Symbol.asyncIterator]),Fi=t=>Bi(t)&&Bi(t.schema),Li=t=>Bi(t)&&"done"in t&&"value"in t,Ei=t=>Bi(t)&&Mi(t.stat)&&(t=>"number"==typeof t)(t.fd),Ui=t=>Bi(t)&&ki(t.body),Ci=t=>"_getDOMStream"in t&&"_getNodeStream"in t,ki=t=>Bi(t)&&Mi(t.cancel)&&Mi(t.getReader)&&!Ci(t),Pi=t=>Bi(t)&&Mi(t.read)&&Mi(t.pipe)&&(t=>"boolean"==typeof t)(t.readable)&&!Ci(t),zi=t=>Bi(t)&&Mi(t.clear)&&Mi(t.bytes)&&Mi(t.position)&&Mi(t.setPosition)&&Mi(t.capacity)&&Mi(t.getBufferIdentifier)&&Mi(t.createLong),Ri="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function ji(t,e,n=0,i=e.byteLength){const r=t.byteLength,s=new Uint8Array(t.buffer,t.byteOffset,r),o=new Uint8Array(e.buffer,e.byteOffset,Math.min(i,r));return s.set(o,n),t}function Vi(t,e){const n=function(t){const e=t[0]?[t[0]]:[];let n,i,r,s;for(let o,a,u=0,c=0,l=t.length;++u<l;)o=e[c],a=t[u],!o||!a||o.buffer!==a.buffer||a.byteOffset<o.byteOffset?a&&(e[++c]=a):(({byteOffset:n,byteLength:r}=o),({byteOffset:i,byteLength:s}=a),n+r<i||i+s<n?a&&(e[++c]=a):e[c]=new Uint8Array(o.buffer,n,i-n+s));return e}(t),i=n.reduce(((t,e)=>t+e.byteLength),0);let r,s,o,a=0,u=-1;const c=Math.min(e||Number.POSITIVE_INFINITY,i);for(const t=n.length;++u<t;){if(r=n[u],s=r.subarray(0,Math.min(r.length,c-a)),c<=a+s.length){s.length<r.length?n[u]=r.subarray(s.length):s.length===r.length&&u++,o?ji(o,s,a):o=s;break}ji(o||(o=new Uint8Array(c)),s,a),a+=s.length}return[o||new Uint8Array(0),n.slice(u),i-(o?o.byteLength:0)]}function $i(t,e){let n=Li(e)?e.value:e;return n instanceof t?t===Uint8Array?new t(n.buffer,n.byteOffset,n.byteLength):n:n?("string"==typeof n&&(n=_i(n)),n instanceof ArrayBuffer||n instanceof Ri?new t(n):zi(n)?$i(t,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new t(0):new t(n.buffer,n.byteOffset,n.byteLength/t.BYTES_PER_ELEMENT):t.from(n)):new t(0)}const Yi=t=>$i(Int32Array,t),Gi=t=>$i(Uint8Array,t),Wi=t=>(t.next(),t);function qi(t,e){return pi(this,arguments,(function*(){if(Oi(e))return yield fi(yield fi(yield*yi(bi(qi(t,yield fi(e))))));const n=function(t){return pi(this,arguments,(function*(){yield yield fi(yield fi(t))}))},i="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof Ri?n(e):Di(e)?function(t){return pi(this,arguments,(function*(){yield fi(yield*yi(bi(Wi(function*(t){let e=null;do{e=t.next(yield null==e?void 0:e.value)}while(!e.done)}(t[Symbol.iterator]())))))}))}(e):Ni(e)?e:n(e);return yield fi(yield*yi(bi(Wi(function(e){return pi(this,arguments,(function*(){let n=null;do{n=yield fi(e.next(yield yield fi($i(t,n))))}while(!n.done)}))}(i[Symbol.asyncIterator]()))))),yield fi(new t)}))}const Zi=Symbol.for("isArrowBigNum");function Hi(t,...e){return 0===e.length?Object.setPrototypeOf($i(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}function Xi(...t){return Hi.apply(this,t)}function Ki(...t){return Hi.apply(this,t)}function Ji(...t){return Hi.apply(this,t)}function Qi(t){const{buffer:e,byteOffset:n,length:i,signed:r}=t,s=new Ai(e,n,i),o=r&&s[s.length-1]&BigInt(1)<<BigInt(63);let a=o?BigInt(1):BigInt(0),u=BigInt(0);if(o){for(const t of s)a+=~t*(BigInt(1)<<BigInt(32)*u++);a*=BigInt(-1)}else for(const t of s)a+=t*(BigInt(1)<<BigInt(32)*u++);return a}let tr,er;function nr(t){let e="";const n=new Uint32Array(2);let i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);const r=new Uint32Array((i=new Uint16Array(i).reverse()).buffer);let s=-1;const o=i.length-1;do{for(n[0]=i[s=0];s<o;)i[s++]=n[1]=n[0]/10,n[0]=(n[0]-10*n[1]<<16)+i[s];i[s]=n[1]=n[0]/10,n[0]=n[0]-10*n[1],e=`${n[0]}${e}`}while(r[0]||r[1]||r[2]||r[3]);return null!=e?e:"0"}Hi.prototype[Zi]=!0,Hi.prototype.toJSON=function(){return`"${tr(this)}"`},Hi.prototype.valueOf=function(){return Qi(this)},Hi.prototype.toString=function(){return tr(this)},Hi.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return Qi(this);case"string":return tr(this);case"default":return er(this)}return tr(this)},Object.setPrototypeOf(Xi.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(Ki.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(Ji.prototype,Object.create(Uint32Array.prototype)),Object.assign(Xi.prototype,Hi.prototype,{constructor:Xi,signed:!0,TypedArray:Int32Array,BigIntArray:xi}),Object.assign(Ki.prototype,Hi.prototype,{constructor:Ki,signed:!1,TypedArray:Uint32Array,BigIntArray:Ai}),Object.assign(Ji.prototype,Hi.prototype,{constructor:Ji,signed:!0,TypedArray:Uint32Array,BigIntArray:Ai}),Si?(er=t=>8===t.byteLength?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:nr(t),tr=t=>8===t.byteLength?`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`:nr(t)):(tr=nr,er=tr);class ir{static new(t,e){switch(e){case!0:return new Xi(t);case!1:return new Ki(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case xi:return new Xi(t)}return 16===t.byteLength?new Ji(t):new Ki(t)}static signed(t){return new Xi(t)}static unsigned(t){return new Ki(t)}static decimal(t){return new Ji(t)}constructor(t,e){return ir.new(t,e)}}var rr,sr,or,ar,ur,cr,lr,hr,dr,fr,pr,yr,br,vr,mr,gr,_r,wr,Sr,xr;class Ir{static isNull(t){return(null==t?void 0:t.typeId)===ni.Null}static isInt(t){return(null==t?void 0:t.typeId)===ni.Int}static isFloat(t){return(null==t?void 0:t.typeId)===ni.Float}static isBinary(t){return(null==t?void 0:t.typeId)===ni.Binary}static isUtf8(t){return(null==t?void 0:t.typeId)===ni.Utf8}static isBool(t){return(null==t?void 0:t.typeId)===ni.Bool}static isDecimal(t){return(null==t?void 0:t.typeId)===ni.Decimal}static isDate(t){return(null==t?void 0:t.typeId)===ni.Date}static isTime(t){return(null==t?void 0:t.typeId)===ni.Time}static isTimestamp(t){return(null==t?void 0:t.typeId)===ni.Timestamp}static isInterval(t){return(null==t?void 0:t.typeId)===ni.Interval}static isList(t){return(null==t?void 0:t.typeId)===ni.List}static isStruct(t){return(null==t?void 0:t.typeId)===ni.Struct}static isUnion(t){return(null==t?void 0:t.typeId)===ni.Union}static isFixedSizeBinary(t){return(null==t?void 0:t.typeId)===ni.FixedSizeBinary}static isFixedSizeList(t){return(null==t?void 0:t.typeId)===ni.FixedSizeList}static isMap(t){return(null==t?void 0:t.typeId)===ni.Map}static isDictionary(t){return(null==t?void 0:t.typeId)===ni.Dictionary}static isDenseUnion(t){return Ir.isUnion(t)&&t.mode===Xn.Dense}static isSparseUnion(t){return Ir.isUnion(t)&&t.mode===Xn.Sparse}get typeId(){return ni.NONE}}rr=Symbol.toStringTag,Ir[rr]=((xr=Ir.prototype).children=null,xr.ArrayType=Array,xr[Symbol.toStringTag]="DataType");class Ar extends Ir{toString(){return"Null"}get typeId(){return ni.Null}}sr=Symbol.toStringTag,Ar[sr]=(t=>t[Symbol.toStringTag]="Null")(Ar.prototype);class Tr extends Ir{constructor(t,e){super(),this.isSigned=t,this.bitWidth=e}get typeId(){return ni.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}or=Symbol.toStringTag,Tr[or]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(Tr.prototype);class Mr extends Tr{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(class extends Tr{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(class extends Tr{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(Mr.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(class extends Tr{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}.prototype,"ArrayType",{value:BigInt64Array}),Object.defineProperty(class extends Tr{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(class extends Tr{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends Tr{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(class extends Tr{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}.prototype,"ArrayType",{value:BigUint64Array});class Br extends Ir{constructor(t){super(),this.precision=t}get typeId(){return ni.Float}get ArrayType(){switch(this.precision){case Kn.HALF:return Uint16Array;case Kn.SINGLE:return Float32Array;case Kn.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}ar=Symbol.toStringTag,Br[ar]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(Br.prototype),Object.defineProperty(class extends Br{constructor(){super(Kn.HALF)}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends Br{constructor(){super(Kn.SINGLE)}}.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(class extends Br{constructor(){super(Kn.DOUBLE)}}.prototype,"ArrayType",{value:Float64Array});class Or extends Ir{constructor(){super()}get typeId(){return ni.Binary}toString(){return"Binary"}}ur=Symbol.toStringTag,Or[ur]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(Or.prototype);class Dr extends Ir{constructor(){super()}get typeId(){return ni.Utf8}toString(){return"Utf8"}}cr=Symbol.toStringTag,Dr[cr]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(Dr.prototype);class Nr extends Ir{constructor(){super()}get typeId(){return ni.Bool}toString(){return"Bool"}}lr=Symbol.toStringTag,Nr[lr]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(Nr.prototype);class Fr extends Ir{constructor(t,e,n=128){super(),this.scale=t,this.precision=e,this.bitWidth=n}get typeId(){return ni.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}hr=Symbol.toStringTag,Fr[hr]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(Fr.prototype);class Lr extends Ir{constructor(t){super(),this.unit=t}get typeId(){return ni.Date}toString(){return`Date${32*(this.unit+1)}<${Jn[this.unit]}>`}}dr=Symbol.toStringTag,Lr[dr]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(Lr.prototype);class Er extends Ir{constructor(t,e){super(),this.unit=t,this.bitWidth=e}get typeId(){return ni.Time}toString(){return`Time${this.bitWidth}<${Qn[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}fr=Symbol.toStringTag,Er[fr]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(Er.prototype);class Ur extends Ir{constructor(t,e){super(),this.unit=t,this.timezone=e}get typeId(){return ni.Timestamp}toString(){return`Timestamp<${Qn[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}pr=Symbol.toStringTag,Ur[pr]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(Ur.prototype);class Cr extends Ir{constructor(t){super(),this.unit=t}get typeId(){return ni.Interval}toString(){return`Interval<${ti[this.unit]}>`}}yr=Symbol.toStringTag,Cr[yr]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(Cr.prototype);class kr extends Ir{constructor(t){super(),this.children=[t]}get typeId(){return ni.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}br=Symbol.toStringTag,kr[br]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(kr.prototype);class Pr extends Ir{constructor(t){super(),this.children=t}get typeId(){return ni.Struct}toString(){return`Struct<{${this.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}vr=Symbol.toStringTag,Pr[vr]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(Pr.prototype);class zr extends Ir{constructor(t,e,n){super(),this.mode=t,this.children=n,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce(((t,e,n)=>(t[e]=n)&&t||t),Object.create(null))}get typeId(){return ni.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map((t=>`${t.type}`)).join(" | ")}>`}}mr=Symbol.toStringTag,zr[mr]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))(zr.prototype);class Rr extends Ir{constructor(t){super(),this.byteWidth=t}get typeId(){return ni.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}gr=Symbol.toStringTag,Rr[gr]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(Rr.prototype);class jr extends Ir{constructor(t,e){super(),this.listSize=t,this.children=[e]}get typeId(){return ni.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}_r=Symbol.toStringTag,jr[_r]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(jr.prototype);class Vr extends Ir{constructor(t,e=!1){super(),this.children=[t],this.keysSorted=e}get typeId(){return ni.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}wr=Symbol.toStringTag,Vr[wr]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(Vr.prototype);const $r=(Yr=-1,()=>++Yr);var Yr;class Gr extends Ir{constructor(t,e,n,i){super(),this.indices=e,this.dictionary=t,this.isOrdered=i||!1,this.id=null==n?$r():"number"==typeof n?n:n.low}get typeId(){return ni.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}function Wr(t){const e=t;switch(t.typeId){case ni.Decimal:return t.bitWidth/32;case ni.Timestamp:return 2;case ni.Date:case ni.Interval:return 1+e.unit;case ni.FixedSizeList:return e.listSize;case ni.FixedSizeBinary:return e.byteWidth;default:return 1}}Sr=Symbol.toStringTag,Gr[Sr]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(Gr.prototype);class qr{visitMany(t,...e){return t.map(((t,n)=>this.visit(t,...e.map((t=>t[n])))))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return function(t,e,n=!0){return"number"==typeof e?Zr(t,e,n):"string"==typeof e&&e in ni?Zr(t,ni[e],n):e&&e instanceof Ir?Zr(t,Hr(e),n):(null==e?void 0:e.type)&&e.type instanceof Ir?Zr(t,Hr(e.type),n):Zr(t,ni.NONE,n)}(this,t,e)}getVisitFnByTypeId(t,e=!0){return Zr(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}}function Zr(t,e,n=!0){let i=null;switch(e){case ni.Null:i=t.visitNull;break;case ni.Bool:i=t.visitBool;break;case ni.Int:i=t.visitInt;break;case ni.Int8:i=t.visitInt8||t.visitInt;break;case ni.Int16:i=t.visitInt16||t.visitInt;break;case ni.Int32:i=t.visitInt32||t.visitInt;break;case ni.Int64:i=t.visitInt64||t.visitInt;break;case ni.Uint8:i=t.visitUint8||t.visitInt;break;case ni.Uint16:i=t.visitUint16||t.visitInt;break;case ni.Uint32:i=t.visitUint32||t.visitInt;break;case ni.Uint64:i=t.visitUint64||t.visitInt;break;case ni.Float:i=t.visitFloat;break;case ni.Float16:i=t.visitFloat16||t.visitFloat;break;case ni.Float32:i=t.visitFloat32||t.visitFloat;break;case ni.Float64:i=t.visitFloat64||t.visitFloat;break;case ni.Utf8:i=t.visitUtf8;break;case ni.Binary:i=t.visitBinary;break;case ni.FixedSizeBinary:i=t.visitFixedSizeBinary;break;case ni.Date:i=t.visitDate;break;case ni.DateDay:i=t.visitDateDay||t.visitDate;break;case ni.DateMillisecond:i=t.visitDateMillisecond||t.visitDate;break;case ni.Timestamp:i=t.visitTimestamp;break;case ni.TimestampSecond:i=t.visitTimestampSecond||t.visitTimestamp;break;case ni.TimestampMillisecond:i=t.visitTimestampMillisecond||t.visitTimestamp;break;case ni.TimestampMicrosecond:i=t.visitTimestampMicrosecond||t.visitTimestamp;break;case ni.TimestampNanosecond:i=t.visitTimestampNanosecond||t.visitTimestamp;break;case ni.Time:i=t.visitTime;break;case ni.TimeSecond:i=t.visitTimeSecond||t.visitTime;break;case ni.TimeMillisecond:i=t.visitTimeMillisecond||t.visitTime;break;case ni.TimeMicrosecond:i=t.visitTimeMicrosecond||t.visitTime;break;case ni.TimeNanosecond:i=t.visitTimeNanosecond||t.visitTime;break;case ni.Decimal:i=t.visitDecimal;break;case ni.List:i=t.visitList;break;case ni.Struct:i=t.visitStruct;break;case ni.Union:i=t.visitUnion;break;case ni.DenseUnion:i=t.visitDenseUnion||t.visitUnion;break;case ni.SparseUnion:i=t.visitSparseUnion||t.visitUnion;break;case ni.Dictionary:i=t.visitDictionary;break;case ni.Interval:i=t.visitInterval;break;case ni.IntervalDayTime:i=t.visitIntervalDayTime||t.visitInterval;break;case ni.IntervalYearMonth:i=t.visitIntervalYearMonth||t.visitInterval;break;case ni.FixedSizeList:i=t.visitFixedSizeList;break;case ni.Map:i=t.visitMap}if("function"==typeof i)return i;if(!n)return()=>null;throw new Error(`Unrecognized type '${ni[e]}'`)}function Hr(t){switch(t.typeId){case ni.Null:return ni.Null;case ni.Int:{const{bitWidth:e,isSigned:n}=t;switch(e){case 8:return n?ni.Int8:ni.Uint8;case 16:return n?ni.Int16:ni.Uint16;case 32:return n?ni.Int32:ni.Uint32;case 64:return n?ni.Int64:ni.Uint64}return ni.Int}case ni.Float:switch(t.precision){case Kn.HALF:return ni.Float16;case Kn.SINGLE:return ni.Float32;case Kn.DOUBLE:return ni.Float64}return ni.Float;case ni.Binary:return ni.Binary;case ni.Utf8:return ni.Utf8;case ni.Bool:return ni.Bool;case ni.Decimal:return ni.Decimal;case ni.Time:switch(t.unit){case Qn.SECOND:return ni.TimeSecond;case Qn.MILLISECOND:return ni.TimeMillisecond;case Qn.MICROSECOND:return ni.TimeMicrosecond;case Qn.NANOSECOND:return ni.TimeNanosecond}return ni.Time;case ni.Timestamp:switch(t.unit){case Qn.SECOND:return ni.TimestampSecond;case Qn.MILLISECOND:return ni.TimestampMillisecond;case Qn.MICROSECOND:return ni.TimestampMicrosecond;case Qn.NANOSECOND:return ni.TimestampNanosecond}return ni.Timestamp;case ni.Date:switch(t.unit){case Jn.DAY:return ni.DateDay;case Jn.MILLISECOND:return ni.DateMillisecond}return ni.Date;case ni.Interval:switch(t.unit){case ti.DAY_TIME:return ni.IntervalDayTime;case ti.YEAR_MONTH:return ni.IntervalYearMonth}return ni.Interval;case ni.Map:return ni.Map;case ni.List:return ni.List;case ni.Struct:return ni.Struct;case ni.Union:switch(t.mode){case Xn.Dense:return ni.DenseUnion;case Xn.Sparse:return ni.SparseUnion}return ni.Union;case ni.FixedSizeBinary:return ni.FixedSizeBinary;case ni.FixedSizeList:return ni.FixedSizeList;case ni.Dictionary:return ni.Dictionary}throw new Error(`Unrecognized type '${ni[t.typeId]}'`)}qr.prototype.visitInt8=null,qr.prototype.visitInt16=null,qr.prototype.visitInt32=null,qr.prototype.visitInt64=null,qr.prototype.visitUint8=null,qr.prototype.visitUint16=null,qr.prototype.visitUint32=null,qr.prototype.visitUint64=null,qr.prototype.visitFloat16=null,qr.prototype.visitFloat32=null,qr.prototype.visitFloat64=null,qr.prototype.visitDateDay=null,qr.prototype.visitDateMillisecond=null,qr.prototype.visitTimestampSecond=null,qr.prototype.visitTimestampMillisecond=null,qr.prototype.visitTimestampMicrosecond=null,qr.prototype.visitTimestampNanosecond=null,qr.prototype.visitTimeSecond=null,qr.prototype.visitTimeMillisecond=null,qr.prototype.visitTimeMicrosecond=null,qr.prototype.visitTimeNanosecond=null,qr.prototype.visitDenseUnion=null,qr.prototype.visitSparseUnion=null,qr.prototype.visitIntervalDayTime=null,qr.prototype.visitIntervalYearMonth=null;const Xr=new Float64Array(1),Kr=new Uint32Array(Xr.buffer);function Jr(t){const e=(31744&t)>>10,n=(1023&t)/1024,i=Math.pow(-1,(32768&t)>>15);switch(e){case 31:return i*(n?Number.NaN:1/0);case 0:return i*(n?6103515625e-14*n:0)}return i*Math.pow(2,e-15)*(1+n)}class Qr extends qr{}function ts(t){return(e,n,i)=>{if(e.setValid(n,null!=i))return t(e,n,i)}}const es=(t,e,n)=>{t[e]=Math.trunc(n%4294967296),t[e+1]=Math.trunc(n/4294967296)},ns=(t,e,n,i)=>{if(n+1<e.length){const{[n]:r,[n+1]:s}=e;t.set(i.subarray(0,s-r),r)}},is=({values:t},e,n)=>{t[e]=n},rs=({values:t},e,n)=>{t[e]=n},ss=({values:t},e,n)=>{t[e]=function(t){if(t!=t)return 32256;Xr[0]=t;const e=(2147483648&Kr[1])>>16&65535;let n=2146435072&Kr[1],i=0;return n>=1089470464?Kr[0]>0?n=31744:(n=(2080374784&n)>>16,i=(1048575&Kr[1])>>10):n<=1056964608?(i=1048576+(1048575&Kr[1]),i=1048576+(i<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,i=512+(1048575&Kr[1])>>10),e|n|65535&i}(n)},os=({values:t},e,n)=>{((t,e,n)=>{t[e]=Math.trunc(n/864e5)})(t,e,n.valueOf())},as=({values:t},e,n)=>{es(t,2*e,n.valueOf())},us=({values:t},e,n)=>es(t,2*e,n/1e3),cs=({values:t},e,n)=>es(t,2*e,n),ls=({values:t},e,n)=>((t,e,n)=>{t[e]=Math.trunc(1e3*n%4294967296),t[e+1]=Math.trunc(1e3*n/4294967296)})(t,2*e,n),hs=({values:t},e,n)=>((t,e,n)=>{t[e]=Math.trunc(1e6*n%4294967296),t[e+1]=Math.trunc(1e6*n/4294967296)})(t,2*e,n),ds=({values:t},e,n)=>{t[e]=n},fs=({values:t},e,n)=>{t[e]=n},ps=({values:t},e,n)=>{t[e]=n},ys=({values:t},e,n)=>{t[e]=n},bs=(t,e,n)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[i];_s.visit(r,t.valueOffsets[e],n)},vs=(t,e,n)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[i];_s.visit(r,e,n)},ms=({values:t},e,n)=>{t.set(n.subarray(0,2),2*e)},gs=({values:t},e,n)=>{t[e]=12*n[0]+n[1]%12};Qr.prototype.visitBool=ts((({offset:t,values:e},n,i)=>{const r=t+n;i?e[r>>3]|=1<<r%8:e[r>>3]&=~(1<<r%8)})),Qr.prototype.visitInt=ts(is),Qr.prototype.visitInt8=ts(is),Qr.prototype.visitInt16=ts(is),Qr.prototype.visitInt32=ts(is),Qr.prototype.visitInt64=ts(is),Qr.prototype.visitUint8=ts(is),Qr.prototype.visitUint16=ts(is),Qr.prototype.visitUint32=ts(is),Qr.prototype.visitUint64=ts(is),Qr.prototype.visitFloat=ts(((t,e,n)=>{switch(t.type.precision){case Kn.HALF:return ss(t,e,n);case Kn.SINGLE:case Kn.DOUBLE:return rs(t,e,n)}})),Qr.prototype.visitFloat16=ts(ss),Qr.prototype.visitFloat32=ts(rs),Qr.prototype.visitFloat64=ts(rs),Qr.prototype.visitUtf8=ts((({values:t,valueOffsets:e},n,i)=>{ns(t,e,n,_i(i))})),Qr.prototype.visitBinary=ts((({values:t,valueOffsets:e},n,i)=>ns(t,e,n,i))),Qr.prototype.visitFixedSizeBinary=ts((({stride:t,values:e},n,i)=>{e.set(i.subarray(0,t),t*n)})),Qr.prototype.visitDate=ts(((t,e,n)=>{t.type.unit===Jn.DAY?os(t,e,n):as(t,e,n)})),Qr.prototype.visitDateDay=ts(os),Qr.prototype.visitDateMillisecond=ts(as),Qr.prototype.visitTimestamp=ts(((t,e,n)=>{switch(t.type.unit){case Qn.SECOND:return us(t,e,n);case Qn.MILLISECOND:return cs(t,e,n);case Qn.MICROSECOND:return ls(t,e,n);case Qn.NANOSECOND:return hs(t,e,n)}})),Qr.prototype.visitTimestampSecond=ts(us),Qr.prototype.visitTimestampMillisecond=ts(cs),Qr.prototype.visitTimestampMicrosecond=ts(ls),Qr.prototype.visitTimestampNanosecond=ts(hs),Qr.prototype.visitTime=ts(((t,e,n)=>{switch(t.type.unit){case Qn.SECOND:return ds(t,e,n);case Qn.MILLISECOND:return fs(t,e,n);case Qn.MICROSECOND:return ps(t,e,n);case Qn.NANOSECOND:return ys(t,e,n)}})),Qr.prototype.visitTimeSecond=ts(ds),Qr.prototype.visitTimeMillisecond=ts(fs),Qr.prototype.visitTimeMicrosecond=ts(ps),Qr.prototype.visitTimeNanosecond=ts(ys),Qr.prototype.visitDecimal=ts((({values:t,stride:e},n,i)=>{t.set(i.subarray(0,e),e*n)})),Qr.prototype.visitList=ts(((t,e,n)=>{const i=t.children[0],r=t.valueOffsets,s=_s.getVisitFn(i);if(Array.isArray(n))for(let t=-1,o=r[e],a=r[e+1];o<a;)s(i,o++,n[++t]);else for(let t=-1,o=r[e],a=r[e+1];o<a;)s(i,o++,n.get(++t))})),Qr.prototype.visitStruct=ts(((t,e,n)=>{const i=t.type.children.map((t=>_s.getVisitFn(t.type))),r=n instanceof Map?(s=e,o=n,(t,e,n,i)=>e&&t(e,s,o.get(n.name))):n instanceof ko?((t,e)=>(n,i,r,s)=>i&&n(i,t,e.get(s)))(e,n):Array.isArray(n)?((t,e)=>(n,i,r,s)=>i&&n(i,t,e[s]))(e,n):((t,e)=>(n,i,r,s)=>i&&n(i,t,e[r.name]))(e,n);var s,o;t.type.children.forEach(((e,n)=>r(i[n],t.children[n],e,n)))})),Qr.prototype.visitUnion=ts(((t,e,n)=>{t.type.mode===Xn.Dense?bs(t,e,n):vs(t,e,n)})),Qr.prototype.visitDenseUnion=ts(bs),Qr.prototype.visitSparseUnion=ts(vs),Qr.prototype.visitDictionary=ts(((t,e,n)=>{var i;null===(i=t.dictionary)||void 0===i||i.set(t.values[e],n)})),Qr.prototype.visitInterval=ts(((t,e,n)=>{t.type.unit===ti.DAY_TIME?ms(t,e,n):gs(t,e,n)})),Qr.prototype.visitIntervalDayTime=ts(ms),Qr.prototype.visitIntervalYearMonth=ts(gs),Qr.prototype.visitFixedSizeList=ts(((t,e,n)=>{const{stride:i}=t,r=t.children[0],s=_s.getVisitFn(r);if(Array.isArray(n))for(let t=-1,o=e*i;++t<i;)s(r,o+t,n[t]);else for(let t=-1,o=e*i;++t<i;)s(r,o+t,n.get(t))})),Qr.prototype.visitMap=ts(((t,e,n)=>{const i=t.children[0],{valueOffsets:r}=t,s=_s.getVisitFn(i);let{[e]:o,[e+1]:a}=r;const u=n instanceof Map?n.entries():Object.entries(n);for(const t of u)if(s(i,o,t),++o>=a)break}));const _s=new Qr,ws=Symbol.for("parent"),Ss=Symbol.for("rowIndex");class xs{constructor(t,e){return this[ws]=t,this[Ss]=e,new Proxy(this,new As)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[Ss],e=this[ws],n=e.type.children,i={};for(let r=-1,s=n.length;++r<s;)i[n[r].name]=qs.visit(e.children[r],t);return i}toString(){return`{${[...this].map((([t,e])=>`${hi(t)}: ${hi(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new Is(this[ws],this[Ss])}}class Is{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,qs.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(xs.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[ws]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Ss]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class As{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[ws].type.children.map((t=>t.name))}has(t,e){return-1!==t[ws].type.children.findIndex((t=>t.name===e))}getOwnPropertyDescriptor(t,e){if(-1!==t[ws].type.children.findIndex((t=>t.name===e)))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[ws].type.children.findIndex((t=>t.name===e));if(-1!==n){const i=qs.visit(t[ws].children[n],t[Ss]);return Reflect.set(t,e,i),i}}set(t,e,n){const i=t[ws].type.children.findIndex((t=>t.name===e));return-1!==i?(_s.visit(t[ws].children[i],t[Ss],n),Reflect.set(t,e,n)):!(!Reflect.has(t,e)&&"symbol"!=typeof e)&&Reflect.set(t,e,n)}}class Ts extends qr{}function Ms(t){return(e,n)=>e.getValid(n)?t(e,n):null}const Bs=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),Os=t=>new Date(t),Ds=(t,e,n)=>{if(n+1>=e.length)return null;const i=e[n],r=e[n+1];return t.subarray(i,r)},Ns=({values:t},e)=>((t,e)=>Os(((t,e)=>864e5*t[e])(t,e)))(t,e),Fs=({values:t},e)=>((t,e)=>Os(Bs(t,e)))(t,2*e),Ls=({stride:t,values:e},n)=>e[t*n],Es=({values:t},e)=>t[e],Us=({values:t},e)=>1e3*Bs(t,2*e),Cs=({values:t},e)=>Bs(t,2*e),ks=({values:t},e)=>((t,e)=>t[e+1]/1e3*4294967296+(t[e]>>>0)/1e3)(t,2*e),Ps=({values:t},e)=>((t,e)=>t[e+1]/1e6*4294967296+(t[e]>>>0)/1e6)(t,2*e),zs=({values:t},e)=>t[e],Rs=({values:t},e)=>t[e],js=({values:t},e)=>t[e],Vs=({values:t},e)=>t[e],$s=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[n];return qs.visit(i,t.valueOffsets[e])},Ys=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[n];return qs.visit(i,e)},Gs=({values:t},e)=>t.subarray(2*e,2*(e+1)),Ws=({values:t},e)=>{const n=t[e],i=new Int32Array(2);return i[0]=Math.trunc(n/12),i[1]=Math.trunc(n%12),i};Ts.prototype.visitNull=Ms(((t,e)=>null)),Ts.prototype.visitBool=Ms((({offset:t,values:e},n)=>{const i=t+n;return 0!=(e[i>>3]&1<<i%8)})),Ts.prototype.visitInt=Ms((({values:t},e)=>t[e])),Ts.prototype.visitInt8=Ms(Ls),Ts.prototype.visitInt16=Ms(Ls),Ts.prototype.visitInt32=Ms(Ls),Ts.prototype.visitInt64=Ms(Es),Ts.prototype.visitUint8=Ms(Ls),Ts.prototype.visitUint16=Ms(Ls),Ts.prototype.visitUint32=Ms(Ls),Ts.prototype.visitUint64=Ms(Es),Ts.prototype.visitFloat=Ms((({type:t,values:e},n)=>t.precision!==Kn.HALF?e[n]:Jr(e[n]))),Ts.prototype.visitFloat16=Ms((({stride:t,values:e},n)=>Jr(e[t*n]))),Ts.prototype.visitFloat32=Ms(Ls),Ts.prototype.visitFloat64=Ms(Ls),Ts.prototype.visitUtf8=Ms((({values:t,valueOffsets:e},n)=>{const i=Ds(t,e,n);return null!==i?mi(i):null})),Ts.prototype.visitBinary=Ms((({values:t,valueOffsets:e},n)=>Ds(t,e,n))),Ts.prototype.visitFixedSizeBinary=Ms((({stride:t,values:e},n)=>e.subarray(t*n,t*(n+1)))),Ts.prototype.visitDate=Ms(((t,e)=>t.type.unit===Jn.DAY?Ns(t,e):Fs(t,e))),Ts.prototype.visitDateDay=Ms(Ns),Ts.prototype.visitDateMillisecond=Ms(Fs),Ts.prototype.visitTimestamp=Ms(((t,e)=>{switch(t.type.unit){case Qn.SECOND:return Us(t,e);case Qn.MILLISECOND:return Cs(t,e);case Qn.MICROSECOND:return ks(t,e);case Qn.NANOSECOND:return Ps(t,e)}})),Ts.prototype.visitTimestampSecond=Ms(Us),Ts.prototype.visitTimestampMillisecond=Ms(Cs),Ts.prototype.visitTimestampMicrosecond=Ms(ks),Ts.prototype.visitTimestampNanosecond=Ms(Ps),Ts.prototype.visitTime=Ms(((t,e)=>{switch(t.type.unit){case Qn.SECOND:return zs(t,e);case Qn.MILLISECOND:return Rs(t,e);case Qn.MICROSECOND:return js(t,e);case Qn.NANOSECOND:return Vs(t,e)}})),Ts.prototype.visitTimeSecond=Ms(zs),Ts.prototype.visitTimeMillisecond=Ms(Rs),Ts.prototype.visitTimeMicrosecond=Ms(js),Ts.prototype.visitTimeNanosecond=Ms(Vs),Ts.prototype.visitDecimal=Ms((({values:t,stride:e},n)=>ir.decimal(t.subarray(e*n,e*(n+1))))),Ts.prototype.visitList=Ms(((t,e)=>{const{valueOffsets:n,stride:i,children:r}=t,{[e*i]:s,[e*i+1]:o}=n,a=r[0].slice(s,o-s);return new ko([a])})),Ts.prototype.visitStruct=Ms(((t,e)=>new xs(t,e))),Ts.prototype.visitUnion=Ms(((t,e)=>t.type.mode===Xn.Dense?$s(t,e):Ys(t,e))),Ts.prototype.visitDenseUnion=Ms($s),Ts.prototype.visitSparseUnion=Ms(Ys),Ts.prototype.visitDictionary=Ms(((t,e)=>{var n;return null===(n=t.dictionary)||void 0===n?void 0:n.get(t.values[e])})),Ts.prototype.visitInterval=Ms(((t,e)=>t.type.unit===ti.DAY_TIME?Gs(t,e):Ws(t,e))),Ts.prototype.visitIntervalDayTime=Ms(Gs),Ts.prototype.visitIntervalYearMonth=Ms(Ws),Ts.prototype.visitFixedSizeList=Ms(((t,e)=>{const{stride:n,children:i}=t,r=i[0].slice(e*n,n);return new ko([r])})),Ts.prototype.visitMap=Ms(((t,e)=>{const{valueOffsets:n,children:i}=t,{[e]:r,[e+1]:s}=n,o=i[0];return new Xs(o.slice(r,s-r))}));const qs=new Ts,Zs=Symbol.for("keys"),Hs=Symbol.for("vals");class Xs{constructor(t){return this[Zs]=new ko([t.children[0]]).memoize(),this[Hs]=t.children[1],new Proxy(this,new Js)}[Symbol.iterator](){return new Ks(this[Zs],this[Hs])}get size(){return this[Zs].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[Zs],e=this[Hs],n={};for(let i=-1,r=t.length;++i<r;)n[t.get(i)]=qs.visit(e,i);return n}toString(){return`{${[...this].map((([t,e])=>`${hi(t)}: ${hi(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class Ks{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),qs.visit(this.vals,t)]})}}class Js{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Zs].toArray().map(String)}has(t,e){return t[Zs].includes(e)}getOwnPropertyDescriptor(t,e){if(-1!==t[Zs].indexOf(e))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[Zs].indexOf(e);if(-1!==n){const i=qs.visit(Reflect.get(t,Hs),n);return Reflect.set(t,e,i),i}}set(t,e,n){const i=t[Zs].indexOf(e);return-1!==i?(_s.visit(Reflect.get(t,Hs),i,n),Reflect.set(t,e,n)):!!Reflect.has(t,e)&&Reflect.set(t,e,n)}}let Qs;function to(t,e,n,i){const{length:r=0}=t;let s="number"!=typeof e?0:e,o="number"!=typeof n?r:n;return s<0&&(s=(s%r+r)%r),o<0&&(o=(o%r+r)%r),o<s&&(Qs=s,s=o,o=Qs),o>r&&(o=r),i?i(t,s,o):[s,o]}Object.defineProperties(Xs.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Zs]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Hs]:{writable:!0,enumerable:!1,configurable:!1,value:null}});const eo=t=>t!=t;function no(t){if("object"!=typeof t||null===t)return eo(t)?eo:e=>e===t;if(t instanceof Date){const e=t.valueOf();return t=>t instanceof Date&&t.valueOf()===e}return ArrayBuffer.isView(t)?e=>!!e&&function(t,e){let n=0;const i=t.length;if(i!==e.length)return!1;if(i>0)do{if(t[n]!==e[n])return!1}while(++n<i);return!0}(t,e):t instanceof Map?function(t){let e=-1;const n=[];for(const i of t.values())n[++e]=no(i);return io(n)}(t):Array.isArray(t)?function(t){const e=[];for(let n=-1,i=t.length;++n<i;)e[n]=no(t[n]);return io(e)}(t):t instanceof ko?function(t){const e=[];for(let n=-1,i=t.length;++n<i;)e[n]=no(t.get(n));return io(e)}(t):function(t,e=!1){const n=Object.keys(t);if(!e&&0===n.length)return()=>!1;const i=[];for(let e=-1,r=n.length;++e<r;)i[e]=no(t[n[e]]);return io(i,n)}(t,!0)}function io(t,e){return n=>{if(!n||"object"!=typeof n)return!1;switch(n.constructor){case Array:return function(t,e){const n=t.length;if(e.length!==n)return!1;for(let i=-1;++i<n;)if(!t[i](e[i]))return!1;return!0}(t,n);case Map:return ro(t,n,n.keys());case Xs:case xs:case Object:case void 0:return ro(t,n,e||Object.keys(n))}return n instanceof ko&&function(t,e){const n=t.length;if(e.length!==n)return!1;for(let i=-1;++i<n;)if(!t[i](e.get(i)))return!1;return!0}(t,n)}}function ro(t,e,n){const i=n[Symbol.iterator](),r=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),s=e instanceof Map?e.values():Object.values(e)[Symbol.iterator]();let o=0;const a=t.length;let u=s.next(),c=i.next(),l=r.next();for(;o<a&&!c.done&&!l.done&&!u.done&&c.value===l.value&&t[o](u.value);++o,c=i.next(),l=r.next(),u=s.next());return!!(o===a&&c.done&&l.done&&u.done)||(i.return&&i.return(),r.return&&r.return(),s.return&&s.return(),!1)}class so{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function oo(t){return t.reduce(((t,e)=>t+e.nullCount),0)}function ao(t){return t.reduce(((t,e,n)=>(t[n+1]=t[n]+e.length,t)),new Uint32Array(t.length+1))}function uo(t,e,n,i){const r=[];for(let s=-1,o=t.length;++s<o;){const o=t[s],a=e[s],{length:u}=o;if(a>=i)break;if(n>=a+u)continue;if(a>=n&&a+u<=i){r.push(o);continue}const c=Math.max(0,n-a),l=Math.min(i-a,u);r.push(o.slice(c,l-c))}return 0===r.length&&r.push(t[0].slice(0,0)),r}function co(t,e,n,i){let r=0,s=0,o=e.length-1;do{if(r>=o-1)return n<e[o]?i(t,r,n-e[r]):null;s=r+Math.trunc(.5*(o-r)),n<e[s]?o=s:r=s}while(r<o)}function lo(t,e){return t.getValid(e)}function ho(t){function e(e,n,i){return t(e[n],i)}return function(t){return co(this.data,this._offsets,t,e)}}function fo(t){let e;function n(n,i,r){return t(n[i],r,e)}return function(t,i){const r=this.data;e=i;const s=co(r,this._offsets,t,n);return e=void 0,s}}function po(t){let e;function n(n,i,r){let s=r,o=0,a=0;for(let r=i-1,u=n.length;++r<u;){const i=n[r];if(~(o=t(i,e,s)))return a+o;s=0,a+=i.length}return-1}return function(t,i){e=t;const r=this.data,s="number"!=typeof i?n(r,0,0):co(r,this._offsets,i,n);return e=void 0,s}}function yo(t,e,n,i){return 0!=(n&1<<i)}function bo(t,e,n,i){return(n&1<<i)>>i}function vo(t){const e=[];let n=0,i=0,r=0;for(const s of t)s&&(r|=1<<i),8==++i&&(e[n++]=r,r=i=0);(0===n||i>0)&&(e[n++]=r);const s=new Uint8Array(e.length+7&-8);return s.set(e),s}class mo{constructor(t,e,n,i,r){this.bytes=t,this.length=n,this.context=i,this.get=r,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function go(t,e,n){if(n-e<=0)return 0;if(n-e<8){let i=0;for(const r of new mo(t,e,n-e,t,bo))i+=r;return i}const i=n>>3<<3,r=e+(e%8==0?0:8-e%8);return go(t,e,r)+go(t,i,n)+function(t,e,n){let i=0,r=Math.trunc(e);const s=new DataView(t.buffer,t.byteOffset,t.byteLength),o=void 0===n?t.byteLength:r+n;for(;o-r>=4;)i+=_o(s.getUint32(r)),r+=4;for(;o-r>=2;)i+=_o(s.getUint16(r)),r+=2;for(;o-r>=1;)i+=_o(s.getUint8(r)),r+=1;return i}(t,r>>3,i-r>>3)}function _o(t){let e=Math.trunc(t);return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24}class wo extends qr{}function So(t,e,n){if(void 0===e)return-1;if(null===e)return function(t,e){const{nullBitmap:n}=t;if(!n||t.nullCount<=0)return-1;let i=0;for(const r of new mo(n,t.offset+(e||0),t.length,n,yo)){if(!r)return i;++i}return-1}(t,n);const i=qs.getVisitFn(t),r=no(e);for(let e=(n||0)-1,s=t.length;++e<s;)if(r(i(t,e)))return e;return-1}function xo(t,e,n){const i=qs.getVisitFn(t),r=no(e);for(let e=(n||0)-1,s=t.length;++e<s;)if(r(i(t,e)))return e;return-1}wo.prototype.visitNull=function(t,e){return null===e&&t.length>0?0:-1},wo.prototype.visitBool=So,wo.prototype.visitInt=So,wo.prototype.visitInt8=So,wo.prototype.visitInt16=So,wo.prototype.visitInt32=So,wo.prototype.visitInt64=So,wo.prototype.visitUint8=So,wo.prototype.visitUint16=So,wo.prototype.visitUint32=So,wo.prototype.visitUint64=So,wo.prototype.visitFloat=So,wo.prototype.visitFloat16=So,wo.prototype.visitFloat32=So,wo.prototype.visitFloat64=So,wo.prototype.visitUtf8=So,wo.prototype.visitBinary=So,wo.prototype.visitFixedSizeBinary=So,wo.prototype.visitDate=So,wo.prototype.visitDateDay=So,wo.prototype.visitDateMillisecond=So,wo.prototype.visitTimestamp=So,wo.prototype.visitTimestampSecond=So,wo.prototype.visitTimestampMillisecond=So,wo.prototype.visitTimestampMicrosecond=So,wo.prototype.visitTimestampNanosecond=So,wo.prototype.visitTime=So,wo.prototype.visitTimeSecond=So,wo.prototype.visitTimeMillisecond=So,wo.prototype.visitTimeMicrosecond=So,wo.prototype.visitTimeNanosecond=So,wo.prototype.visitDecimal=So,wo.prototype.visitList=So,wo.prototype.visitStruct=So,wo.prototype.visitUnion=So,wo.prototype.visitDenseUnion=xo,wo.prototype.visitSparseUnion=xo,wo.prototype.visitDictionary=So,wo.prototype.visitInterval=So,wo.prototype.visitIntervalDayTime=So,wo.prototype.visitIntervalYearMonth=So,wo.prototype.visitFixedSizeList=So,wo.prototype.visitMap=So;const Io=new wo;class Ao extends qr{}function To(t){const{type:e}=t;if(0===t.nullCount&&1===t.stride&&(e.typeId===ni.Timestamp||e instanceof Tr&&64!==e.bitWidth||e instanceof Er&&64!==e.bitWidth||e instanceof Br&&e.precision!==Kn.HALF))return new so(t.data.length,(e=>{const n=t.data[e];return n.values.subarray(0,n.length)[Symbol.iterator]()}));let n=0;return new so(t.data.length,(e=>{const i=t.data[e].length,r=t.slice(n,n+i);return n+=i,new Mo(r)}))}class Mo{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}Ao.prototype.visitNull=To,Ao.prototype.visitBool=To,Ao.prototype.visitInt=To,Ao.prototype.visitInt8=To,Ao.prototype.visitInt16=To,Ao.prototype.visitInt32=To,Ao.prototype.visitInt64=To,Ao.prototype.visitUint8=To,Ao.prototype.visitUint16=To,Ao.prototype.visitUint32=To,Ao.prototype.visitUint64=To,Ao.prototype.visitFloat=To,Ao.prototype.visitFloat16=To,Ao.prototype.visitFloat32=To,Ao.prototype.visitFloat64=To,Ao.prototype.visitUtf8=To,Ao.prototype.visitBinary=To,Ao.prototype.visitFixedSizeBinary=To,Ao.prototype.visitDate=To,Ao.prototype.visitDateDay=To,Ao.prototype.visitDateMillisecond=To,Ao.prototype.visitTimestamp=To,Ao.prototype.visitTimestampSecond=To,Ao.prototype.visitTimestampMillisecond=To,Ao.prototype.visitTimestampMicrosecond=To,Ao.prototype.visitTimestampNanosecond=To,Ao.prototype.visitTime=To,Ao.prototype.visitTimeSecond=To,Ao.prototype.visitTimeMillisecond=To,Ao.prototype.visitTimeMicrosecond=To,Ao.prototype.visitTimeNanosecond=To,Ao.prototype.visitDecimal=To,Ao.prototype.visitList=To,Ao.prototype.visitStruct=To,Ao.prototype.visitUnion=To,Ao.prototype.visitDenseUnion=To,Ao.prototype.visitSparseUnion=To,Ao.prototype.visitDictionary=To,Ao.prototype.visitInterval=To,Ao.prototype.visitIntervalDayTime=To,Ao.prototype.visitIntervalYearMonth=To,Ao.prototype.visitFixedSizeList=To,Ao.prototype.visitMap=To;const Bo=new Ao,Oo=(t,e)=>t+e;class Do extends qr{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return t.type.bitWidth/8}visitDate(t,e){return 4*(t.type.unit+1)}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===Qn.SECOND?4:8}visitInterval(t,e){return 4*(t.type.unit+1)}visitStruct(t,e){return t.children.reduce(((t,n)=>t+Lo.visit(n,e)),0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return 8+t.children.reduce(((t,n)=>t+Lo.visit(n,e)),0)}visitDictionary(t,e){var n;return t.type.indices.bitWidth/8+((null===(n=t.dictionary)||void 0===n?void 0:n.getByteLength(t.values[e]))||0)}}const No=({type:t,children:e,typeIds:n,valueOffsets:i},r)=>{const s=t.typeIdToChildIndex[n[r]];return 8+Lo.visit(e[s],i[r])},Fo=({children:t},e)=>4+Lo.visitMany(t,t.map((()=>e))).reduce(Oo,0);Do.prototype.visitUtf8=({valueOffsets:t},e)=>t[e+1]-t[e]+8,Do.prototype.visitBinary=({valueOffsets:t},e)=>t[e+1]-t[e]+8,Do.prototype.visitList=({valueOffsets:t,stride:e,children:n},i)=>{const r=n[0],{[i*e]:s}=t,{[i*e+1]:o}=t,a=Lo.getVisitFn(r.type),u=r.slice(s,o-s);let c=8;for(let t=-1,e=o-s;++t<e;)c+=a(u,t);return c},Do.prototype.visitFixedSizeList=({stride:t,children:e},n)=>{const i=e[0],r=i.slice(n*t,t),s=Lo.getVisitFn(i.type);let o=0;for(let t=-1,e=r.length;++t<e;)o+=s(r,t);return o},Do.prototype.visitUnion=(t,e)=>t.type.mode===Xn.Dense?No(t,e):Fo(t,e),Do.prototype.visitDenseUnion=No,Do.prototype.visitSparseUnion=Fo;const Lo=new Do;var Eo;const Uo={},Co={};class ko{constructor(t){var e,n,i;const r=t[0]instanceof ko?t.flatMap((t=>t.data)):t;if(0===r.length||r.some((t=>!(t instanceof zo))))throw new TypeError("Vector constructor expects an Array of Data instances.");const s=null===(e=r[0])||void 0===e?void 0:e.type;switch(r.length){case 0:this._offsets=[0];break;case 1:{const{get:t,set:e,indexOf:n,byteLength:i}=Uo[s.typeId],o=r[0];this.isValid=t=>lo(o,t),this.get=e=>t(o,e),this.set=(t,n)=>e(o,t,n),this.indexOf=t=>n(o,t),this.getByteLength=t=>i(o,t),this._offsets=[0,o.length];break}default:Object.setPrototypeOf(this,Co[s.typeId]),this._offsets=ao(r)}this.data=r,this.type=s,this.stride=Wr(s),this.numChildren=null!==(i=null===(n=s.children)||void 0===n?void 0:n.length)&&void 0!==i?i:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return-1===this._byteLength&&(this._byteLength=this.data.reduce(((t,e)=>t+e.byteLength),0)),this._byteLength}get nullCount(){return-1===this._nullCount&&(this._nullCount=oo(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${ni[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>0}getByteLength(t){return 0}[Symbol.iterator](){return Bo.visit(this)}concat(...t){return new ko(this.data.concat(t.flatMap((t=>t.data)).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new ko(to(this,t,e,(({data:t,_offsets:e},n,i)=>uo(t,e,n,i))))}toJSON(){return[...this]}toArray(){const{type:t,data:e,length:n,stride:i,ArrayType:r}=this;switch(t.typeId){case ni.Int:case ni.Float:case ni.Decimal:case ni.Time:case ni.Timestamp:switch(e.length){case 0:return new r;case 1:return e[0].values.subarray(0,n*i);default:return e.reduce(((t,{values:e})=>(t.array.set(e,t.offset),t.offset+=e.length,t)),{array:new r(n*i),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt(null===(e=this.type.children)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.numChildren?new ko(this.data.map((({children:e})=>e[t]))):null}get isMemoized(){return!!Ir.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(Ir.isDictionary(this.type)){const t=new Po(this.data[0].dictionary),e=this.data.map((e=>{const n=e.clone();return n.dictionary=t,n}));return new ko(e)}return new Po(this)}unmemoize(){if(Ir.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),e=this.data.map((e=>{const n=e.clone();return n.dictionary=t,n}));return new ko(e)}return this}}Eo=Symbol.toStringTag,ko[Eo]=(t=>{t.type=Ir.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._nullCount=-1,t._byteLength=-1,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;const e=Object.keys(ni).map((t=>ni[t])).filter((t=>"number"==typeof t&&t!==ni.NONE));for(const n of e){const e=qs.getVisitFnByTypeId(n),i=_s.getVisitFnByTypeId(n),r=Io.getVisitFnByTypeId(n),s=Lo.getVisitFnByTypeId(n);Uo[n]={get:e,set:i,indexOf:r,byteLength:s},Co[n]=Object.create(t,{isValid:{value:ho(lo)},get:{value:ho(qs.getVisitFnByTypeId(n))},set:{value:fo(_s.getVisitFnByTypeId(n))},indexOf:{value:po(Io.getVisitFnByTypeId(n))},getByteLength:{value:ho(Lo.getVisitFnByTypeId(n))}})}return"Vector"})(ko.prototype);class Po extends ko{constructor(t){super(t.data);const e=this.get,n=this.set,i=this.slice,r=new Array(this.length);Object.defineProperty(this,"get",{value(t){const n=r[t];if(void 0!==n)return n;const i=e.call(this,t);return r[t]=i,i}}),Object.defineProperty(this,"set",{value(t,e){n.call(this,t,e),r[t]=e}}),Object.defineProperty(this,"slice",{value:(t,e)=>new Po(i.call(this,t,e))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new ko(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class zo{constructor(t,e,n,i,r,s=[],o){let a;this.type=t,this.children=s,this.dictionary=o,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(i||0,-1)),r instanceof zo?(this.stride=r.stride,this.values=r.values,this.typeIds=r.typeIds,this.nullBitmap=r.nullBitmap,this.valueOffsets=r.valueOffsets):(this.stride=Wr(t),r&&((a=r[0])&&(this.valueOffsets=a),(a=r[1])&&(this.values=a),(a=r[2])&&(this.nullBitmap=a),(a=r[3])&&(this.typeIds=a))),this.nullable=0!==this._nullCount&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0;const{valueOffsets:e,values:n,nullBitmap:i,typeIds:r}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),i&&(t+=i.byteLength),r&&(t+=r.byteLength),this.children.reduce(((t,e)=>t+e.byteLength),t)}get nullCount(){let t,e=this._nullCount;return e<=-1&&(t=this.nullBitmap)&&(this._nullCount=e=this.length-go(t,this.offset,this.offset+this.length)),e}getValid(t){if(this.nullable&&this.nullCount>0){const e=this.offset+t;return 0!=(this.nullBitmap[e>>3]&1<<e%8)}return!0}setValid(t,e){if(!this.nullable)return e;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){const{nullBitmap:t}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:t,_nullCount:0})}const{nullBitmap:n,offset:i}=this,r=i+t>>3,s=(i+t)%8,o=n[r]>>s&1;return e?0===o&&(n[r]|=1<<s,this._nullCount=this.nullCount+1):1===o&&(n[r]&=~(1<<s),this._nullCount=this.nullCount-1),e}clone(t=this.type,e=this.offset,n=this.length,i=this._nullCount,r=this,s=this.children){return new zo(t,e,n,i,r,s,this.dictionary)}slice(t,e){const{stride:n,typeId:i,children:r}=this,s=+(0===this._nullCount)-1,o=16===i?n:1,a=this._sliceBuffers(t,e,n,i);return this.clone(this.type,this.offset+t,e,s,a,0===r.length||this.valueOffsets?r:this._sliceChildren(r,o*t,o*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===ni.Null)return this.clone(this.type,0,t,0);const{length:e,nullCount:n}=this,i=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);i[e>>3]=(1<<e-(-8&e))-1,n>0&&i.set(function(t,e,n){const i=n.byteLength+7&-8;if(t>0||n.byteLength<i){const r=new Uint8Array(i);return r.set(t%8==0?n.subarray(t>>3):vo(new mo(n,t,e,null,yo)).subarray(0,i)),r}return n}(this.offset,e,this.nullBitmap),0);const r=this.buffers;return r[ii.VALIDITY]=i,this.clone(this.type,0,t,n+(t-e),r)}_sliceBuffers(t,e,n,i){let r;const{buffers:s}=this;return(r=s[ii.TYPE])&&(s[ii.TYPE]=r.subarray(t,t+e)),(r=s[ii.OFFSET])&&(s[ii.OFFSET]=r.subarray(t,t+e+1))||(r=s[ii.DATA])&&(s[ii.DATA]=6===i?r:r.subarray(n*t,n*(t+e))),s}_sliceChildren(t,e,n){return t.map((t=>t.slice(e,n)))}}zo.prototype.children=Object.freeze([]);class Ro extends qr{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{type:e,offset:n=0,length:i=0}=t;return new zo(e,n,i,0)}visitBool(t){const{type:e,offset:n=0}=t,i=Gi(t.nullBitmap),r=$i(e.ArrayType,t.data),{length:s=r.length>>3,nullCount:o=(t.nullBitmap?-1:0)}=t;return new zo(e,n,s,o,[void 0,r,i])}visitInt(t){const{type:e,offset:n=0}=t,i=Gi(t.nullBitmap),r=$i(e.ArrayType,t.data),{length:s=r.length,nullCount:o=(t.nullBitmap?-1:0)}=t;return new zo(e,n,s,o,[void 0,r,i])}visitFloat(t){const{type:e,offset:n=0}=t,i=Gi(t.nullBitmap),r=$i(e.ArrayType,t.data),{length:s=r.length,nullCount:o=(t.nullBitmap?-1:0)}=t;return new zo(e,n,s,o,[void 0,r,i])}visitUtf8(t){const{type:e,offset:n=0}=t,i=Gi(t.data),r=Gi(t.nullBitmap),s=Yi(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new zo(e,n,o,a,[s,i,r])}visitBinary(t){const{type:e,offset:n=0}=t,i=Gi(t.data),r=Gi(t.nullBitmap),s=Yi(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new zo(e,n,o,a,[s,i,r])}visitFixedSizeBinary(t){const{type:e,offset:n=0}=t,i=Gi(t.nullBitmap),r=$i(e.ArrayType,t.data),{length:s=r.length/Wr(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new zo(e,n,s,o,[void 0,r,i])}visitDate(t){const{type:e,offset:n=0}=t,i=Gi(t.nullBitmap),r=$i(e.ArrayType,t.data),{length:s=r.length/Wr(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new zo(e,n,s,o,[void 0,r,i])}visitTimestamp(t){const{type:e,offset:n=0}=t,i=Gi(t.nullBitmap),r=$i(e.ArrayType,t.data),{length:s=r.length/Wr(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new zo(e,n,s,o,[void 0,r,i])}visitTime(t){const{type:e,offset:n=0}=t,i=Gi(t.nullBitmap),r=$i(e.ArrayType,t.data),{length:s=r.length/Wr(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new zo(e,n,s,o,[void 0,r,i])}visitDecimal(t){const{type:e,offset:n=0}=t,i=Gi(t.nullBitmap),r=$i(e.ArrayType,t.data),{length:s=r.length/Wr(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new zo(e,n,s,o,[void 0,r,i])}visitList(t){const{type:e,offset:n=0,child:i}=t,r=Gi(t.nullBitmap),s=Yi(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new zo(e,n,o,a,[s,void 0,r],[i])}visitStruct(t){const{type:e,offset:n=0,children:i=[]}=t,r=Gi(t.nullBitmap),{length:s=i.reduce(((t,{length:e})=>Math.max(t,e)),0),nullCount:o=(t.nullBitmap?-1:0)}=t;return new zo(e,n,s,o,[void 0,void 0,r],i)}visitUnion(t){const{type:e,offset:n=0,children:i=[]}=t,r=Gi(t.nullBitmap),s=$i(e.ArrayType,t.typeIds),{length:o=s.length,nullCount:a=(t.nullBitmap?-1:0)}=t;if(Ir.isSparseUnion(e))return new zo(e,n,o,a,[void 0,void 0,r,s],i);const u=Yi(t.valueOffsets);return new zo(e,n,o,a,[u,void 0,r,s],i)}visitDictionary(t){const{type:e,offset:n=0}=t,i=Gi(t.nullBitmap),r=$i(e.indices.ArrayType,t.data),{dictionary:s=new ko([(new Ro).visit({type:e.dictionary})])}=t,{length:o=r.length,nullCount:a=(t.nullBitmap?-1:0)}=t;return new zo(e,n,o,a,[void 0,r,i],[],s)}visitInterval(t){const{type:e,offset:n=0}=t,i=Gi(t.nullBitmap),r=$i(e.ArrayType,t.data),{length:s=r.length/Wr(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new zo(e,n,s,o,[void 0,r,i])}visitFixedSizeList(t){const{type:e,offset:n=0,child:i=(new Ro).visit({type:e.valueType})}=t,r=Gi(t.nullBitmap),{length:s=i.length/Wr(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new zo(e,n,s,o,[void 0,void 0,r],[i])}visitMap(t){const{type:e,offset:n=0,child:i=(new Ro).visit({type:e.childType})}=t,r=Gi(t.nullBitmap),s=Yi(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new zo(e,n,o,a,[s,void 0,r],[i])}}function jo(t){return(new Ro).visit(t)}class Vo{constructor(t=[],e,n){this.fields=t||[],this.metadata=e||new Map,n||(n=Go(t)),this.dictionaries=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map((t=>t.name))}toString(){return`Schema<{ ${this.fields.map(((t,e)=>`${e}: ${t}`)).join(", ")} }>`}select(t){const e=new Set(t),n=this.fields.filter((t=>e.has(t.name)));return new Vo(n,this.metadata)}selectAt(t){const e=t.map((t=>this.fields[t])).filter(Boolean);return new Vo(e,this.metadata)}assign(...t){const e=t[0]instanceof Vo?t[0]:Array.isArray(t[0])?new Vo(t[0]):new Vo(t),n=[...this.fields],i=Yo(Yo(new Map,this.metadata),e.metadata),r=e.fields.filter((t=>{const e=n.findIndex((e=>e.name===t.name));return!~e||(n[e]=t.clone({metadata:Yo(Yo(new Map,n[e].metadata),t.metadata)}))&&!1})),s=Go(r,new Map);return new Vo([...n,...r],i,new Map([...this.dictionaries,...s]))}}Vo.prototype.fields=null,Vo.prototype.metadata=null,Vo.prototype.dictionaries=null;class $o{constructor(t,e,n=!1,i){this.name=t,this.type=e,this.nullable=n,this.metadata=i||new Map}static new(...t){let[e,n,i,r]=t;return t[0]&&"object"==typeof t[0]&&(({name:e}=t[0]),void 0===n&&(n=t[0].type),void 0===i&&(i=t[0].nullable),void 0===r&&(r=t[0].metadata)),new $o(`${e}`,n,i,r)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,n,i,r]=t;return t[0]&&"object"==typeof t[0]?({name:e=this.name,type:n=this.type,nullable:i=this.nullable,metadata:r=this.metadata}=t[0]):[e=this.name,n=this.type,i=this.nullable,r=this.metadata]=t,$o.new(e,n,i,r)}}function Yo(t,e){return new Map([...t||new Map,...e||new Map])}function Go(t,e=new Map){for(let n=-1,i=t.length;++n<i;){const i=t[n].type;if(Ir.isDictionary(i))if(e.has(i.id)){if(e.get(i.id)!==i.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else e.set(i.id,i.dictionary);i.children&&i.children.length>0&&Go(i.children,e)}return e}$o.prototype.type=null,$o.prototype.name=null,$o.prototype.nullable=null,$o.prototype.metadata=null;class Wo extends qr{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every(((t,n)=>this.compareFields(t,e[n])))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}}function qo(t,e){return e instanceof t.constructor}function Zo(t,e){return t===e||qo(t,e)}function Ho(t,e){return t===e||qo(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function Xo(t,e){return t===e||qo(t,e)&&t.precision===e.precision}function Ko(t,e){return t===e||qo(t,e)&&t.unit===e.unit}function Jo(t,e){return t===e||qo(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function Qo(t,e){return t===e||qo(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function ta(t,e){return t===e||qo(t,e)&&t.mode===e.mode&&t.typeIds.every(((t,n)=>t===e.typeIds[n]))&&na.compareManyFields(t.children,e.children)}function ea(t,e){return t===e||qo(t,e)&&t.unit===e.unit}Wo.prototype.visitNull=Zo,Wo.prototype.visitBool=Zo,Wo.prototype.visitInt=Ho,Wo.prototype.visitInt8=Ho,Wo.prototype.visitInt16=Ho,Wo.prototype.visitInt32=Ho,Wo.prototype.visitInt64=Ho,Wo.prototype.visitUint8=Ho,Wo.prototype.visitUint16=Ho,Wo.prototype.visitUint32=Ho,Wo.prototype.visitUint64=Ho,Wo.prototype.visitFloat=Xo,Wo.prototype.visitFloat16=Xo,Wo.prototype.visitFloat32=Xo,Wo.prototype.visitFloat64=Xo,Wo.prototype.visitUtf8=Zo,Wo.prototype.visitBinary=Zo,Wo.prototype.visitFixedSizeBinary=function(t,e){return t===e||qo(t,e)&&t.byteWidth===e.byteWidth},Wo.prototype.visitDate=Ko,Wo.prototype.visitDateDay=Ko,Wo.prototype.visitDateMillisecond=Ko,Wo.prototype.visitTimestamp=Jo,Wo.prototype.visitTimestampSecond=Jo,Wo.prototype.visitTimestampMillisecond=Jo,Wo.prototype.visitTimestampMicrosecond=Jo,Wo.prototype.visitTimestampNanosecond=Jo,Wo.prototype.visitTime=Qo,Wo.prototype.visitTimeSecond=Qo,Wo.prototype.visitTimeMillisecond=Qo,Wo.prototype.visitTimeMicrosecond=Qo,Wo.prototype.visitTimeNanosecond=Qo,Wo.prototype.visitDecimal=Zo,Wo.prototype.visitList=function(t,e){return t===e||qo(t,e)&&t.children.length===e.children.length&&na.compareManyFields(t.children,e.children)},Wo.prototype.visitStruct=function(t,e){return t===e||qo(t,e)&&t.children.length===e.children.length&&na.compareManyFields(t.children,e.children)},Wo.prototype.visitUnion=ta,Wo.prototype.visitDenseUnion=ta,Wo.prototype.visitSparseUnion=ta,Wo.prototype.visitDictionary=function(t,e){return t===e||qo(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&na.visit(t.indices,e.indices)&&na.visit(t.dictionary,e.dictionary)},Wo.prototype.visitInterval=ea,Wo.prototype.visitIntervalDayTime=ea,Wo.prototype.visitIntervalYearMonth=ea,Wo.prototype.visitFixedSizeList=function(t,e){return t===e||qo(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&na.compareManyFields(t.children,e.children)},Wo.prototype.visitMap=function(t,e){return t===e||qo(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&na.compareManyFields(t.children,e.children)};const na=new Wo;function ia(t,e){return na.compareSchemas(t,e)}var ra,sa;class oa{constructor(...t){switch(t.length){case 2:if([this.schema]=t,!(this.schema instanceof Vo))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=jo({nullCount:0,type:new Pr(this.schema.fields),children:this.schema.fields.map((t=>jo({type:t.type,nullCount:0})))})]=t,!(this.data instanceof zo))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=aa(this.schema,this.data.children);break;case 1:{const[e]=t,{fields:n,children:i,length:r}=Object.keys(e).reduce(((t,n,i)=>(t.children[i]=e[n],t.length=Math.max(t.length,e[n].length),t.fields[i]=$o.new({name:n,type:e[n].type,nullable:!0}),t)),{length:0,fields:new Array,children:new Array}),s=new Vo(n),o=jo({type:new Pr(n),length:r,children:i,nullCount:0});[this.schema,this.data]=aa(s,o.children,r);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=ua(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return qs.visit(this.data,t)}set(t,e){return _s.visit(this.data,t,e)}indexOf(t,e){return Io.visit(this.data,t,e)}getByteLength(t){return Lo.visit(this.data,t)}[Symbol.iterator](){return Bo.visit(new ko([this.data]))}toArray(){return[...this]}concat(...t){return new da(this.schema,[this,...t])}slice(t,e){const[n]=new ko([this.data]).slice(t,e).data;return new oa(this.schema,n)}getChild(t){var e;return this.getChildAt(null===(e=this.schema.fields)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new ko([this.data.children[t]]):null}setChild(t,e){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let n=this.schema,i=this.data;if(t>-1&&t<this.numCols){e||(e=new ko([jo({type:new Ar,length:this.numRows})]));const r=n.fields.slice(),s=i.children.slice(),o=r[t].clone({type:e.type});[r[t],s[t]]=[o,e.data[0]],n=new Vo(r,new Map(this.schema.metadata)),i=jo({type:new Pr(r),children:s})}return new oa(n,i)}select(t){const e=this.schema.select(t),n=new Pr(e.fields),i=[];for(const e of t){const t=this.schema.fields.findIndex((t=>t.name===e));~t&&(i[t]=this.data.children[t])}return new oa(e,jo({type:n,length:this.numRows,children:i}))}selectAt(t){const e=this.schema.selectAt(t),n=t.map((t=>this.data.children[t])).filter(Boolean),i=jo({type:new Pr(e.fields),length:this.numRows,children:n});return new oa(e,i)}}function aa(t,e,n=e.reduce(((t,e)=>Math.max(t,e.length)),0)){var i;const r=[...t.fields],s=[...e],o=(n+63&-64)>>3;for(const[a,u]of t.fields.entries()){const t=e[a];t&&t.length===n||(r[a]=u.clone({nullable:!0}),s[a]=null!==(i=null==t?void 0:t._changeLengthAndBackfillNullBitmap(n))&&void 0!==i?i:jo({type:u.type,length:n,nullCount:n,nullBitmap:new Uint8Array(o)}))}return[t.assign(r),jo({type:new Pr(r),length:n,children:s})]}function ua(t,e,n=new Map){for(let i=-1,r=t.length;++i<r;){const r=t[i].type,s=e[i];if(Ir.isDictionary(r))if(n.has(r.id)){if(n.get(r.id)!==s.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else s.dictionary&&n.set(r.id,s.dictionary);r.children&&r.children.length>0&&ua(r.children,s.children,n)}return n}ra=Symbol.toStringTag,oa[ra]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(oa.prototype);class ca extends oa{constructor(t){const e=t.fields.map((t=>jo({type:t.type})));super(t,jo({type:new Pr(t.fields),nullCount:0,children:e}))}}function la(t,e){return function(t,e){const n=[...t.fields],i=[],r={numBatches:e.reduce(((t,e)=>Math.max(t,e.length)),0)};let s=0,o=0,a=-1;const u=e.length;let c,l=[];for(;r.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,a=-1;++a<u;)l[a]=c=e[a].shift(),o=Math.min(o,c?c.length:o);Number.isFinite(o)&&(l=ha(n,o,l,e,r),o>0&&(i[s++]=jo({type:new Pr(n),length:o,nullCount:0,children:l.slice()})))}return[t=t.assign(n),i.map((e=>new oa(t,e)))]}(t,e.map((t=>t.data.concat())))}function ha(t,e,n,i,r){var s;const o=(e+63&-64)>>3;for(let a=-1,u=i.length;++a<u;){const u=n[a],c=null==u?void 0:u.length;if(c>=e)c===e?n[a]=u:(n[a]=u.slice(0,e),r.numBatches=Math.max(r.numBatches,i[a].unshift(u.slice(e,c-e))));else{const i=t[a];t[a]=i.clone({nullable:!0}),n[a]=null!==(s=null==u?void 0:u._changeLengthAndBackfillNullBitmap(e))&&void 0!==s?s:jo({type:i.type,length:e,nullCount:e,nullBitmap:new Uint8Array(o)})}}return n}class da{constructor(...t){var e,n;if(0===t.length)return this.batches=[],this.schema=new Vo([]),this._offsets=[0],this;let i,r;t[0]instanceof Vo&&(i=t.shift()),t[t.length-1]instanceof Uint32Array&&(r=t.pop());const s=t=>{if(t){if(t instanceof oa)return[t];if(t instanceof da)return t.batches;if(t instanceof zo){if(t.type instanceof Pr)return[new oa(new Vo(t.type.children),t)]}else{if(Array.isArray(t))return t.flatMap((t=>s(t)));if("function"==typeof t[Symbol.iterator])return[...t].flatMap((t=>s(t)));if("object"==typeof t){const e=Object.keys(t),n=e.map((e=>new ko([t[e]]))),i=new Vo(e.map(((t,e)=>new $o(String(t),n[e].type)))),[,r]=la(i,n);return 0===r.length?[new oa(t)]:r}}}return[]},o=t.flatMap((t=>s(t)));if(i=null!==(n=null!=i?i:null===(e=o[0])||void 0===e?void 0:e.schema)&&void 0!==n?n:new Vo([]),!(i instanceof Vo))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const t of o){if(!(t instanceof oa))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!ia(i,t.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=i,this.batches=o,this._offsets=null!=r?r:ao(this.data)}get data(){return this.batches.map((({data:t})=>t))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce(((t,e)=>t+e.length),0)}get nullCount(){return-1===this._nullCount&&(this._nullCount=oo(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return this.batches.length>0?Bo.visit(new ko(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(...t){const e=this.schema,n=this.data.concat(t.flatMap((({data:t})=>t)));return new da(e,n.map((t=>new oa(e,t))))}slice(t,e){const n=this.schema;[t,e]=to({length:this.numRows},t,e);const i=uo(this.data,this._offsets,t,e);return new da(n,i.map((t=>new oa(n,t))))}getChild(t){return this.getChildAt(this.schema.fields.findIndex((e=>e.name===t)))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const e=this.data.map((e=>e.children[t]));if(0===e.length){const{type:n}=this.schema.fields[t],i=jo({type:n,length:0,nullCount:0});e.push(i._changeLengthAndBackfillNullBitmap(this.numRows))}return new ko(e)}return null}setChild(t,e){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let n=this.schema,i=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new ko([jo({type:new Ar,length:this.numRows})]));const r=n.fields.slice(),s=r[t].clone({type:e.type}),o=this.schema.fields.map(((t,e)=>this.getChildAt(e)));[r[t],o[t]]=[s,e],[n,i]=la(n,o)}return new da(n,i)}select(t){const e=this.schema.fields.reduce(((t,e,n)=>t.set(e.name,n)),new Map);return this.selectAt(t.map((t=>e.get(t))).filter((t=>t>-1)))}selectAt(t){const e=this.schema.selectAt(t),n=this.batches.map((e=>e.selectAt(t)));return new da(e,n)}assign(t){const e=this.schema.fields,[n,i]=t.schema.fields.reduce(((t,n,i)=>{const[r,s]=t,o=e.findIndex((t=>t.name===n.name));return~o?s[o]=i:r.push(i),t}),[[],[]]),r=this.schema.assign(t.schema),s=[...e.map(((t,e)=>[e,i[e]])).map((([e,n])=>void 0===n?this.getChildAt(e):t.getChildAt(n))),...n.map((e=>t.getChildAt(e)))].filter(Boolean);return new da(...la(r,s))}}sa=Symbol.toStringTag,da[sa]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=ho(lo),t.get=ho(qs.getVisitFn(ni.Struct)),t.set=fo(_s.getVisitFn(ni.Struct)),t.indexOf=po(Io.getVisitFn(ni.Struct)),t.getByteLength=ho(Lo.getVisitFn(ni.Struct)),"Table"))(da.prototype);class fa{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,n,i){return t.prep(8,24),t.writeInt64(i),t.pad(4),t.writeInt32(n),t.writeInt64(e),t.offset()}}const pa=new Int32Array(2),ya=new Float32Array(pa.buffer),ba=new Float64Array(pa.buffer),va=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];class ma{constructor(t,e){this.low=0|t,this.high=0|e}static create(t,e){return 0==t&&0==e?ma.ZERO:new ma(t,e)}toFloat64(){return(this.low>>>0)+4294967296*this.high}equals(t){return this.low==t.low&&this.high==t.high}}var ga,_a,wa,Sa,xa;ma.ZERO=new ma(0,0),function(t){t[t.UTF8_BYTES=1]="UTF8_BYTES",t[t.UTF16_STRING=2]="UTF16_STRING"}(ga||(ga={}));class Ia{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new Ia(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new ma(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new ma(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return pa[0]=this.readInt32(t),ya[0]}readFloat64(t){return pa[va?0:1]=this.readInt32(t),pa[va?1:0]=this.readInt32(t+4),ba[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){ya[0]=e,this.writeInt32(t,pa[0])}writeFloat64(t,e){ba[0]=e,this.writeInt32(t,pa[va?0:1]),this.writeInt32(t+4,pa[va?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);let i="",r=0;if(t+=4,e===ga.UTF8_BYTES)return this.bytes_.subarray(t,t+n);for(;r<n;){let e;const n=this.readUint8(t+r++);if(n<192)e=n;else{const i=this.readUint8(t+r++);if(n<224)e=(31&n)<<6|63&i;else{const s=this.readUint8(t+r++);e=n<240?(15&n)<<12|(63&i)<<6|63&s:(7&n)<<18|(63&i)<<12|(63&s)<<6|63&this.readUint8(t+r++)}}e<65536?i+=String.fromCharCode(e):(e-=65536,i+=String.fromCharCode(55296+(e>>10),56320+(1023&e)))}return i}__union_with_string(t,e){return"string"==typeof t?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createLong(t,e){return ma.create(t,e)}createScalarList(t,e){const n=[];for(let i=0;i<e;++i)null!==t(i)&&n.push(t(i));return n}createObjList(t,e){const n=[];for(let i=0;i<e;++i){const e=t(i);null!==e&&n.push(e.unpack())}return n}}class Aa{constructor(t){let e;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,e=t||1024,this.bb=Ia.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const n=1+~(this.bb.capacity()-this.space+e)&t-1;for(;this.space<n+t+e;){const t=this.bb.capacity();this.bb=Aa.growByteBuffer(this.bb),this.space+=this.bb.capacity()-t}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){!this.force_defaults&&e.equals(n)||(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){null!==this.vtable&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(3221225472&e)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=e<<1,i=Ia.allocate(n);return i.setPosition(n-e),i.bytes().set(t.bytes(),n-e),i}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&0==this.vtable[e];e--);const n=e+1;for(;e>=0;e--)this.addInt16(0!=this.vtable[e]?t-this.vtable[e]:0);this.addInt16(t-this.object_start);const i=2*(n+2);this.addInt16(i);let r=0;const s=this.space;t:for(e=0;e<this.vtables.length;e++){const t=this.bb.capacity()-this.vtables[e];if(i==this.bb.readInt16(t)){for(let e=2;e<i;e+=2)if(this.bb.readInt16(s+e)!=this.bb.readInt16(t+e))continue t;r=this.vtables[e];break}}return r?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,r-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){const i=n?4:0;if(e){const t=e;if(this.prep(this.minalign,8+i),4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=3;e>=0;e--)this.writeInt8(t.charCodeAt(e))}this.prep(this.minalign,4+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const n=this.bb.capacity()-t,i=n-this.bb.readInt32(n);if(0==this.bb.readInt16(i+e))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let n=0;for(;n<t.length;){let i;const r=t.charCodeAt(n++);i=r<55296||r>=56320?r:(r<<10)+t.charCodeAt(n++)+-56613888,i<128?e.push(i):(i<2048?e.push(i>>6&31|192):(i<65536?e.push(i>>12&15|224):e.push(i>>18&7|240,i>>12&63|128),e.push(i>>6&63|128)),e.push(63&i|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let t=0,n=this.space,i=this.bb.bytes();t<e.length;t++)i[n++]=e[t];return this.endVector()}createLong(t,e){return ma.create(t,e)}createObjectOffset(t){return null===t?0:"string"==typeof t?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];if(null===i)throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.");e.push(this.createObjectOffset(i))}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}}class Ta{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new Ta).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,e){return t.setPosition(t.position()+4),(e||new Ta).__init(t.readInt32(t.position())+t.position(),t)}key(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,n){return Ta.startKeyValue(t),Ta.addKey(t,e),Ta.addValue(t,n),Ta.endKeyValue(t)}}!function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(_a||(_a={})),function(t){t[t.Little=0]="Little",t[t.Big=1]="Big"}(wa||(wa={})),function(t){t[t.DenseArray=0]="DenseArray"}(Sa||(Sa={}));class Ma{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new Ma).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,e){return t.setPosition(t.position()+4),(e||new Ma).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,n){return Ma.startInt(t),Ma.addBitWidth(t,e),Ma.addIsSigned(t,n),Ma.endInt(t)}}class Ba{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new Ba).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,e){return t.setPosition(t.position()+4),(e||new Ba).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Ma).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):Sa.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,Sa.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}!function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.FloatingPoint=3]="FloatingPoint",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct_=13]="Struct_",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.LargeList=21]="LargeList"}(xa||(xa={}));class Oa{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(t,e){return(e||new Oa).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,e){return t.setPosition(t.position()+4),(e||new Oa).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):xa.NONE}type(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){const e=this.bb.__offset(this.bb_pos,12);return e?(t||new Ba).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(t,e){const n=this.bb.__offset(this.bb_pos,14);return n?(e||new Oa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,16);return n?(e||new Ta).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,xa.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}}class Da{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(t,e){return(e||new Da).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,e){return t.setPosition(t.position()+4),(e||new Da).__init(t.readInt32(t.position())+t.position(),t)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):wa.Little}fields(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new Oa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new Ta).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*t):this.bb.createLong(0,0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,wa.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(t,e,n,i,r){return Da.startSchema(t),Da.addEndianness(t,e),Da.addFields(t,n),Da.addCustomMetadata(t,i),Da.addFeatures(t,r),Da.endSchema(t)}}class Na{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new Na).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,e){return t.setPosition(t.position()+4),(e||new Na).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):_a.V1}schema(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Da).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new fa).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){const n=this.bb.__offset(this.bb_pos,10);return n?(e||new fa).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new Ta).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,_a.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}}var Fa=ma,La=Aa,Ea=Ia;class Ua{constructor(t,e=Hn.V4,n,i){this.schema=t,this.version=e,n&&(this._recordBatches=n),i&&(this._dictionaryBatches=i)}static decode(t){t=new Ea(Gi(t));const e=Na.getRootAsFooter(t),n=Vo.decode(e.schema());return new Ca(n,e)}static encode(t){const e=new La,n=Vo.encode(e,t.schema);Na.startRecordBatchesVector(e,t.numRecordBatches);for(const n of[...t.recordBatches()].slice().reverse())ka.encode(e,n);const i=e.endVector();Na.startDictionariesVector(e,t.numDictionaries);for(const n of[...t.dictionaryBatches()].slice().reverse())ka.encode(e,n);const r=e.endVector();return Na.startFooter(e),Na.addSchema(e,n),Na.addVersion(e,Hn.V4),Na.addRecordBatches(e,i),Na.addDictionaries(e,r),Na.finishFooterBuffer(e,Na.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,e=-1,n=this.numRecordBatches;++e<n;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,n=this.numDictionaries;++e<n;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class Ca extends Ua{constructor(t,e){super(t,e.version()),this._footer=e}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const e=this._footer.recordBatches(t);if(e)return ka.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const e=this._footer.dictionaries(t);if(e)return ka.decode(e)}return null}}class ka{constructor(t,e,n){this.metaDataLength=t,this.offset="number"==typeof n?n:n.low,this.bodyLength="number"==typeof e?e:e.low}static decode(t){return new ka(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){const{metaDataLength:n}=e,i=new Fa(e.offset,0),r=new Fa(e.bodyLength,0);return fa.createBlock(t,i,n,r)}}const Pa={fromIterable:t=>za(function*(t){let e,n,i,r,s=!1,o=[],a=0;({cmd:i,size:r}=yield null);const u=(c=t,function*(t,e){const n=function*(t){yield t},i="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof Ri?n(e):Di(e)?e:n(e);return yield*Wi(function*(e){let n=null;do{n=e.next(yield $i(t,n))}while(!n.done)}(i[Symbol.iterator]())),new t}(Uint8Array,c))[Symbol.iterator]();var c;try{do{if(({done:e,value:n}=Number.isNaN(r-a)?u.next():u.next(r-a)),!e&&n.byteLength>0&&(o.push(n),a+=n.byteLength),e||r<=a)do{({cmd:i,size:r}=yield"peek"===i?Vi(o,r)[0]:([n,o,a]=Vi(o,r),n))}while(r<a)}while(!e)}catch(t){(s=!0)&&"function"==typeof u.throw&&u.throw(t)}finally{!1===s&&"function"==typeof u.return&&u.return(null)}return null}(t)),fromAsyncIterable:t=>za(function(t){return pi(this,arguments,(function*(){let e,n,i,r,s=!1,o=[],a=0;({cmd:i,size:r}=yield yield fi(null));const u=(c=t,qi(Uint8Array,c))[Symbol.asyncIterator]();var c;try{do{if(({done:e,value:n}=Number.isNaN(r-a)?yield fi(u.next()):yield fi(u.next(r-a))),!e&&n.byteLength>0&&(o.push(n),a+=n.byteLength),e||r<=a)do{({cmd:i,size:r}=yield yield fi("peek"===i?Vi(o,r)[0]:([n,o,a]=Vi(o,r),n)))}while(r<a)}while(!e)}catch(t){(s=!0)&&"function"==typeof u.throw&&(yield fi(u.throw(t)))}finally{!1===s&&"function"==typeof u.return&&(yield fi(u.return(new Uint8Array(0))))}return yield fi(null)}))}(t)),fromDOMStream:t=>za(function(t){return pi(this,arguments,(function*(){let e,n,i,r=!1,s=!1,o=[],a=0;({cmd:n,size:i}=yield yield fi(null));const u=new Ra(t);try{do{if(({done:r,value:e}=Number.isNaN(i-a)?yield fi(u.read()):yield fi(u.read(i-a))),!r&&e.byteLength>0&&(o.push(Gi(e)),a+=e.byteLength),r||i<=a)do{({cmd:n,size:i}=yield yield fi("peek"===n?Vi(o,i)[0]:([e,o,a]=Vi(o,i),e)))}while(i<a)}while(!r)}catch(t){(s=!0)&&(yield fi(u.cancel(t)))}finally{!1===s?yield fi(u.cancel()):t.locked&&u.releaseLock()}return yield fi(null)}))}(t)),fromNodeStream:t=>za(function(t){return pi(this,arguments,(function*(){const e=[];let n,i,r,s="error",o=!1,a=null,u=0,c=[];if(({cmd:n,size:i}=yield yield fi(null)),t.isTTY)return yield yield fi(new Uint8Array(0)),yield fi(null);try{e[0]=ja(t,"end"),e[1]=ja(t,"error");do{if(e[2]=ja(t,"readable"),[s,a]=yield fi(Promise.race(e.map((t=>t[2])))),"error"===s)break;if((o="end"===s)||(Number.isFinite(i-u)?(r=Gi(t.read(i-u)),r.byteLength<i-u&&(r=Gi(t.read()))):r=Gi(t.read()),r.byteLength>0&&(c.push(r),u+=r.byteLength)),o||i<=u)do{({cmd:n,size:i}=yield yield fi("peek"===n?Vi(c,i)[0]:([r,c,u]=Vi(c,i),r)))}while(i<u)}while(!o)}finally{yield fi(function(e,n){return r=c=null,new Promise(((i,r)=>{for(const[n,i]of e)t.off(n,i);try{const e=t.destroy;e&&e.call(t,n),n=void 0}catch(t){n=t||n}finally{null!=n?r(n):i()}}))}(e,"error"===s?a:null))}return yield fi(null)}))}(t)),toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}},za=t=>(t.next(),t);class Ra{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch((()=>{}))}get closed(){return this.reader?this.reader.closed.catch((()=>{})):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return di(this,void 0,void 0,(function*(){const{reader:e,source:n}=this;e&&(yield e.cancel(t).catch((()=>{}))),n&&n.locked&&this.releaseLock()}))}read(t){return di(this,void 0,void 0,(function*(){if(0===t)return{done:null==this.reader,value:new Uint8Array(0)};const e=yield this.reader.read();return!e.done&&(e.value=Gi(e)),e}))}}const ja=(t,e)=>{const n=t=>i([e,t]);let i;return[e,n,new Promise((r=>(i=r)&&t.once(e,n)))]},Va=Object.freeze({done:!0,value:void 0});class $a{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class Ya{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class Ga extends Ya{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}get closed(){return this._closedPromise}cancel(t){return di(this,void 0,void 0,(function*(){yield this.return(t)}))}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(Va);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return Pa.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return Pa.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return di(this,void 0,void 0,(function*(){return yield this.abort(t),Va}))}return(t){return di(this,void 0,void 0,(function*(){return yield this.close(),Va}))}read(t){return di(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return di(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise(((t,e)=>{this.resolvers.push({resolve:t,reject:e})})):Promise.resolve(Va)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class Wa extends Ga{write(t){if((t=Gi(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?mi(this.toUint8Array(!0)):this.toUint8Array(!1).then(mi)}toUint8Array(t=!1){return t?Vi(this._values)[0]:(()=>di(this,void 0,void 0,(function*(){var t,e;const n=[];let i=0;try{for(var r,s=bi(this);!(r=yield s.next()).done;){const t=r.value;n.push(t),i+=t.byteLength}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=s.return)&&(yield e.call(s))}finally{if(t)throw t.error}}return Vi(n,i)[0]})))()}}class qa{constructor(t){t&&(this.source=new Ha(Pa.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class Za{constructor(t){t instanceof Za?this.source=t.source:t instanceof Wa?this.source=new Xa(Pa.fromAsyncIterable(t)):Pi(t)?this.source=new Xa(Pa.fromNodeStream(t)):ki(t)?this.source=new Xa(Pa.fromDOMStream(t)):Ui(t)?this.source=new Xa(Pa.fromDOMStream(t.body)):Di(t)?this.source=new Xa(Pa.fromIterable(t)):(Oi(t)||Ni(t))&&(this.source=new Xa(Pa.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class Ha{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,e="read"){return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||Va)}return(t){return Object.create(this.source.return&&this.source.return(t)||Va)}}class Xa{constructor(t){this.source=t,this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}cancel(t){return di(this,void 0,void 0,(function*(){yield this.return(t)}))}get closed(){return this._closedPromise}read(t){return di(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return di(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(t,e="read"){return di(this,void 0,void 0,(function*(){return yield this.source.next({cmd:e,size:t})}))}throw(t){return di(this,void 0,void 0,(function*(){const e=this.source.throw&&(yield this.source.throw(t))||Va;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}return(t){return di(this,void 0,void 0,(function*(){const e=this.source.return&&(yield this.source.return(t))||Va;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}}class Ka extends qa{constructor(t,e){super(),this.position=0,this.buffer=Gi(t),this.size=void 0===e?this.buffer.byteLength:e}readInt32(t){const{buffer:e,byteOffset:n}=this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:e,size:n,position:i}=this;return e&&i<n?("number"!=typeof t&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(n,i+Math.min(n-i,t)),e.subarray(i,this.position)):null}readAt(t,e){const n=this.buffer,i=Math.min(this.size,t+e);return n?n.subarray(t,i):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class Ja extends Za{constructor(t,e){super(),this.position=0,this._handle=t,"number"==typeof e?this.size=e:this._pending=(()=>di(this,void 0,void 0,(function*(){this.size=(yield t.stat()).size,delete this._pending})))()}readInt32(t){return di(this,void 0,void 0,(function*(){const{buffer:e,byteOffset:n}=yield this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}))}seek(t){return di(this,void 0,void 0,(function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size}))}read(t){return di(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:e,size:n,position:i}=this;if(e&&i<n){"number"!=typeof t&&(t=Number.POSITIVE_INFINITY);let r=i,s=0,o=0;const a=Math.min(n,r+Math.min(n-r,t)),u=new Uint8Array(Math.max(0,(this.position=a)-r));for(;(r+=o)<a&&(s+=o)<u.byteLength;)({bytesRead:o}=yield e.read(u,s,u.byteLength-s,r));return u}return null}))}readAt(t,e){return di(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:n,size:i}=this;if(n&&t+e<i){const r=Math.min(i,t+e),s=new Uint8Array(r-t);return(yield n.read(s,0,e,t)).buffer}return new Uint8Array(e)}))}close(){return di(this,void 0,void 0,(function*(){const t=this._handle;this._handle=null,t&&(yield t.close())}))}throw(t){return di(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}return(t){return di(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}}function Qa(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}const tu=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class eu{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const e=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),n=new Uint32Array([t.buffer[1]>>>16,65535&t.buffer[1],t.buffer[0]>>>16,65535&t.buffer[0]]);let i=e[3]*n[3];this.buffer[0]=65535&i;let r=i>>>16;return i=e[2]*n[3],r+=i,i=e[3]*n[2]>>>0,r+=i,this.buffer[0]+=r<<16,this.buffer[1]=r>>>0<i?65536:0,this.buffer[1]+=r>>>16,this.buffer[1]+=e[1]*n[3]+e[2]*n[2]+e[3]*n[1],this.buffer[1]+=e[0]*n[3]+e[1]*n[2]+e[2]*n[1]+e[3]*n[0]<<16,this}_plus(t){const e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${Qa(this.buffer[1])} ${Qa(this.buffer[0])}`}}class nu extends eu{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,e=new Uint32Array(2)){return nu.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return nu.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.length,i=new nu(e);for(let e=0;e<n;){const r=8<n-e?8:n-e,s=new nu(new Uint32Array([Number.parseInt(t.slice(e,e+r),10),0])),o=new nu(new Uint32Array([tu[r],0]));i.times(o),i.plus(s),e+=r}return i}static convertArray(t){const e=new Uint32Array(2*t.length);for(let n=-1,i=t.length;++n<i;)nu.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new nu(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new nu(new Uint32Array(t.buffer)).plus(e)}}class iu extends eu{negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const e=this.buffer[1]<<0,n=t.buffer[1]<<0;return e<n||e===n&&this.buffer[0]<t.buffer[0]}static from(t,e=new Uint32Array(2)){return iu.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return iu.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.startsWith("-"),i=t.length,r=new iu(e);for(let e=n?1:0;e<i;){const n=8<i-e?8:i-e,s=new iu(new Uint32Array([Number.parseInt(t.slice(e,e+n),10),0])),o=new iu(new Uint32Array([tu[n],0]));r.times(o),r.plus(s),e+=n}return n?r.negate():r}static convertArray(t){const e=new Uint32Array(2*t.length);for(let n=-1,i=t.length;++n<i;)iu.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new iu(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new iu(new Uint32Array(t.buffer)).plus(e)}}class ru{constructor(t){this.buffer=t}high(){return new iu(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new iu(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(t){const e=new nu(new Uint32Array([this.buffer[3],0])),n=new nu(new Uint32Array([this.buffer[2],0])),i=new nu(new Uint32Array([this.buffer[1],0])),r=new nu(new Uint32Array([this.buffer[0],0])),s=new nu(new Uint32Array([t.buffer[3],0])),o=new nu(new Uint32Array([t.buffer[2],0])),a=new nu(new Uint32Array([t.buffer[1],0])),u=new nu(new Uint32Array([t.buffer[0],0]));let c=nu.multiply(r,u);this.buffer[0]=c.low();const l=new nu(new Uint32Array([c.high(),0]));return c=nu.multiply(i,u),l.plus(c),c=nu.multiply(r,a),l.plus(c),this.buffer[1]=l.low(),this.buffer[3]=l.lessThan(c)?1:0,this.buffer[2]=l.high(),new nu(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(nu.multiply(n,u)).plus(nu.multiply(i,a)).plus(nu.multiply(r,o)),this.buffer[3]+=nu.multiply(e,u).plus(nu.multiply(n,a)).plus(nu.multiply(i,o)).plus(nu.multiply(r,s)).low(),this}plus(t){const e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${Qa(this.buffer[3])} ${Qa(this.buffer[2])} ${Qa(this.buffer[1])} ${Qa(this.buffer[0])}`}static multiply(t,e){return new ru(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new ru(new Uint32Array(t.buffer)).plus(e)}static from(t,e=new Uint32Array(4)){return ru.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(4)){return ru.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(4)){const n=t.startsWith("-"),i=t.length,r=new ru(e);for(let e=n?1:0;e<i;){const n=8<i-e?8:i-e,s=new ru(new Uint32Array([Number.parseInt(t.slice(e,e+n),10),0,0,0])),o=new ru(new Uint32Array([tu[n],0,0,0]));r.times(o),r.plus(s),e+=n}return n?r.negate():r}static convertArray(t){const e=new Uint32Array(4*t.length);for(let n=-1,i=t.length;++n<i;)ru.from(t[n],new Uint32Array(e.buffer,e.byteOffset+16*n,4));return e}}class su extends qr{constructor(t,e,n,i){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=n,this.dictionaries=i}visit(t){return super.visit(t instanceof $o?t.type:t)}visitNull(t,{length:e}=this.nextFieldNode()){return jo({type:t,length:e})}visitBool(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitInt(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFloat(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitUtf8(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDate(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTimestamp(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTime(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDecimal(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitList(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===Xn.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFixedSizeList(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),child:this.visit(t.children[0])})}visitMap(t,{length:e,nullCount:n}=this.nextFieldNode()){return jo({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e,n=this.nextBufferRange()){return e>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t,{length:e,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+e)}readDictionary(t){return this.dictionaries.get(t.id)}}class ou extends su{constructor(t,e,n,i){super(new Uint8Array(0),e,n,i),this.sources=t}readNullBitmap(t,e,{offset:n}=this.nextBufferRange()){return e<=0?new Uint8Array(0):vo(this.sources[n])}readOffsets(t,{offset:e}=this.nextBufferRange()){return $i(Uint8Array,$i(Int32Array,this.sources[e]))}readTypeIds(t,{offset:e}=this.nextBufferRange()){return $i(Uint8Array,$i(t.ArrayType,this.sources[e]))}readData(t,{offset:e}=this.nextBufferRange()){const{sources:n}=this;return Ir.isTimestamp(t)||(Ir.isInt(t)||Ir.isTime(t))&&64===t.bitWidth||Ir.isDate(t)&&t.unit===Jn.MILLISECOND?$i(Uint8Array,iu.convertArray(n[e])):Ir.isDecimal(t)?$i(Uint8Array,ru.convertArray(n[e])):Ir.isBinary(t)||Ir.isFixedSizeBinary(t)?function(t){const e=t.join(""),n=new Uint8Array(e.length/2);for(let t=0;t<e.length;t+=2)n[t>>1]=Number.parseInt(e.slice(t,t+2),16);return n}(n[e]):Ir.isBool(t)?vo(n[e]):Ir.isUtf8(t)?_i(n[e].join("")):$i(Uint8Array,$i(t.ArrayType,n[e].map((t=>+t))))}}var au,uu,cu,lu,hu,du,fu,pu;!function(t){t[t.BUFFER=0]="BUFFER"}(au||(au={})),function(t){t[t.LZ4_FRAME=0]="LZ4_FRAME",t[t.ZSTD=1]="ZSTD"}(uu||(uu={}));class yu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new yu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,e){return t.setPosition(t.position()+4),(e||new yu).__init(t.readInt32(t.position())+t.position(),t)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):uu.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):au.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,uu.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,au.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,n){return yu.startBodyCompression(t),yu.addCodec(t,e),yu.addMethod(t,n),yu.endBodyCompression(t)}}class bu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}}class vu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}}class mu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(t,e){return(e||new mu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,e){return t.setPosition(t.position()+4),(e||new mu).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new vu).__init(this.bb.__vector(this.bb_pos+n)+16*t,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new bu).__init(this.bb.__vector(this.bb_pos+n)+16*t,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const e=this.bb.__offset(this.bb_pos,10);return e?(t||new yu).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}}class gu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(t,e){return(e||new gu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,e){return t.setPosition(t.position()+4),(e||new gu).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new mu).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}}!function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}(cu||(cu={}));class _u{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new _u).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,e){return t.setPosition(t.position()+4),(e||new _u).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):cu.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,cu.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return _u.startFloatingPoint(t),_u.addPrecision(t,e),_u.endFloatingPoint(t)}}class wu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new wu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,e){return t.setPosition(t.position()+4),(e||new wu).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,n,i){return wu.startDecimal(t),wu.addPrecision(t,e),wu.addScale(t,n),wu.addBitWidth(t,i),wu.endDecimal(t)}}!function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"}(lu||(lu={}));class Su{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(t,e){return(e||new Su).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,e){return t.setPosition(t.position()+4),(e||new Su).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):lu.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,lu.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,e){return Su.startDate(t),Su.addUnit(t,e),Su.endDate(t)}}!function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"}(hu||(hu={}));class xu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new xu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,e){return t.setPosition(t.position()+4),(e||new xu).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):hu.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,hu.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,n){return xu.startTime(t),xu.addUnit(t,e),xu.addBitWidth(t,n),xu.endTime(t)}}class Iu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new Iu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,e){return t.setPosition(t.position()+4),(e||new Iu).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):hu.SECOND}timezone(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,hu.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,n){return Iu.startTimestamp(t),Iu.addUnit(t,e),Iu.addTimezone(t,n),Iu.endTimestamp(t)}}!function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(du||(du={}));class Au{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new Au).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,e){return t.setPosition(t.position()+4),(e||new Au).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):du.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,du.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return Au.startInterval(t),Au.addUnit(t,e),Au.endInterval(t)}}!function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"}(fu||(fu={}));class Tu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new Tu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,e){return t.setPosition(t.position()+4),(e||new Tu).__init(t.readInt32(t.position())+t.position(),t)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):fu.Sparse}typeIds(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+4*t):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,fu.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,n){return Tu.startUnion(t),Tu.addMode(t,e),Tu.addTypeIds(t,n),Tu.endUnion(t)}}class Mu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new Mu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,e){return t.setPosition(t.position()+4),(e||new Mu).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return Mu.startFixedSizeBinary(t),Mu.addByteWidth(t,e),Mu.endFixedSizeBinary(t)}}class Bu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new Bu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,e){return t.setPosition(t.position()+4),(e||new Bu).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return Bu.startFixedSizeList(t),Bu.addListSize(t,e),Bu.endFixedSizeList(t)}}class Ou{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(t,e){return(e||new Ou).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,e){return t.setPosition(t.position()+4),(e||new Ou).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(t,e){return Ou.startMap(t),Ou.addKeysSorted(t,e),Ou.endMap(t)}}!function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"}(pu||(pu={}));class Du{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(t,e){return(e||new Du).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,e){return t.setPosition(t.position()+4),(e||new Du).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):_a.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):pu.NONE}header(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new Ta).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,_a.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,pu.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,t.createLong(0,0))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(t,e,n,i,r,s){return Du.startMessage(t),Du.addVersion(t,e),Du.addHeaderType(t,n),Du.addHeader(t,i),Du.addBodyLength(t,r),Du.addCustomMetadata(t,s),Du.endMessage(t)}}class Nu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new Nu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,e){return t.setPosition(t.position()+4),(e||new Nu).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return Nu.startNull(t),Nu.endNull(t)}}class Fu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new Fu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,e){return t.setPosition(t.position()+4),(e||new Fu).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return Fu.startBinary(t),Fu.endBinary(t)}}class Lu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new Lu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,e){return t.setPosition(t.position()+4),(e||new Lu).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return Lu.startBool(t),Lu.endBool(t)}}class Eu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new Eu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,e){return t.setPosition(t.position()+4),(e||new Eu).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return Eu.startUtf8(t),Eu.endUtf8(t)}}class Uu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new Uu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,e){return t.setPosition(t.position()+4),(e||new Uu).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return Uu.startList(t),Uu.endList(t)}}class Cu{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new Cu).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,e){return t.setPosition(t.position()+4),(e||new Cu).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return Cu.startStruct_(t),Cu.endStruct_(t)}}var ku=ma;const Pu=new class extends qr{visit(t,e){return null==t||null==e?void 0:super.visit(t,e)}visitNull(t,e){return Nu.startNull(e),Nu.endNull(e)}visitInt(t,e){return Ma.startInt(e),Ma.addBitWidth(e,t.bitWidth),Ma.addIsSigned(e,t.isSigned),Ma.endInt(e)}visitFloat(t,e){return _u.startFloatingPoint(e),_u.addPrecision(e,t.precision),_u.endFloatingPoint(e)}visitBinary(t,e){return Fu.startBinary(e),Fu.endBinary(e)}visitBool(t,e){return Lu.startBool(e),Lu.endBool(e)}visitUtf8(t,e){return Eu.startUtf8(e),Eu.endUtf8(e)}visitDecimal(t,e){return wu.startDecimal(e),wu.addScale(e,t.scale),wu.addPrecision(e,t.precision),wu.addBitWidth(e,t.bitWidth),wu.endDecimal(e)}visitDate(t,e){return Su.startDate(e),Su.addUnit(e,t.unit),Su.endDate(e)}visitTime(t,e){return xu.startTime(e),xu.addUnit(e,t.unit),xu.addBitWidth(e,t.bitWidth),xu.endTime(e)}visitTimestamp(t,e){const n=t.timezone&&e.createString(t.timezone)||void 0;return Iu.startTimestamp(e),Iu.addUnit(e,t.unit),void 0!==n&&Iu.addTimezone(e,n),Iu.endTimestamp(e)}visitInterval(t,e){return Au.startInterval(e),Au.addUnit(e,t.unit),Au.endInterval(e)}visitList(t,e){return Uu.startList(e),Uu.endList(e)}visitStruct(t,e){return Cu.startStruct_(e),Cu.endStruct_(e)}visitUnion(t,e){Tu.startTypeIdsVector(e,t.typeIds.length);const n=Tu.createTypeIdsVector(e,t.typeIds);return Tu.startUnion(e),Tu.addMode(e,t.mode),Tu.addTypeIds(e,n),Tu.endUnion(e)}visitDictionary(t,e){const n=this.visit(t.indices,e);return Ba.startDictionaryEncoding(e),Ba.addId(e,new ku(t.id,0)),Ba.addIsOrdered(e,t.isOrdered),void 0!==n&&Ba.addIndexType(e,n),Ba.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return Mu.startFixedSizeBinary(e),Mu.addByteWidth(e,t.byteWidth),Mu.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return Bu.startFixedSizeList(e),Bu.addListSize(e,t.listSize),Bu.endFixedSizeList(e)}visitMap(t,e){return Ou.startMap(e),Ou.addKeysSorted(e,t.keysSorted),Ou.endMap(e)}};function zu(t){return new Xu(t.count,ju(t.columns),Vu(t.columns))}function Ru(t,e){return(t.children||[]).filter(Boolean).map((t=>$o.fromJSON(t,e)))}function ju(t){return(t||[]).reduce(((t,e)=>{return[...t,new Qu(e.count,(n=e.VALIDITY,(n||[]).reduce(((t,e)=>t+ +(0===e)),0))),...ju(e.children)];var n}),[])}function Vu(t,e=[]){for(let n=-1,i=(t||[]).length;++n<i;){const i=t[n];i.VALIDITY&&e.push(new Ju(e.length,i.VALIDITY.length)),i.TYPE&&e.push(new Ju(e.length,i.TYPE.length)),i.OFFSET&&e.push(new Ju(e.length,i.OFFSET.length)),i.DATA&&e.push(new Ju(e.length,i.DATA.length)),e=Vu(i.children,e)}return e}function $u(t){return new Map(Object.entries(t||{}))}function Yu(t){return new Tr(t.isSigned,t.bitWidth)}function Gu(t,e){const n=t.type.name;switch(n){case"NONE":case"null":return new Ar;case"binary":return new Or;case"utf8":return new Dr;case"bool":return new Nr;case"list":return new kr((e||[])[0]);case"struct":case"struct_":return new Pr(e||[])}switch(n){case"int":{const e=t.type;return new Tr(e.isSigned,e.bitWidth)}case"floatingpoint":{const e=t.type;return new Br(Kn[e.precision])}case"decimal":{const e=t.type;return new Fr(e.scale,e.precision,e.bitWidth)}case"date":{const e=t.type;return new Lr(Jn[e.unit])}case"time":{const e=t.type;return new Er(Qn[e.unit],e.bitWidth)}case"timestamp":{const e=t.type;return new Ur(Qn[e.unit],e.timezone)}case"interval":{const e=t.type;return new Cr(ti[e.unit])}case"union":{const n=t.type;return new zr(Xn[n.mode],n.typeIds||[],e||[])}case"fixedsizebinary":{const e=t.type;return new Rr(e.byteWidth)}case"fixedsizelist":{const n=t.type;return new jr(n.listSize,(e||[])[0])}case"map":{const n=t.type;return new Vr((e||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var Wu=ma,qu=Aa,Zu=Ia;class Hu{constructor(t,e,n,i){this._version=e,this._headerType=n,this.body=new Uint8Array(0),i&&(this._createHeader=()=>i),this._bodyLength="number"==typeof t?t:t.low}static fromJSON(t,e){const n=new Hu(0,Hn.V4,e);return n._createHeader=function(t,e){return()=>{switch(e){case ei.Schema:return Vo.fromJSON(t);case ei.RecordBatch:return Xu.fromJSON(t);case ei.DictionaryBatch:return Ku.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${ei[e]}, type: ${e} }`)}}(t,e),n}static decode(t){t=new Zu(Gi(t));const e=Du.getRootAsMessage(t),n=e.bodyLength(),i=e.version(),r=e.headerType(),s=new Hu(n,i,r);return s._createHeader=function(t,e){return()=>{switch(e){case ei.Schema:return Vo.decode(t.header(new Da));case ei.RecordBatch:return Xu.decode(t.header(new mu),t.version());case ei.DictionaryBatch:return Ku.decode(t.header(new gu),t.version())}throw new Error(`Unrecognized Message type: { name: ${ei[e]}, type: ${e} }`)}}(e,r),s}static encode(t){const e=new qu;let n=-1;return t.isSchema()?n=Vo.encode(e,t.header()):t.isRecordBatch()?n=Xu.encode(e,t.header()):t.isDictionaryBatch()&&(n=Ku.encode(e,t.header())),Du.startMessage(e),Du.addVersion(e,Hn.V4),Du.addHeader(e,n),Du.addHeaderType(e,t.headerType),Du.addBodyLength(e,new Wu(t.bodyLength,0)),Du.finishMessageBuffer(e,Du.endMessage(e)),e.asUint8Array()}static from(t,e=0){if(t instanceof Vo)return new Hu(0,Hn.V4,ei.Schema,t);if(t instanceof Xu)return new Hu(e,Hn.V4,ei.RecordBatch,t);if(t instanceof Ku)return new Hu(e,Hn.V4,ei.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===ei.Schema}isRecordBatch(){return this.headerType===ei.RecordBatch}isDictionaryBatch(){return this.headerType===ei.DictionaryBatch}}class Xu{constructor(t,e,n){this._nodes=e,this._buffers=n,this._length="number"==typeof t?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class Ku{constructor(t,e,n=!1){this._data=t,this._isDelta=n,this._id="number"==typeof e?e:e.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class Ju{constructor(t,e){this.offset="number"==typeof t?t:t.low,this.length="number"==typeof e?e:e.low}}class Qu{constructor(t,e){this.length="number"==typeof t?t:t.low,this.nullCount="number"==typeof e?e:e.low}}function tc(t,e){const n=[];for(let i,r=-1,s=-1,o=t.childrenLength();++r<o;)(i=t.children(r))&&(n[++s]=$o.decode(i,e));return n}function ec(t){const e=new Map;if(t)for(let n,i,r=-1,s=Math.trunc(t.customMetadataLength());++r<s;)(n=t.customMetadata(r))&&null!=(i=n.key())&&e.set(i,n.value());return e}function nc(t){return new Tr(t.isSigned(),t.bitWidth())}function ic(t,e){const n=t.typeType();switch(n){case xa.NONE:case xa.Null:return new Ar;case xa.Binary:return new Or;case xa.Utf8:return new Dr;case xa.Bool:return new Nr;case xa.List:return new kr((e||[])[0]);case xa.Struct_:return new Pr(e||[])}switch(n){case xa.Int:{const e=t.type(new Ma);return new Tr(e.isSigned(),e.bitWidth())}case xa.FloatingPoint:{const e=t.type(new _u);return new Br(e.precision())}case xa.Decimal:{const e=t.type(new wu);return new Fr(e.scale(),e.precision(),e.bitWidth())}case xa.Date:{const e=t.type(new Su);return new Lr(e.unit())}case xa.Time:{const e=t.type(new xu);return new Er(e.unit(),e.bitWidth())}case xa.Timestamp:{const e=t.type(new Iu);return new Ur(e.unit(),e.timezone())}case xa.Interval:{const e=t.type(new Au);return new Cr(e.unit())}case xa.Union:{const n=t.type(new Tu);return new zr(n.mode(),n.typeIdsArray()||[],e||[])}case xa.FixedSizeBinary:{const e=t.type(new Mu);return new Rr(e.byteWidth())}case xa.FixedSizeList:{const n=t.type(new Bu);return new jr(n.listSize(),(e||[])[0])}case xa.Map:{const n=t.type(new Ou);return new Vr((e||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${xa[n]}" (${n})`)}$o.encode=function(t,e){let n=-1,i=-1,r=-1;const s=e.type;let o=e.typeId;Ir.isDictionary(s)?(o=s.dictionary.typeId,r=Pu.visit(s,t),i=Pu.visit(s.dictionary,t)):i=Pu.visit(s,t);const a=(s.children||[]).map((e=>$o.encode(t,e))),u=Oa.createChildrenVector(t,a),c=e.metadata&&e.metadata.size>0?Oa.createCustomMetadataVector(t,[...e.metadata].map((([e,n])=>{const i=t.createString(`${e}`),r=t.createString(`${n}`);return Ta.startKeyValue(t),Ta.addKey(t,i),Ta.addValue(t,r),Ta.endKeyValue(t)}))):-1;return e.name&&(n=t.createString(e.name)),Oa.startField(t),Oa.addType(t,i),Oa.addTypeType(t,o),Oa.addChildren(t,u),Oa.addNullable(t,!!e.nullable),-1!==n&&Oa.addName(t,n),-1!==r&&Oa.addDictionary(t,r),-1!==c&&Oa.addCustomMetadata(t,c),Oa.endField(t)},$o.decode=function(t,e){let n,i,r,s,o,a;return e&&(a=t.dictionary())?e.has(n=a.id().low)?(s=(s=a.indexType())?nc(s):new Mr,o=new Gr(e.get(n),s,n,a.isOrdered()),i=new $o(t.name(),o,t.nullable(),ec(t))):(s=(s=a.indexType())?nc(s):new Mr,e.set(n,r=ic(t,tc(t,e))),o=new Gr(r,s,n,a.isOrdered()),i=new $o(t.name(),o,t.nullable(),ec(t))):(r=ic(t,tc(t,e)),i=new $o(t.name(),r,t.nullable(),ec(t))),i||null},$o.fromJSON=function(t,e){let n,i,r,s,o,a;return e&&(s=t.dictionary)?e.has(n=s.id)?(i=(i=s.indexType)?Yu(i):new Mr,a=new Gr(e.get(n),i,n,s.isOrdered),r=new $o(t.name,a,t.nullable,$u(t.customMetadata))):(i=(i=s.indexType)?Yu(i):new Mr,e.set(n,o=Gu(t,Ru(t,e))),a=new Gr(o,i,n,s.isOrdered),r=new $o(t.name,a,t.nullable,$u(t.customMetadata))):(o=Gu(t,Ru(t,e)),r=new $o(t.name,o,t.nullable,$u(t.customMetadata))),r||null},Vo.encode=function(t,e){const n=e.fields.map((e=>$o.encode(t,e)));Da.startFieldsVector(t,n.length);const i=Da.createFieldsVector(t,n),r=e.metadata&&e.metadata.size>0?Da.createCustomMetadataVector(t,[...e.metadata].map((([e,n])=>{const i=t.createString(`${e}`),r=t.createString(`${n}`);return Ta.startKeyValue(t),Ta.addKey(t,i),Ta.addValue(t,r),Ta.endKeyValue(t)}))):-1;return Da.startSchema(t),Da.addFields(t,i),Da.addEndianness(t,rc?wa.Little:wa.Big),-1!==r&&Da.addCustomMetadata(t,r),Da.endSchema(t)},Vo.decode=function(t,e=new Map){const n=function(t,e){const n=[];for(let i,r=-1,s=-1,o=t.fieldsLength();++r<o;)(i=t.fields(r))&&(n[++s]=$o.decode(i,e));return n}(t,e);return new Vo(n,ec(t),e)},Vo.fromJSON=function(t,e=new Map){return new Vo(function(t,e){return(t.fields||[]).filter(Boolean).map((t=>$o.fromJSON(t,e)))}(t,e),$u(t.customMetadata),e)},Xu.encode=function(t,e){const n=e.nodes||[],i=e.buffers||[];mu.startNodesVector(t,n.length);for(const e of n.slice().reverse())Qu.encode(t,e);const r=t.endVector();mu.startBuffersVector(t,i.length);for(const e of i.slice().reverse())Ju.encode(t,e);const s=t.endVector();return mu.startRecordBatch(t),mu.addLength(t,new Wu(e.length,0)),mu.addNodes(t,r),mu.addBuffers(t,s),mu.endRecordBatch(t)},Xu.decode=function(t,e=Hn.V4){if(null!==t.compression())throw new Error("Record batch compression not implemented");return new Xu(t.length(),function(t){const e=[];for(let n,i=-1,r=-1,s=t.nodesLength();++i<s;)(n=t.nodes(i))&&(e[++r]=Qu.decode(n));return e}(t),function(t,e){const n=[];for(let i,r=-1,s=-1,o=t.buffersLength();++r<o;)(i=t.buffers(r))&&(e<Hn.V4&&(i.bb_pos+=8*(r+1)),n[++s]=Ju.decode(i));return n}(t,e))},Xu.fromJSON=zu,Ku.encode=function(t,e){const n=Xu.encode(t,e.data);return gu.startDictionaryBatch(t),gu.addId(t,new Wu(e.id,0)),gu.addIsDelta(t,e.isDelta),gu.addData(t,n),gu.endDictionaryBatch(t)},Ku.decode=function(t,e=Hn.V4){return new Ku(Xu.decode(t.data(),e),t.id(),t.isDelta())},Ku.fromJSON=function(t){return new Ku(zu(t.data),t.id,t.isDelta)},Qu.encode=function(t,e){return vu.createFieldNode(t,new Wu(e.length,0),new Wu(e.nullCount,0))},Qu.decode=function(t){return new Qu(t.length(),t.nullCount())},Ju.encode=function(t,e){return bu.createBuffer(t,new Wu(e.offset,0),new Wu(e.length,0))},Ju.decode=function(t){return new Ju(t.offset(),t.length())};const rc=(()=>{const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),256===new Int16Array(t)[0]})(),sc=t=>`Expected ${ei[t]} Message in stream, but was null or length 0.`,oc=t=>`Header pointer of flatbuffer-encoded ${ei[t]} Message is null or length 0.`,ac=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,uc=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`;class cc{constructor(t){this.source=t instanceof qa?t:new qa(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||-1===t.value&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?Va:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(sc(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const e=Gi(this.source.read(t));if(e.byteLength<t)throw new Error(uc(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(t=!1){const e=ei.Schema,n=this.readMessage(e),i=null==n?void 0:n.header();if(t&&!i)throw new Error(oc(e));return i}readMetadataLength(){const t=this.source.read(dc),e=t&&new Ia(t),n=(null==e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}readMetadata(t){const e=this.source.read(t);if(!e)return Va;if(e.byteLength<t)throw new Error(ac(t,e.byteLength));return{done:!1,value:Hu.decode(e)}}}class lc{constructor(t,e){this.source=t instanceof Za?t:Ei(t)?new Ja(t,e):new Za(t)}[Symbol.asyncIterator](){return this}next(){return di(this,void 0,void 0,(function*(){let t;return(t=yield this.readMetadataLength()).done||-1===t.value&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?Va:t}))}throw(t){return di(this,void 0,void 0,(function*(){return yield this.source.throw(t)}))}return(t){return di(this,void 0,void 0,(function*(){return yield this.source.return(t)}))}readMessage(t){return di(this,void 0,void 0,(function*(){let e;if((e=yield this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(sc(t));return e.value}))}readMessageBody(t){return di(this,void 0,void 0,(function*(){if(t<=0)return new Uint8Array(0);const e=Gi(yield this.source.read(t));if(e.byteLength<t)throw new Error(uc(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}))}readSchema(t=!1){return di(this,void 0,void 0,(function*(){const e=ei.Schema,n=yield this.readMessage(e),i=null==n?void 0:n.header();if(t&&!i)throw new Error(oc(e));return i}))}readMetadataLength(){return di(this,void 0,void 0,(function*(){const t=yield this.source.read(dc),e=t&&new Ia(t),n=(null==e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}))}readMetadata(t){return di(this,void 0,void 0,(function*(){const e=yield this.source.read(t);if(!e)return Va;if(e.byteLength<t)throw new Error(ac(t,e.byteLength));return{done:!1,value:Hu.decode(e)}}))}}class hc extends cc{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof $a?t:new $a(t)}next(){const{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:Hu.fromJSON(t.schema,ei.Schema)};if(this._dictionaryIndex<t.dictionaries.length){const e=t.dictionaries[this._dictionaryIndex++];return this._body=e.data.columns,{done:!1,value:Hu.fromJSON(e,ei.DictionaryBatch)}}if(this._batchIndex<t.batches.length){const e=t.batches[this._batchIndex++];return this._body=e.columns,{done:!1,value:Hu.fromJSON(e,ei.RecordBatch)}}return this._body=[],Va}readMessageBody(t){return function t(e){return(e||[]).reduce(((e,n)=>[...e,...n.VALIDITY&&[n.VALIDITY]||[],...n.TYPE&&[n.TYPE]||[],...n.OFFSET&&[n.OFFSET]||[],...n.DATA&&[n.DATA]||[],...t(n.children)]),[])}(this._body)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(sc(t));return e.value}readSchema(){const t=ei.Schema,e=this.readMessage(t),n=null==e?void 0:e.header();if(!e||!n)throw new Error(oc(t));return n}}const dc=4,fc=new Uint8Array(6);for(let t=0;t<6;t+=1)fc[t]="ARROW1".codePointAt(t);function pc(t,e=0){for(let n=-1,i=fc.length;++n<i;)if(fc[n]!==t[e+n])return!1;return!0}const yc=fc.length,bc=yc+dc,vc=2*yc+dc;class mc extends Ya{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const e=this._impl.open(t);return Oi(e)?e.then((()=>this)):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Pa.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Pa.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof mc?t:Fi(t)?function(t){return new gc(new Bc(t))}(t):Ei(t)?function(t){return di(this,void 0,void 0,(function*(){const{size:e}=yield t.stat(),n=new Ja(t,e);return e>=vc&&pc(yield n.readAt(0,yc+7&-8))?new Sc(new Mc(n)):new _c(new Ac(n))}))}(t):Oi(t)?(()=>di(this,void 0,void 0,(function*(){return yield mc.from(yield t)})))():Ui(t)||ki(t)||Pi(t)||Ni(t)?function(t){return di(this,void 0,void 0,(function*(){const e=yield t.peek(yc+7&-8);return e&&e.byteLength>=4?pc(e)?new wc(new Tc(yield t.read())):new _c(new Ac(t)):new _c(new Ac(function(){return pi(this,arguments,(function*(){}))}()))}))}(new Za(t)):function(t){const e=t.peek(yc+7&-8);return e&&e.byteLength>=4?pc(e)?new wc(new Tc(t.read())):new gc(new Ic(t)):new gc(new Ic(function*(){}()))}(new qa(t))}static readAll(t){return t instanceof mc?t.isSync()?Dc(t):Nc(t):Fi(t)||ArrayBuffer.isView(t)||Di(t)||Li(t)?Dc(t):Nc(t)}}class gc extends mc{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return pi(this,arguments,(function*(){yield fi(yield*yi(bi(this[Symbol.iterator]())))}))}}class _c extends mc{constructor(t){super(t),this._impl=t}readAll(){var t,e;return di(this,void 0,void 0,(function*(){const n=new Array;try{for(var i,r=bi(this);!(i=yield r.next()).done;){const t=i.value;n.push(t)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&(yield e.call(r))}finally{if(t)throw t.error}}return n}))}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class wc extends gc{constructor(t){super(t),this._impl=t}}class Sc extends _c{constructor(t){super(t),this._impl=t}}class xc{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){const n=this._loadVectors(t,e,this.schema.fields),i=jo({type:new Pr(this.schema.fields),length:t.length,children:n});return new oa(this.schema,i)}_loadDictionaryBatch(t,e){const{id:n,isDelta:i}=t,{dictionaries:r,schema:s}=this,o=r.get(n);if(i||!o){const r=s.dictionaries.get(n),a=this._loadVectors(t.data,e,[r]);return(o&&i?o.concat(new ko(a)):new ko(a)).memoize()}return o.memoize()}_loadVectors(t,e,n){return new su(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}class Ic extends xc{constructor(t,e){super(e),this._reader=Fi(t)?new hc(this._handle=t):new cc(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=Oc(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):Va}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):Va}next(){if(this.closed)return Va;let t;const{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),i=e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),i=e.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,r)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new ca(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class Ac extends xc{constructor(t,e){super(e),this._reader=new lc(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return di(this,void 0,void 0,(function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}))}open(t){return di(this,void 0,void 0,(function*(){return this.closed||(this.autoDestroy=Oc(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this}))}throw(t){return di(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):Va}))}return(t){return di(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):Va}))}next(){return di(this,void 0,void 0,(function*(){if(this.closed)return Va;let t;const{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),i=yield e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),i=yield e.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,r)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new ca(this.schema)}):yield this.return()}))}_readNextMessageAndValidate(t){return di(this,void 0,void 0,(function*(){return yield this._reader.readMessage(t)}))}}class Tc extends Ic{constructor(t,e){super(t instanceof Ka?t:new Ka(t),e)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(n&&this._handle.seek(n.offset)){const t=this._reader.readMessage(ei.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),n=this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,n)}}return null}_readDictionaryBatch(t){var e;const n=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(n&&this._handle.seek(n.offset)){const t=this._reader.readMessage(ei.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),n=this._reader.readMessageBody(t.bodyLength),i=this._loadDictionaryBatch(e,n);this.dictionaries.set(e.id,i)}}}_readFooter(){const{_handle:t}=this,e=t.size-bc,n=t.readInt32(e),i=t.readAt(e-n,n);return Ua.decode(i)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(t)}return null}}class Mc extends Ac{constructor(t,...e){const n="number"!=typeof e[0]?e.shift():void 0,i=e[0]instanceof Map?e.shift():void 0;super(t instanceof Ja?t:new Ja(t,n),i)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){const e=Object.create(null,{open:{get:()=>super.open}});return di(this,void 0,void 0,(function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)}))}readRecordBatch(t){var e;return di(this,void 0,void 0,(function*(){if(this.closed)return null;this._footer||(yield this.open());const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(n&&(yield this._handle.seek(n.offset))){const t=yield this._reader.readMessage(ei.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),n=yield this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,n)}}return null}))}_readDictionaryBatch(t){var e;return di(this,void 0,void 0,(function*(){const n=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(n&&(yield this._handle.seek(n.offset))){const t=yield this._reader.readMessage(ei.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),n=yield this._reader.readMessageBody(t.bodyLength),i=this._loadDictionaryBatch(e,n);this.dictionaries.set(e.id,i)}}}))}_readFooter(){return di(this,void 0,void 0,(function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const e=t.size-bc,n=yield t.readInt32(e),i=yield t.readAt(e-n,n);return Ua.decode(i)}))}_readNextMessageAndValidate(t){return di(this,void 0,void 0,(function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null}))}}class Bc extends Ic{constructor(t,e){super(t,e)}_loadVectors(t,e,n){return new ou(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}function Oc(t,e){return e&&"boolean"==typeof e.autoDestroy?e.autoDestroy:t.autoDestroy}function*Dc(t){const e=mc.from(t);try{if(!e.open({autoDestroy:!1}).closed)do{yield e}while(!e.reset().open().closed)}finally{e.cancel()}}function Nc(t){return pi(this,arguments,(function*(){const e=yield fi(mc.from(t));try{if(!(yield fi(e.open({autoDestroy:!1}))).closed)do{yield yield fi(e)}while(!(yield fi(e.reset().open())).closed)}finally{yield fi(e.cancel())}}))}function Fc(t){const e=mc.from(t);return Oi(e)?e.then((t=>Fc(t))):e.isAsync()?e.readAll().then((t=>new da(t))):new da(e.readAll())}function Lc(t){return Lc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lc(t)}function Ec(){Ec=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new A(r||[]);return i(o,"_invoke",{value:w(t,n,a)}),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var y={};u(y,s,(function(){return this}));var b=Object.getPrototypeOf,v=b&&b(b(T([])));v&&v!==e&&n.call(v,s)&&(y=v);var m=p.prototype=d.prototype=Object.create(y);function g(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(i,s,o,a){var u=l(t[i],t,s);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==Lc(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,o,a)}),(function(t){r("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return r("throw",t,o,a)}))}a(u.arg)}var s;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return s=s?s.then(i,i):i()}})}function w(t,e,n){var i="suspendedStart";return function(r,s){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw s;return{value:void 0,done:!0}}for(n.method=r,n.arg=s;;){var o=n.delegate;if(o){var a=S(o,n);if(a){if(a===h)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=l(t,e,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}function S(t,e){var n=e.method,i=t.iterator[n];if(void 0===i)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var r=l(i,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var s=r.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function T(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:M}}function M(){return{value:void 0,done:!0}}return f.prototype=p,i(m,"constructor",{value:p,configurable:!0}),i(p,"constructor",{value:f,configurable:!0}),f.displayName=u(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},g(_.prototype),u(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,i,r,s){void 0===s&&(s=Promise);var o=new _(c(e,n,i,r),s);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},g(m),u(m,a,"Generator"),u(m,s,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},t.values=T,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return o.type="throw",o.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var a=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(a&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;I(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function Uc(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Cc(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cc(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Cc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function kc(t,e,n,i,r,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,r)}function Pc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==Lc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!==Lc(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===Lc(r)?r:String(r)),i)}var r}function zc(t,e){return zc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zc(t,e)}function Rc(t){return Rc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Rc(t)}var jc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zc(t,e)}(o,t);var e,n,i,r,s=(i=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Rc(i);if(r){var n=Rc(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Lc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function o(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=s.call(this,t,e,i)).cells=[],n.infoLoadingStatus="notLoaded",!i.readParquetFun)throw new Error("readParquet function needed for parquet dataset");return n.readParquetFun=i.readParquetFun,n}return e=o,n=[{key:"getData",value:function(t,e){var n,i=this;return"notLoaded"!=this.infoLoadingStatus||(this.infoLoadingStatus="loading",(n=Ec().mark((function t(){var n,r,s,o,a,u,c,l;return Ec().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(i.url);case 3:return n=t.sent,t.t0=Uint8Array,t.next=7,n.arrayBuffer();case 7:t.t1=t.sent,r=new t.t0(t.t1),s=i.readParquetFun(r),o=Fc(s),i.cells=[],a=Uc(o),t.prev=13,a.s();case 15:if((u=a.n()).done){t.next=28;break}if(c=u.value,l=c.toJSON(),!i.preprocess){t.next=25;break}if(0!=i.preprocess(l)){t.next=22;break}return t.abrupt("continue",26);case 22:i.cells.push(l),t.next=26;break;case 25:i.cells.push(l);case 26:t.next=15;break;case 28:t.next=33;break;case 30:t.prev=30,t.t2=t.catch(13),a.e(t.t2);case 33:return t.prev=33,a.f(),t.finish(33);case 36:e&&e(),i.infoLoadingStatus="loaded",t.next=44;break;case 40:t.prev=40,t.t3=t.catch(0),i.infoLoadingStatus="failed",i.cells=[];case 44:case"end":return t.stop()}}),t,null,[[0,40],[13,30,33,36]])})),function(){var t=this,e=arguments;return new Promise((function(i,r){var s=n.apply(t,e);function o(t){kc(s,i,r,o,a,"next",t)}function a(t){kc(s,i,r,o,a,"throw",t)}o(void 0)}))})()),this}},{key:"updateViewCache",value:function(t){if(this.cells){this.cellsViewCache=[];var e,n=Uc(this.cells);try{for(n.s();!(e=n.n()).done;){var i=e.value;+i.x+this.resolution<t.xMin||+i.x-this.resolution>t.xMax||+i.y+this.resolution<t.yMin||+i.y-this.resolution>t.yMax||this.cellsViewCache.push(i)}}catch(t){n.e(t)}finally{n.f()}}}}],n&&Pc(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Pn);function Vc(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function $c(t,e){return fetch(t,e).then(Vc)}function Yc(t){return Yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yc(t)}function Gc(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Wc(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wc(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){a=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}function Wc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function qc(){qc=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var s=e&&e.prototype instanceof d?e:d,o=Object.create(s.prototype),a=new A(r||[]);return i(o,"_invoke",{value:w(t,n,a)}),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h={};function d(){}function f(){}function p(){}var y={};u(y,s,(function(){return this}));var b=Object.getPrototypeOf,v=b&&b(b(T([])));v&&v!==e&&n.call(v,s)&&(y=v);var m=p.prototype=d.prototype=Object.create(y);function g(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function r(i,s,o,a){var u=l(t[i],t,s);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==Yc(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,o,a)}),(function(t){r("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return r("throw",t,o,a)}))}a(u.arg)}var s;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return s=s?s.then(i,i):i()}})}function w(t,e,n){var i="suspendedStart";return function(r,s){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw s;return{value:void 0,done:!0}}for(n.method=r,n.arg=s;;){var o=n.delegate;if(o){var a=S(o,n);if(a){if(a===h)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=l(t,e,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}function S(t,e){var n=e.method,i=t.iterator[n];if(void 0===i)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,S(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var r=l(i,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,h;var s=r.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function x(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(x,this),this.reset(!0)}function T(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function e(){for(;++i<t.length;)if(n.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:M}}function M(){return{value:void 0,done:!0}}return f.prototype=p,i(m,"constructor",{value:p,configurable:!0}),i(p,"constructor",{value:f,configurable:!0}),f.displayName=u(p,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,a,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},g(_.prototype),u(_.prototype,o,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,i,r,s){void 0===s&&(s=Promise);var o=new _(c(e,n,i,r),s);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},g(m),u(m,a,"Generator"),u(m,s,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},t.values=T,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(n,i){return o.type="throw",o.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var a=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(a&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;I(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:T(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}function Zc(t,e,n,i,r,s,o){try{var a=t[s](o),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,r)}function Hc(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var s=t.apply(e,n);function o(t){Zc(s,i,r,o,a,"next",t)}function a(t){Zc(s,i,r,o,a,"throw",t)}o(void 0)}))}}function Xc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(void 0,r=function(t,e){if("object"!==Yc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!==Yc(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===Yc(r)?r:String(r)),i)}var r}function Kc(t,e){return Kc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Kc(t,e)}function Jc(t){return Jc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Jc(t)}var Qc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kc(t,e)}(o,t);var e,n,i,r,s=(i=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Jc(i);if(r){var n=Jc(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Yc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function o(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(n=s.call(this,t,0,i)).app=e,n.info=void 0,n.infoLoadingStatus="notLoaded",n.cache={},n.readParquetFun=i.readParquetFun,n}return e=o,(n=[{key:"loadInfo",value:function(t){var e=this;return this.info||"notLoaded"!==this.infoLoadingStatus?!t||"loaded"!==this.infoLoadingStatus&&"failed"!==this.infoLoadingStatus||t():Hc(qc().mark((function n(){var i;return qc().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,$c(e.url+"info.json");case 3:i=n.sent,e.info=i,e.resolution=i.resolutionGeo,e.infoLoadingStatus="loaded",t&&t(),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(0),e.infoLoadingStatus="failed";case 13:case"end":return n.stop()}}),n,null,[[0,10]])})))(),this}},{key:"getTilingEnvelope",value:function(t){if(this.info){var e=this.info.originPoint,n=this.info.resolutionGeo,i=this.info.tileSizeCell;return{xMin:Math.floor((t.xMin-e.x)/(n*i)),xMax:Math.floor((t.xMax-e.x)/(n*i)),yMin:Math.floor((t.yMin-e.y)/(n*i)),yMax:Math.floor((t.yMax-e.y)/(n*i))}}this.loadInfo((function(){}))}},{key:"getData",value:function(t,e){var n=this;if(!this.info)return this;var i=this.getTilingEnvelope(t);if(!i)return this;for(var r=this.info.tilingBounds,s=function(t){for(var s=function(i){if(n.cache[t]||(n.cache[t]={}),n.cache[t][i])return"continue";n.cache[t][i]="loading",Hc(qc().mark((function r(){var s,o,a,u,c,l,h,d,f,p,y,b,v,m,g,_,w;return qc().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,n.readParquetFun){r.next=3;break}throw new Error("readParquet function needed for parquet dataset");case 3:return r.next=5,fetch(n.url+t+"/"+i+".parquet");case 5:return o=r.sent,r.t0=Uint8Array,r.next=9,o.arrayBuffer();case 9:r.t1=r.sent,a=new r.t0(r.t1),u=n.readParquetFun(a),c=Fc(u),s=[],l=Gc(c),r.prev=15,l.s();case 17:if((h=l.n()).done){r.next=30;break}if(d=h.value,f=d.toJSON(),!n.preprocess){r.next=27;break}if(0!=n.preprocess(f)){r.next=24;break}return r.abrupt("continue",28);case 24:s.push(f),r.next=28;break;case 27:s.push(f);case 28:r.next=17;break;case 30:r.next=35;break;case 32:r.prev=32,r.t2=r.catch(15),l.e(r.t2);case 35:return r.prev=35,l.f(),r.finish(35);case 38:r.next=44;break;case 40:return r.prev=40,r.t3=r.catch(0),n.cache[t][i]="failed",r.abrupt("return");case 44:if(n.info){r.next=47;break}return console.error("Tile info inknown"),r.abrupt("return");case 47:if(p=new zn(s,t,i,n.info),n.cache[t][i]=p,e){r.next=51;break}return r.abrupt("return");case 51:y=!1,b=n.app.getZoomFactor(),v=Gc(n.app.layers),r.prev=54,v.s();case 56:if((m=v.n()).done){r.next=66;break}if((g=m.value).visible){r.next=60;break}return r.abrupt("continue",64);case 60:if(g.getDatasetComponent(b)==n){r.next=62;break}return r.abrupt("continue",64);case 62:return y=!0,r.abrupt("break",66);case 64:r.next=56;break;case 66:r.next=71;break;case 68:r.prev=68,r.t4=r.catch(54),v.e(r.t4);case 71:return r.prev=71,v.f(),r.finish(71);case 74:if(y){r.next=76;break}return r.abrupt("return");case 76:if(_=n.app.updateExtentGeo(),w=p.extGeo,!(_.xMax<=w.xMin)){r.next=80;break}return r.abrupt("return");case 80:if(!(_.xMin>=w.xMax)){r.next=82;break}return r.abrupt("return");case 82:if(!(_.yMax<=w.yMin)){r.next=84;break}return r.abrupt("return");case 84:if(!(_.yMin>=w.yMax)){r.next=86;break}return r.abrupt("return");case 86:e();case 87:case"end":return r.stop()}}),r,null,[[0,40],[15,32,35,38],[54,68,71,74]])})))()},o=Math.max(i.yMin,r.yMin);o<=Math.min(i.yMax,r.yMax);o++)s(o)},o=Math.max(i.xMin,r.xMin);o<=Math.min(i.xMax,r.xMax);o++)s(o);return this}},{key:"updateViewCache",value:function(t){if(this.cellsViewCache=[],this.info){var e=this.getTilingEnvelope(t);if(e)for(var n=this.info.tilingBounds,i=Math.max(e.xMin,n.xMin);i<=Math.min(e.xMax,n.xMax);i++)if(this.cache[i])for(var r=Math.max(e.yMin,n.yMin);r<=Math.min(e.yMax,n.yMax);r++){var s=this.cache[i][r];if(s&&"string"!=typeof s){var o,a=Gc(s.cells);try{for(a.s();!(o=a.n()).done;){var u=o.value;+u.x+this.resolution<t.xMin||+u.x-this.resolution>t.xMax||+u.y+this.resolution<t.yMin||+u.y-this.resolution>t.yMax||this.cellsViewCache.push(u)}}catch(t){a.e(t)}finally{a.f()}}}}}}])&&Xc(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),o}(Pn),tl=function(t,e,n,i){return new kn([new jc(e,n,i).getData(void 0,(function(){t.cg.redraw()}))],[],i)},el=function(t,e,n,i,r){var s=tl(t,e,n,r);return t.addLayerFromDataset(s,i,r)},nl=function(t,e,n,i){return kn.make(e,(function(e){return new jc(n(e),e,i).getData(void 0,(function(){t.cg.redraw()}))}),i)},il=function(t,e,n,i,r){var s=nl(t,e,n,r);return t.addLayerFromDataset(s,i,r)},rl=function(t,e,n){return new kn([new Qc(e,t,n).loadInfo((function(){t.cg.redraw()}))],[],n)},sl=function(t,e,n,i){var r=rl(t,e,i);return t.addLayerFromDataset(r,n,i)},ol=function(t,e,n,i){return kn.make(e,(function(e){return new Qc(n(e),t,i).loadInfo((function(){t.cg.redraw()}))}),i)},al=function(t,e,n,i,r){var s=ol(t,e,n,r);return t.addLayerFromDataset(s,i,r)};return e})()));