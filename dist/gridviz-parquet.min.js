/*! For license information please see gridviz-parquet.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.gviz_par=e():t.gviz_par=e()}(self,(()=>(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(){}function r(t){return null==t?n:function(){return this.querySelector(t)}}function i(){return[]}function o(t){return null==t?i:function(){return this.querySelectorAll(t)}}function a(t){return function(){return this.matches(t)}}function u(t){return function(e){return e.matches(t)}}t.r(e),t.d(e,{ParquetGrid:()=>xi,TiledParquetGrid:()=>zi});var s=Array.prototype.find;function f(){return this.firstElementChild}var c=Array.prototype.filter;function l(){return Array.from(this.children)}function h(t){return new Array(t.length)}function p(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function d(t,e,n,r,i,o){for(var a,u=0,s=e.length,f=o.length;u<f;++u)(a=e[u])?(a.__data__=o[u],r[u]=a):n[u]=new p(t,o[u]);for(;u<s;++u)(a=e[u])&&(i[u]=a)}function y(t,e,n,r,i,o,a){var u,s,f,c=new Map,l=e.length,h=o.length,d=new Array(l);for(u=0;u<l;++u)(s=e[u])&&(d[u]=f=a.call(s,s.__data__,u,e)+"",c.has(f)?i[u]=s:c.set(f,s));for(u=0;u<h;++u)f=a.call(t,o[u],u,o)+"",(s=c.get(f))?(r[u]=s,s.__data__=o[u],c.delete(f)):n[u]=new p(t,o[u]);for(u=0;u<l;++u)(s=e[u])&&c.get(d[u])===s&&(i[u]=s)}function v(t){return t.__data__}function m(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function g(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}p.prototype={constructor:p,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var _="http://www.w3.org/1999/xhtml";const w={svg:"http://www.w3.org/2000/svg",xhtml:_,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function b(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),w.hasOwnProperty(e)?{space:w[e],local:t}:t}function x(t){return function(){this.removeAttribute(t)}}function E(t){return function(){this.removeAttributeNS(t.space,t.local)}}function A(t,e){return function(){this.setAttribute(t,e)}}function T(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function M(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function L(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function N(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function S(t){return function(){this.style.removeProperty(t)}}function I(t,e,n){return function(){this.style.setProperty(t,e,n)}}function O(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function k(t,e){return t.style.getPropertyValue(e)||N(t).getComputedStyle(t,null).getPropertyValue(e)}function P(t){return function(){delete this[t]}}function R(t,e){return function(){this[t]=e}}function z(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function D(t){return t.trim().split(/^|\s+/)}function C(t){return t.classList||new j(t)}function j(t){this._node=t,this._names=D(t.getAttribute("class")||"")}function U(t,e){for(var n=C(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function $(t,e){for(var n=C(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function B(t){return function(){U(this,t)}}function Y(t){return function(){$(this,t)}}function q(t,e){return function(){(e.apply(this,arguments)?U:$)(this,t)}}function G(){this.textContent=""}function F(t){return function(){this.textContent=t}}function V(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function X(){this.innerHTML=""}function Z(t){return function(){this.innerHTML=t}}function H(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Q(){this.nextSibling&&this.parentNode.appendChild(this)}function K(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function W(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===_&&e.documentElement.namespaceURI===_?e.createElement(t):e.createElementNS(n,t)}}function J(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function tt(t){var e=b(t);return(e.local?J:W)(e)}function et(){return null}function nt(){var t=this.parentNode;t&&t.removeChild(this)}function rt(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function it(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ot(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function at(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var a=0,u=i.length;a<u;++a)if((r=i[a]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function ut(t,e,n){var r=N(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function st(t,e){return function(){return ut(this,t,e)}}function ft(t,e){return function(){return ut(this,t,e.apply(this,arguments))}}j.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ct=[null];function lt(t,e){this._groups=t,this._parents=e}function ht(){return new lt([[document.documentElement]],ct)}lt.prototype=ht.prototype={constructor:lt,select:function(t){"function"!=typeof t&&(t=r(t));for(var e=this._groups,n=e.length,i=new Array(n),o=0;o<n;++o)for(var a,u,s=e[o],f=s.length,c=i[o]=new Array(f),l=0;l<f;++l)(a=s[l])&&(u=t.call(a,a.__data__,l,s))&&("__data__"in a&&(u.__data__=a.__data__),c[l]=u);return new lt(i,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return null==(e=t.apply(this,arguments))?[]:Array.isArray(e)?e:Array.from(e);var e}}(t):o(t);for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var u,s=e[a],f=s.length,c=0;c<f;++c)(u=s[c])&&(r.push(t.call(u,u.__data__,c,s)),i.push(u));return new lt(r,i)},selectChild:function(t){return this.select(null==t?f:function(t){return function(){return s.call(this.children,t)}}("function"==typeof t?t:u(t)))},selectChildren:function(t){return this.selectAll(null==t?l:function(t){return function(){return c.call(this.children,t)}}("function"==typeof t?t:u(t)))},filter:function(t){"function"!=typeof t&&(t=a(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,u=e[i],s=u.length,f=r[i]=[],c=0;c<s;++c)(o=u[c])&&t.call(o,o.__data__,c,u)&&f.push(o);return new lt(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,v);var n,r=e?y:d,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var a=o.length,u=new Array(a),s=new Array(a),f=new Array(a),c=0;c<a;++c){var l=i[c],h=o[c],p=h.length,g=m(t.call(l,l&&l.__data__,c,i)),_=g.length,w=s[c]=new Array(_),b=u[c]=new Array(_);r(l,h,w,b,f[c]=new Array(p),g,e);for(var x,E,A=0,T=0;A<_;++A)if(x=w[A]){for(A>=T&&(T=A+1);!(E=b[T])&&++T<_;);x._next=E||null}}return(u=new lt(u,i))._enter=s,u._exit=f,u},enter:function(){return new lt(this._enter||this._groups.map(h),this._parents)},exit:function(){return new lt(this._exit||this._groups.map(h),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),u=new Array(i),s=0;s<a;++s)for(var f,c=n[s],l=r[s],h=c.length,p=u[s]=new Array(h),d=0;d<h;++d)(f=c[d]||l[d])&&(p[d]=f);for(;s<i;++s)u[s]=n[s];return new lt(u,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=g);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,u=n[o],s=u.length,f=i[o]=new Array(s),c=0;c<s;++c)(a=u[c])&&(f[c]=a);f.sort(e)}return new lt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,u=o.length;a<u;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=b(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?E:x:"function"==typeof e?n.local?L:M:n.local?T:A)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?S:"function"==typeof e?O:I)(t,e,null==n?"":n)):k(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?P:"function"==typeof e?z:R)(t,e)):this.node()[t]},classed:function(t,e){var n=D(t+"");if(arguments.length<2){for(var r=C(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?q:e?B:Y)(n,e))},text:function(t){return arguments.length?this.each(null==t?G:("function"==typeof t?V:F)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?X:("function"==typeof t?H:Z)(t)):this.node().innerHTML},raise:function(){return this.each(Q)},lower:function(){return this.each(K)},append:function(t){var e="function"==typeof t?t:tt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:tt(t),i=null==e?et:"function"==typeof e?e:r(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(nt)},clone:function(t){return this.select(t?it:rt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),a=o.length;if(!(arguments.length<2)){for(u=e?at:ot,r=0;r<a;++r)this.each(u(o[r],e,n));return this}var u=this.node().__on;if(u)for(var s,f=0,c=u.length;f<c;++f)for(r=0,s=u[f];r<a;++r)if((i=o[r]).type===s.type&&i.name===s.name)return s.value},dispatch:function(t,e){return this.each(("function"==typeof e?ft:st)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,a=i.length;o<a;++o)(r=i[o])&&(yield r)}};const pt=ht;function dt(t){return"string"==typeof t?new lt([[document.querySelector(t)]],[document.documentElement]):new lt([[t]],ct)}var yt={value:()=>{}};function vt(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new mt(r)}function mt(t){this._=t}function gt(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function _t(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=yt,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}mt.prototype=vt.prototype={constructor:mt,on:function(t,e){var n,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}}))),a=-1,u=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<u;)if(n=(t=o[a]).type)i[n]=_t(i[n],t.name,e);else if(null==e)for(n in i)i[n]=_t(i[n],t.name,null);return this}for(;++a<u;)if((n=(t=o[a]).type)&&(n=gt(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new mt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const wt=vt,bt={capture:!0,passive:!1};function xt(t){t.preventDefault(),t.stopImmediatePropagation()}function Et(t){return((t=Math.exp(t))+1/t)/2}const At=function t(e,n,r){function i(t,i){var o,a,u=t[0],s=t[1],f=t[2],c=i[0],l=i[1],h=i[2],p=c-u,d=l-s,y=p*p+d*d;if(y<1e-12)a=Math.log(h/f)/e,o=function(t){return[u+t*p,s+t*d,f*Math.exp(e*t*a)]};else{var v=Math.sqrt(y),m=(h*h-f*f+r*y)/(2*f*n*v),g=(h*h-f*f-r*y)/(2*h*n*v),_=Math.log(Math.sqrt(m*m+1)-m),w=Math.log(Math.sqrt(g*g+1)-g);a=(w-_)/e,o=function(t){var r,i=t*a,o=Et(_),c=f/(n*v)*(o*(r=e*i+_,((r=Math.exp(2*r))-1)/(r+1))-function(t){return((t=Math.exp(t))-1/t)/2}(_));return[u+c*p,s+c*d,f*o/Et(e*i+_)]}}return o.duration=1e3*a*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function Tt(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}var Mt,Lt,Nt=0,St=0,It=0,Ot=1e3,kt=0,Pt=0,Rt=0,zt="object"==typeof performance&&performance.now?performance:Date,Dt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ct(){return Pt||(Dt(jt),Pt=zt.now()+Rt)}function jt(){Pt=0}function Ut(){this._call=this._time=this._next=null}function $t(t,e,n){var r=new Ut;return r.restart(t,e,n),r}function Bt(){Pt=(kt=zt.now())+Rt,Nt=St=0;try{!function(){Ct(),++Nt;for(var t,e=Mt;e;)(t=Pt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Nt}()}finally{Nt=0,function(){for(var t,e,n=Mt,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Mt=e);Lt=t,qt(r)}(),Pt=0}}function Yt(){var t=zt.now(),e=t-kt;e>Ot&&(Rt-=e,kt=t)}function qt(t){Nt||(St&&(St=clearTimeout(St)),t-Pt>24?(t<1/0&&(St=setTimeout(Bt,t-zt.now()-Rt)),It&&(It=clearInterval(It))):(It||(kt=zt.now(),It=setInterval(Yt,Ot)),Nt=1,Dt(Bt)))}function Gt(t,e,n){var r=new Ut;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}Ut.prototype=$t.prototype={constructor:Ut,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Ct():+n)+(null==e?0:+e),this._next||Lt===this||(Lt?Lt._next=this:Mt=this,Lt=this),this._call=t,this._time=n,qt()},stop:function(){this._call&&(this._call=null,this._time=1/0,qt())}};var Ft=wt("start","end","cancel","interrupt"),Vt=[],Xt=0,Zt=2,Ht=3,Qt=5,Kt=6;function Wt(t,e,n,r,i,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(s){var f,c,l,h;if(1!==n.state)return u();for(f in i)if((h=i[f]).name===n.name){if(h.state===Ht)return Gt(o);4===h.state?(h.state=Kt,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[f]):+f<e&&(h.state=Kt,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[f])}if(Gt((function(){n.state===Ht&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(s))})),n.state=Zt,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Zt){for(n.state=Ht,r=new Array(l=n.tween.length),f=0,c=-1;f<l;++f)(h=n.tween[f].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=h);r.length=c+1}}function a(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(u),n.state=Qt,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);n.state===Qt&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){for(var r in n.state=Kt,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=$t((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:Ft,tween:Vt,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Xt})}function Jt(t,e){var n=ee(t,e);if(n.state>Xt)throw new Error("too late; already scheduled");return n}function te(t,e){var n=ee(t,e);if(n.state>Ht)throw new Error("too late; already running");return n}function ee(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ne(t,e){var n,r,i,o=t.__transition,a=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>Zt&&n.state<Qt,n.state=Kt,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):a=!1;a&&delete t.__transition}}function re(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var ie,oe=180/Math.PI,ae={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ue(t,e,n,r,i,o){var a,u,s;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(s=t*n+e*r)&&(n-=t*s,r-=e*s),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,s/=u),t*r<e*n&&(t=-t,e=-e,s=-s,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*oe,skewX:Math.atan(s)*oe,scaleX:a,scaleY:u}}function se(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var u=[],s=[];return o=t(o),a=t(a),function(t,r,i,o,a,u){if(t!==i||r!==o){var s=a.push("translate(",null,e,null,n);u.push({i:s-4,x:re(t,i)},{i:s-2,x:re(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,u,s),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:re(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,u,s),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:re(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,u,s),function(t,e,n,r,o,a){if(t!==n||e!==r){var u=o.push(i(o)+"scale(",null,",",null,")");a.push({i:u-4,x:re(t,n)},{i:u-2,x:re(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,u,s),o=a=null,function(t){for(var e,n=-1,r=s.length;++n<r;)u[(e=s[n]).i]=e.x(t);return u.join("")}}}var fe=se((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ae:ue(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),ce=se((function(t){return null==t?ae:(ie||(ie=document.createElementNS("http://www.w3.org/2000/svg","g")),ie.setAttribute("transform",t),(t=ie.transform.baseVal.consolidate())?ue((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):ae)}),", ",")",")");function le(t,e){var n,r;return function(){var i=te(this,t),o=i.tween;if(o!==n)for(var a=0,u=(r=n=o).length;a<u;++a)if(r[a].name===e){(r=r.slice()).splice(a,1);break}i.tween=r}}function he(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=te(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var u={name:e,value:n},s=0,f=i.length;s<f;++s)if(i[s].name===e){i[s]=u;break}s===f&&i.push(u)}o.tween=i}}function pe(t,e,n){var r=t._id;return t.each((function(){var t=te(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return ee(t,r).value[e]}}function de(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ye(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ve(){}var me=.7,ge=1/me,_e="\\s*([+-]?\\d+)\\s*",we="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",be="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xe=/^#([0-9a-f]{3,8})$/,Ee=new RegExp(`^rgb\\(${_e},${_e},${_e}\\)$`),Ae=new RegExp(`^rgb\\(${be},${be},${be}\\)$`),Te=new RegExp(`^rgba\\(${_e},${_e},${_e},${we}\\)$`),Me=new RegExp(`^rgba\\(${be},${be},${be},${we}\\)$`),Le=new RegExp(`^hsl\\(${we},${be},${be}\\)$`),Ne=new RegExp(`^hsla\\(${we},${be},${be},${we}\\)$`),Se={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ie(){return this.rgb().formatHex()}function Oe(){return this.rgb().formatRgb()}function ke(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=xe.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Pe(e):3===n?new De(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Re(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Re(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Ee.exec(t))?new De(e[1],e[2],e[3],1):(e=Ae.exec(t))?new De(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Te.exec(t))?Re(e[1],e[2],e[3],e[4]):(e=Me.exec(t))?Re(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Le.exec(t))?Ye(e[1],e[2]/100,e[3]/100,1):(e=Ne.exec(t))?Ye(e[1],e[2]/100,e[3]/100,e[4]):Se.hasOwnProperty(t)?Pe(Se[t]):"transparent"===t?new De(NaN,NaN,NaN,0):null}function Pe(t){return new De(t>>16&255,t>>8&255,255&t,1)}function Re(t,e,n,r){return r<=0&&(t=e=n=NaN),new De(t,e,n,r)}function ze(t,e,n,r){return 1===arguments.length?((i=t)instanceof ve||(i=ke(i)),i?new De((i=i.rgb()).r,i.g,i.b,i.opacity):new De):new De(t,e,n,null==r?1:r);var i}function De(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Ce(){return`#${Be(this.r)}${Be(this.g)}${Be(this.b)}`}function je(){const t=Ue(this.opacity);return`${1===t?"rgb(":"rgba("}${$e(this.r)}, ${$e(this.g)}, ${$e(this.b)}${1===t?")":`, ${t})`}`}function Ue(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function $e(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Be(t){return((t=$e(t))<16?"0":"")+t.toString(16)}function Ye(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ge(t,e,n,r)}function qe(t){if(t instanceof Ge)return new Ge(t.h,t.s,t.l,t.opacity);if(t instanceof ve||(t=ke(t)),!t)return new Ge;if(t instanceof Ge)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,u=o-i,s=(o+i)/2;return u?(a=e===o?(n-r)/u+6*(n<r):n===o?(r-e)/u+2:(e-n)/u+4,u/=s<.5?o+i:2-o-i,a*=60):u=s>0&&s<1?0:a,new Ge(a,u,s,t.opacity)}function Ge(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Fe(t){return(t=(t||0)%360)<0?t+360:t}function Ve(t){return Math.max(0,Math.min(1,t||0))}function Xe(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Ze(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}de(ve,ke,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ie,formatHex:Ie,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return qe(this).formatHsl()},formatRgb:Oe,toString:Oe}),de(De,ze,ye(ve,{brighter(t){return t=null==t?ge:Math.pow(ge,t),new De(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?me:Math.pow(me,t),new De(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new De($e(this.r),$e(this.g),$e(this.b),Ue(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ce,formatHex:Ce,formatHex8:function(){return`#${Be(this.r)}${Be(this.g)}${Be(this.b)}${Be(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:je,toString:je})),de(Ge,(function(t,e,n,r){return 1===arguments.length?qe(t):new Ge(t,e,n,null==r?1:r)}),ye(ve,{brighter(t){return t=null==t?ge:Math.pow(ge,t),new Ge(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?me:Math.pow(me,t),new Ge(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new De(Xe(t>=240?t-240:t+120,i,r),Xe(t,i,r),Xe(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Ge(Fe(this.h),Ve(this.s),Ve(this.l),Ue(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ue(this.opacity);return`${1===t?"hsl(":"hsla("}${Fe(this.h)}, ${100*Ve(this.s)}%, ${100*Ve(this.l)}%${1===t?")":`, ${t})`}`}}));const He=t=>()=>t;function Qe(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):He(isNaN(t)?e:t)}const Ke=function t(e){var n=function(t){return 1==(t=+t)?Qe:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):He(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=ze(t)).r,(e=ze(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=Qe(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function We(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),u=new Array(i);for(n=0;n<i;++n)r=ze(e[n]),o[n]=r.r||0,a[n]=r.g||0,u[n]=r.b||0;return o=t(o),a=t(a),u=t(u),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=u(t),r+""}}}We((function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,u=r<e-1?t[r+2]:2*o-i;return Ze((n-r/e)*e,a,i,o,u)}})),We((function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],u=t[(r+2)%e];return Ze((n-r/e)*e,i,o,a,u)}}));var Je=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,tn=new RegExp(Je.source,"g");function en(t,e){var n,r,i,o=Je.lastIndex=tn.lastIndex=0,a=-1,u=[],s=[];for(t+="",e+="";(n=Je.exec(t))&&(r=tn.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),u[a]?u[a]+=i:u[++a]=i),(n=n[0])===(r=r[0])?u[a]?u[a]+=r:u[++a]=r:(u[++a]=null,s.push({i:a,x:re(n,r)})),o=tn.lastIndex;return o<e.length&&(i=e.slice(o),u[a]?u[a]+=i:u[++a]=i),u.length<2?s[0]?function(t){return function(e){return t(e)+""}}(s[0].x):function(t){return function(){return t}}(e):(e=s.length,function(t){for(var n,r=0;r<e;++r)u[(n=s[r]).i]=n.x(t);return u.join("")})}function nn(t,e){var n;return("number"==typeof e?re:e instanceof ke?Ke:(n=ke(e))?(e=n,Ke):en)(t,e)}function rn(t){return function(){this.removeAttribute(t)}}function on(t){return function(){this.removeAttributeNS(t.space,t.local)}}function an(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=e(r=a,n)}}function un(t,e,n){var r,i,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=e(r=a,n)}}function sn(t,e,n){var r,i,o;return function(){var a,u,s=n(this);if(null!=s)return(a=this.getAttribute(t))===(u=s+"")?null:a===r&&u===i?o:(i=u,o=e(r=a,s));this.removeAttribute(t)}}function fn(t,e,n){var r,i,o;return function(){var a,u,s=n(this);if(null!=s)return(a=this.getAttributeNS(t.space,t.local))===(u=s+"")?null:a===r&&u===i?o:(i=u,o=e(r=a,s));this.removeAttributeNS(t.space,t.local)}}function cn(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function ln(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function hn(t,e){return function(){Jt(this,t).delay=+e.apply(this,arguments)}}function pn(t,e){return e=+e,function(){Jt(this,t).delay=e}}function dn(t,e){return function(){te(this,t).duration=+e.apply(this,arguments)}}function yn(t,e){return e=+e,function(){te(this,t).duration=e}}var vn=pt.prototype.constructor;function mn(t){return function(){this.style.removeProperty(t)}}var gn=0;function _n(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function wn(){return++gn}var bn=pt.prototype;_n.prototype=function(t){return pt().transition(t)}.prototype={constructor:_n,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=r(t));for(var i=this._groups,o=i.length,a=new Array(o),u=0;u<o;++u)for(var s,f,c=i[u],l=c.length,h=a[u]=new Array(l),p=0;p<l;++p)(s=c[p])&&(f=t.call(s,s.__data__,p,c))&&("__data__"in s&&(f.__data__=s.__data__),h[p]=f,Wt(h[p],e,n,p,h,ee(s,n)));return new _n(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=o(t));for(var r=this._groups,i=r.length,a=[],u=[],s=0;s<i;++s)for(var f,c=r[s],l=c.length,h=0;h<l;++h)if(f=c[h]){for(var p,d=t.call(f,f.__data__,h,c),y=ee(f,n),v=0,m=d.length;v<m;++v)(p=d[v])&&Wt(p,e,n,v,d,y);a.push(d),u.push(f)}return new _n(a,u,e,n)},selectChild:bn.selectChild,selectChildren:bn.selectChildren,filter:function(t){"function"!=typeof t&&(t=a(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,u=e[i],s=u.length,f=r[i]=[],c=0;c<s;++c)(o=u[c])&&t.call(o,o.__data__,c,u)&&f.push(o);return new _n(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var s,f=e[u],c=n[u],l=f.length,h=a[u]=new Array(l),p=0;p<l;++p)(s=f[p]||c[p])&&(h[p]=s);for(;u<r;++u)a[u]=e[u];return new _n(a,this._parents,this._name,this._id)},selection:function(){return new vn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=wn(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],s=u.length,f=0;f<s;++f)if(a=u[f]){var c=ee(a,e);Wt(a,t,n,f,u,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new _n(r,this._parents,t,n)},call:bn.call,nodes:bn.nodes,node:bn.node,size:bn.size,empty:bn.empty,each:bn.each,on:function(t,e){var n=this._id;return arguments.length<2?ee(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Jt:te;return function(){var a=o(this,t),u=a.on;u!==r&&(i=(r=u).copy()).on(e,n),a.on=i}}(n,t,e))},attr:function(t,e){var n=b(t),r="transform"===n?ce:nn;return this.attrTween(t,"function"==typeof e?(n.local?fn:sn)(n,r,pe(this,"attr."+t,e)):null==e?(n.local?on:rn)(n):(n.local?un:an)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=b(t);return this.tween(n,(r.local?cn:ln)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?fe:nn;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=k(this,t),a=(this.style.removeProperty(t),k(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}(t,r)).on("end.style."+t,mn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var a=k(this,t),u=n(this),s=u+"";return null==u&&(this.style.removeProperty(t),s=u=k(this,t)),a===s?null:a===r&&s===i?o:(i=s,o=e(r=a,u))}}(t,r,pe(this,"style."+t,e))).each(function(t,e){var n,r,i,o,a="style."+e,u="end."+a;return function(){var s=te(this,t),f=s.on,c=null==s.value[a]?o||(o=mn(e)):void 0;f===n&&i===c||(r=(n=f).copy()).on(u,i=c),s.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var a=k(this,t);return a===o?null:a===r?i:i=e(r=a,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,o,n)),r}return o._value=e,o}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(pe(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=ee(this.node(),n).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?le:he)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?hn:pn)(e,t)):ee(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?dn:yn)(e,t)):ee(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){te(this,t).ease=e}}(e,t)):ee(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;te(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,a){var u={value:a},s={value:function(){0==--i&&o()}};n.each((function(){var n=te(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(u),e._.interrupt.push(u),e._.end.push(s)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:bn[Symbol.iterator]};var xn={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function En(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}pt.prototype.interrupt=function(t){return this.each((function(){ne(this,t)}))},pt.prototype.transition=function(t){var e,n;t instanceof _n?(e=t._id,t=t._name):(e=wn(),(n=xn).time=Ct(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],s=u.length,f=0;f<s;++f)(a=u[f])&&Wt(a,t,e,f,u,n||En(a,e));return new _n(r,this._parents,t,e)};const An=t=>()=>t;function Tn(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Mn(t,e,n){this.k=t,this.x=e,this.y=n}Mn.prototype={constructor:Mn,scale:function(t){return 1===t?this:new Mn(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new Mn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ln=new Mn(1,0,0);function Nn(t){t.stopImmediatePropagation()}function Sn(t){t.preventDefault(),t.stopImmediatePropagation()}function In(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function On(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function kn(){return this.__zoom||Ln}function Pn(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Rn(){return navigator.maxTouchPoints||"ontouchstart"in this}function zn(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}Mn.prototype;class Dn{constructor(t,e=0,n=0,r=0,i=void 0){this.opts=i||{},this.canvas=t,this.w=this.canvas.offsetWidth,this.h=this.canvas.offsetHeight,this.canvas.width=this.w,this.canvas.height=this.h;const o=this.canvas.getContext("2d");if(!o)throw"Impossible to create canvas 2D context";if(this.ctx=o,this.view={x:e,y:n,z:r},this.backgroundColor=i.backgroundColor||"white",this.onZoomStartFun=i.onZoomStartFun,this.onZoomEndFun=i.onZoomEndFun,this.onZoomFun=i.onZoomFun,this.extGeo={xMin:NaN,xMax:NaN,yMin:NaN,yMax:NaN},this.updateExtentGeo(),!i.disableZoom){let t=Ln;(function(){var t,e,n,r=In,i=On,o=zn,a=Pn,u=Rn,s=[0,1/0],f=[[-1/0,-1/0],[1/0,1/0]],c=250,l=At,h=wt("start","zoom","end"),p=500,d=150,y=0,v=10;function m(t){t.property("__zoom",kn).on("wheel.zoom",A,{passive:!1}).on("mousedown.zoom",T).on("dblclick.zoom",M).filter(u).on("touchstart.zoom",L).on("touchmove.zoom",N).on("touchend.zoom touchcancel.zoom",S).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(t,e){return(e=Math.max(s[0],Math.min(s[1],e)))===t.k?t:new Mn(e,t.x,t.y)}function _(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new Mn(t.k,r,i)}function w(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function b(t,e,n,r){t.on("start.zoom",(function(){x(this,arguments).event(r).start()})).on("interrupt.zoom end.zoom",(function(){x(this,arguments).event(r).end()})).tween("zoom",(function(){var t=this,o=arguments,a=x(t,o).event(r),u=i.apply(t,o),s=null==n?w(u):"function"==typeof n?n.apply(t,o):n,f=Math.max(u[1][0]-u[0][0],u[1][1]-u[0][1]),c=t.__zoom,h="function"==typeof e?e.apply(t,o):e,p=l(c.invert(s).concat(f/c.k),h.invert(s).concat(f/h.k));return function(t){if(1===t)t=h;else{var e=p(t),n=f/e[2];t=new Mn(n,s[0]-e[0]*n,s[1]-e[1]*n)}a.zoom(null,t)}}))}function x(t,e,n){return!n&&t.__zooming||new E(t,e)}function E(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=i.apply(t,e),this.taps=0}function A(t,...e){if(r.apply(this,arguments)){var n=x(this,e).event(t),i=this.__zoom,u=Math.max(s[0],Math.min(s[1],i.k*Math.pow(2,a.apply(this,arguments)))),c=Tt(t);if(n.wheel)n.mouse[0][0]===c[0]&&n.mouse[0][1]===c[1]||(n.mouse[1]=i.invert(n.mouse[0]=c)),clearTimeout(n.wheel);else{if(i.k===u)return;n.mouse=[c,i.invert(c)],ne(this),n.start()}Sn(t),n.wheel=setTimeout((function(){n.wheel=null,n.end()}),d),n.zoom("mouse",o(_(g(i,u),n.mouse[0],n.mouse[1]),n.extent,f))}}function T(t,...e){if(!n&&r.apply(this,arguments)){var i=t.currentTarget,a=x(this,e,!0).event(t),u=dt(t.view).on("mousemove.zoom",(function(t){if(Sn(t),!a.moved){var e=t.clientX-c,n=t.clientY-l;a.moved=e*e+n*n>y}a.event(t).zoom("mouse",o(_(a.that.__zoom,a.mouse[0]=Tt(t,i),a.mouse[1]),a.extent,f))}),!0).on("mouseup.zoom",(function(t){u.on("mousemove.zoom mouseup.zoom",null),function(t,e){var n=t.document.documentElement,r=dt(t).on("dragstart.drag",null);e&&(r.on("click.drag",xt,bt),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}(t.view,a.moved),Sn(t),a.event(t).end()}),!0),s=Tt(t,i),c=t.clientX,l=t.clientY;!function(t){var e=t.document.documentElement,n=dt(t).on("dragstart.drag",xt,bt);"onselectstart"in e?n.on("selectstart.drag",xt,bt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}(t.view),Nn(t),a.mouse=[s,this.__zoom.invert(s)],ne(this),a.start()}}function M(t,...e){if(r.apply(this,arguments)){var n=this.__zoom,a=Tt(t.changedTouches?t.changedTouches[0]:t,this),u=n.invert(a),s=n.k*(t.shiftKey?.5:2),l=o(_(g(n,s),a,u),i.apply(this,e),f);Sn(t),c>0?dt(this).transition().duration(c).call(b,l,a,t):dt(this).call(m.transform,l,a,t)}}function L(n,...i){if(r.apply(this,arguments)){var o,a,u,s,f=n.touches,c=f.length,l=x(this,i,n.changedTouches.length===c).event(n);for(Nn(n),a=0;a<c;++a)s=[s=Tt(u=f[a],this),this.__zoom.invert(s),u.identifier],l.touch0?l.touch1||l.touch0[2]===s[2]||(l.touch1=s,l.taps=0):(l.touch0=s,o=!0,l.taps=1+!!t);t&&(t=clearTimeout(t)),o&&(l.taps<2&&(e=s[0],t=setTimeout((function(){t=null}),p)),ne(this),l.start())}}function N(t,...e){if(this.__zooming){var n,r,i,a,u=x(this,e).event(t),s=t.changedTouches,c=s.length;for(Sn(t),n=0;n<c;++n)i=Tt(r=s[n],this),u.touch0&&u.touch0[2]===r.identifier?u.touch0[0]=i:u.touch1&&u.touch1[2]===r.identifier&&(u.touch1[0]=i);if(r=u.that.__zoom,u.touch1){var l=u.touch0[0],h=u.touch0[1],p=u.touch1[0],d=u.touch1[1],y=(y=p[0]-l[0])*y+(y=p[1]-l[1])*y,v=(v=d[0]-h[0])*v+(v=d[1]-h[1])*v;r=g(r,Math.sqrt(y/v)),i=[(l[0]+p[0])/2,(l[1]+p[1])/2],a=[(h[0]+d[0])/2,(h[1]+d[1])/2]}else{if(!u.touch0)return;i=u.touch0[0],a=u.touch0[1]}u.zoom("touch",o(_(r,i,a),u.extent,f))}}function S(t,...r){if(this.__zooming){var i,o,a=x(this,r).event(t),u=t.changedTouches,s=u.length;for(Nn(t),n&&clearTimeout(n),n=setTimeout((function(){n=null}),p),i=0;i<s;++i)o=u[i],a.touch0&&a.touch0[2]===o.identifier?delete a.touch0:a.touch1&&a.touch1[2]===o.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps&&(o=Tt(o,this),Math.hypot(e[0]-o[0],e[1]-o[1])<v)){var f=dt(this).on("dblclick.zoom");f&&f.apply(this,arguments)}}}return m.transform=function(t,e,n,r){var i=t.selection?t.selection():t;i.property("__zoom",kn),t!==i?b(t,e,n,r):i.interrupt().each((function(){x(this,arguments).event(r).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},m.scaleBy=function(t,e,n,r){m.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),n,r)},m.scaleTo=function(t,e,n,r){m.transform(t,(function(){var t=i.apply(this,arguments),r=this.__zoom,a=null==n?w(t):"function"==typeof n?n.apply(this,arguments):n,u=r.invert(a),s="function"==typeof e?e.apply(this,arguments):e;return o(_(g(r,s),a,u),t,f)}),n,r)},m.translateBy=function(t,e,n,r){m.transform(t,(function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),i.apply(this,arguments),f)}),null,r)},m.translateTo=function(t,e,n,r,a){m.transform(t,(function(){var t=i.apply(this,arguments),a=this.__zoom,u=null==r?w(t):"function"==typeof r?r.apply(this,arguments):r;return o(Ln.translate(u[0],u[1]).scale(a.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,f)}),r,a)},E.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=dt(this.that).datum();h.call(t,this.that,new Tn(t,{sourceEvent:this.sourceEvent,target:m,type:t,transform:this.that.__zoom,dispatch:h}),e)}},m.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:An(+t),m):a},m.filter=function(t){return arguments.length?(r="function"==typeof t?t:An(!!t),m):r},m.touchable=function(t){return arguments.length?(u="function"==typeof t?t:An(!!t),m):u},m.extent=function(t){return arguments.length?(i="function"==typeof t?t:An([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),m):i},m.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],m):[s[0],s[1]]},m.translateExtent=function(t){return arguments.length?(f[0][0]=+t[0][0],f[1][0]=+t[1][0],f[0][1]=+t[0][1],f[1][1]=+t[1][1],m):[[f[0][0],f[0][1]],[f[1][0],f[1][1]]]},m.constrain=function(t){return arguments.length?(o=t,m):o},m.duration=function(t){return arguments.length?(c=+t,m):c},m.interpolate=function(t){return arguments.length?(l=t,m):l},m.on=function(){var t=h.on.apply(h,arguments);return t===h?m:t},m.clickDistance=function(t){return arguments.length?(y=(t=+t)*t,m):Math.sqrt(y)},m.tapDistance=function(t){return arguments.length?(v=+t,m):v},m})().wheelDelta((t=>-t.deltaY*(1===t.deltaMode?.07:t.deltaMode?1:.004))).on("zoom",(e=>{const n=e.transform,r=t.k/n.k;if(1==r){const e=t.x-n.x,r=t.y-n.y;this.pan(e*this.view.z,-r*this.view.z)}else{const t=e.sourceEvent;if(t instanceof WheelEvent)this.zoom(r,this.pixToGeoX(e.sourceEvent.offsetX),this.pixToGeoY(e.sourceEvent.offsetY));else if(t instanceof TouchEvent){let e=0,n=0;for(let r of t.targetTouches)e+=r.clientX,n+=r.clientY;e/=t.targetTouches.length,n/=t.targetTouches.length,this.zoom(r,this.pixToGeoX(e),this.pixToGeoY(n))}}t=n,this.onZoomFun&&this.onZoomFun(e)})).on("start",(t=>{this.canvasSave.c=document.createElement("canvas"),this.canvasSave.c.setAttribute("width",""+this.w),this.canvasSave.c.setAttribute("height",""+this.h),this.canvasSave.c.getContext("2d")?.drawImage(this.canvas,0,0),this.canvasSave.dx=0,this.canvasSave.dy=0,this.canvasSave.f=1,this.onZoomStartFun&&this.onZoomStartFun(t)})).on("end",(t=>{this.redraw(),this.canvasSave={c:null,dx:0,dy:0,f:1},this.onZoomEndFun&&this.onZoomEndFun(t)}))(dt(this.canvas))}this.zoomExtent=i.zoomExtent||[0,1/0],this.canvasSave={c:null,dx:0,dy:0,f:1}}getView(){return this.view}setZoomExtent(t){this.zoomExtent=t}getZoomExtent(){return this.zoomExtent}initCanvasTransform(){this.ctx.setTransform(1,0,0,1,0,0)}setCanvasTransform(){const t=1/this.view.z,e=-this.view.x/this.view.z+.5*this.w,n=this.view.y/this.view.z+.5*this.h;this.ctx.setTransform(t,0,0,-t,e,n)}getWebGLTransform(){const t=2/(this.w*this.view.z),e=2/(this.h*this.view.z);return[t,0,0,0,e,0,-t*this.view.x,-e*this.view.y,1]}redraw(){throw new Error("Method redraw not implemented.")}clear(t="white"){this.opts.transparentBackground?this.ctx.clearRect(0,0,this.w,this.h):(this.ctx&&(this.ctx.fillStyle=t),this.ctx.fillRect(0,0,this.w,this.h))}pan(t=0,e=0){this.view.x+=t,this.view.y+=e,this.updateExtentGeo(),this.canvasSave.c&&(this.canvasSave.dx-=t/this.view.z,this.canvasSave.dy+=e/this.view.z,this.clear(this.backgroundColor),this.ctx.drawImage(this.canvasSave.c,this.canvasSave.dx,this.canvasSave.dy))}zoom(t=1,e=this.view.x,n=this.view.y){if(this.zoomExtent[0]==this.view.z&&t<=1)return;if(this.zoomExtent[1]==this.view.z&&t>=1)return;const r=t*this.view.z;r<this.zoomExtent[0]&&(t=this.zoomExtent[0]/this.view.z),r>this.zoomExtent[1]&&(t=this.zoomExtent[1]/this.view.z),this.view.z*=t;const i=(e-this.view.x)*(1-t);this.view.x+=i;const o=(n-this.view.y)*(1-t);this.view.y+=o,this.updateExtentGeo(),this.canvasSave.c&&(this.clear(this.backgroundColor),this.canvasSave.f/=t,this.canvasSave.dx=this.geoToPixX(e)*(1-this.canvasSave.f),this.canvasSave.dy=this.geoToPixY(n)*(1-this.canvasSave.f),this.clear(this.backgroundColor),this.ctx.drawImage(this.canvasSave.c,this.canvasSave.dx,this.canvasSave.dy,this.canvasSave.f*this.canvasSave.c.width,this.canvasSave.f*this.canvasSave.c.height))}updateExtentGeo(t=20){return this.extGeo={xMin:this.pixToGeoX(-t),xMax:this.pixToGeoX(this.w+t),yMin:this.pixToGeoY(this.h+t),yMax:this.pixToGeoY(-t)},this.extGeo}toDraw(t){return!(t.x<this.extGeo.xMin||t.x>this.extGeo.xMax||t.y<this.extGeo.yMin||t.y>this.extGeo.yMax)}geoToPixX(t){return(t-this.view.x)/this.view.z+.5*this.w}geoToPixY(t){return-(t-this.view.y)/this.view.z+.5*this.h}pixToGeoX(t){return(t-.5*this.w)*this.view.z+this.view.x}pixToGeoY(t){return-(t-.5*this.h)*this.view.z+this.view.y}setViewFromURL(){const t=Dn.getParameterByName("x"),e=Dn.getParameterByName("y"),n=Dn.getParameterByName("z");null==t||null==t||isNaN(+t)||(this.view.x=+t),null==e||null==e||isNaN(+e)||(this.view.y=+e),null==n||null==n||isNaN(+n)||(this.view.z=+n)}static getParameterByName(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return e?decodeURIComponent(e[1].replace(/\+/g," ")):null}}class Cn{constructor(t,e,n,r={}){this.map=t,this.url=e,this.resolution=n,this.mixedResolution=r.mixedResolution,this.preprocess=r.preprocess||void 0,this.cellsViewCache=[]}getData(t=void 0){throw new Error("Method getData not implemented.")}updateViewCache(t){throw new Error("Method updateViewCache not implemented.")}getCellFromPosition(t,e){if(this.mixedResolution){for(const n of e){const e=+this.mixedResolution(n);if(!(t.x<n.x||n.x+e<t.x||t.y<n.y||n.y+e<t.y))return n}return}const n=this.getResolution();for(const r of e)if(!(t.x<r.x||r.x+n<t.x||t.y<r.y||r.y+n<t.y))return r}getResolution(){return this.resolution}getViewCache(){return this.cellsViewCache}getDataset(t,e){return this}}function jn(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function Un(t,e){return fetch(t,e).then(jn)}var $n={},Bn={};function Yn(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function qn(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function Gn(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Fn(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,u=0,s=o<=0,f=!1;function c(){if(s)return Bn;if(f)return f=!1,$n;var e,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=o?s=!0:10===(r=t.charCodeAt(a++))?f=!0:13===r&&(f=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(e=a++)))f=!0;else if(13===r)f=!0,10===t.charCodeAt(a)&&++a;else if(r!==n)continue;return t.slice(i,e)}return s=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=c())!==Bn;){for(var l=[];r!==$n&&r!==Bn;)l.push(r),r=c();e&&null==(l=e(l,u++))||i.push(l)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?(i=(n=t).getUTCHours(),o=n.getUTCMinutes(),a=n.getUTCSeconds(),u=n.getUTCMilliseconds(),isNaN(n)?"Invalid Date":((r=n.getUTCFullYear())<0?"-"+Gn(-r,6):r>9999?"+"+Gn(r,6):Gn(r,4))+"-"+Gn(n.getUTCMonth()+1,2)+"-"+Gn(n.getUTCDate(),2)+(u?"T"+Gn(i,2)+":"+Gn(o,2)+":"+Gn(a,2)+"."+Gn(u,3)+"Z":a?"T"+Gn(i,2)+":"+Gn(o,2)+":"+Gn(a,2)+"Z":o||i?"T"+Gn(i,2)+":"+Gn(o,2)+"Z":"")):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t;var n,r,i,o,a,u}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=Yn(t);return function(r,i){return e(n(r),i,t)}}(t,e):Yn(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=qn(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=qn(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}var Vn=Fn(","),Xn=Vn.parse,Zn=(Vn.parseRows,Vn.format,Vn.formatBody,Vn.formatRows,Vn.formatRow,Vn.formatValue,Fn("\t")),Hn=Zn.parse;function Qn(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Kn(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=void 0),function(t,e){return fetch(t,e).then(Qn)}(e,n).then((function(e){return t(e,r)}))}}Zn.parseRows,Zn.format,Zn.formatBody,Zn.formatRows,Zn.formatRow,Zn.formatValue,Kn(Xn),Kn(Hn),function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var o;if(null!=r)o=r,r=null;else do{r=2*e()-1,o=2*e()-1,i=r*r+o*o}while(!i||i>1);return t+n*o*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(Math.random);const Wn=t=>t;function Jn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}Wn.invert=Wn;var tr,er=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function nr(t){if(!(e=er.exec(t)))throw new Error("invalid format: "+t);var e;return new rr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function rr(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function ir(t,e){var n=Jn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}nr.prototype=rr.prototype,rr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const or={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ir(100*t,e),r:ir,s:function(t,e){var n=Jn(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(tr=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Jn(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ar(t){return t}var ur,sr=Array.prototype.map,fr=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function cr(t){return ur=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?ar:(e=sr.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,u=e[0],s=0;i>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),o.push(t.substring(i-=u,i+u)),!((s+=u+1)>r));)u=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",u=void 0===t.numerals?ar:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(sr.call(t.numerals,String)),s=void 0===t.percent?"%":t.percent+"",f=void 0===t.minus?"−":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function l(t){var e=(t=nr(t)).fill,n=t.align,l=t.sign,h=t.symbol,p=t.zero,d=t.width,y=t.comma,v=t.precision,m=t.trim,g=t.type;"n"===g?(y=!0,g="g"):or[g]||(void 0===v&&(v=12),m=!0,g="g"),(p||"0"===e&&"="===n)&&(p=!0,e="0",n="=");var _="$"===h?i:"#"===h&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",w="$"===h?o:/[%p]/.test(g)?s:"",b=or[g],x=/[defgprs%]/.test(g);function E(t){var i,o,s,h=_,E=w;if("c"===g)E=b(t)+E,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:b(Math.abs(t),v),m&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0==+t&&"+"!==l&&(A=!1),h=(A?"("===l?l:f:"-"===l||"("===l?"":l)+h,E=("s"===g?fr[8+tr/3]:"")+E+(A&&"("===l?")":""),x)for(i=-1,o=t.length;++i<o;)if(48>(s=t.charCodeAt(i))||s>57){E=(46===s?a+t.slice(i+1):t.slice(i))+E,t=t.slice(0,i);break}}y&&!p&&(t=r(t,1/0));var T=h.length+t.length+E.length,M=T<d?new Array(d-T+1).join(e):"";switch(y&&p&&(t=r(M+t,M.length?d-E.length:1/0),M=""),n){case"<":t=h+t+E+M;break;case"=":t=h+M+t+E;break;case"^":t=M.slice(0,T=M.length>>1)+h+t+E+M.slice(T);break;default:t=M+h+t+E}return u(t)}return v=void 0===v?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),E.toString=function(){return t+""},E}return{format:l,formatPrefix:function(t,e){var n,r=l(((t=nr(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor((n=e,((n=Jn(Math.abs(n)))?n[1]:NaN)/3)))),o=Math.pow(10,-i),a=fr[8+i/3];return function(t){return r(o*t)+a}}}}(t),ur.format,ur.formatPrefix,ur}cr({thousands:",",grouping:[3],currency:["$",""]}),Dn.getParameterByName,cr({decimal:".",thousands:" ",grouping:[3],currency:["","€"]});const lr=["BOOLEAN","INT32","INT64","INT96","FLOAT","DOUBLE","BYTE_ARRAY","FIXED_LEN_BYTE_ARRAY"],hr=["PLAIN",void 0,"PLAIN_DICTIONARY","RLE","BIT_PACKED","DELTA_BINARY_PACKED","DELTA_LENGTH_BYTE_ARRAY","DELTA_BYTE_ARRAY","RLE_DICTIONARY","BYTE_STREAM_SPLIT"],pr=["REQUIRED","OPTIONAL","REPEATED"],dr=["UTF8","MAP","MAP_KEY_VALUE","LIST","ENUM","DECIMAL","DATE","TIME_MILLIS","TIME_MICROS","TIMESTAMP_MILLIS","TIMESTAMP_MICROS","UINT_8","UINT_16","UINT_32","UINT_64","INT_8","INT_16","INT_32","INT_64","JSON","BSON","INTERVAL"],yr=["UNCOMPRESSED","SNAPPY","GZIP","LZO","BROTLI","LZ4","ZSTD","LZ4_RAW"],vr=["DATA_PAGE","INDEX_PAGE","DICTIONARY_PAGE","DATA_PAGE_V2"],mr=864e5;function gr(t,e,n=!0){const r=e.converted_type;if("DECIMAL"===r){const n=e.scale||0,r=Math.pow(10,-n),i=new Array(t.length);for(let e=0;e<i.length;e++)t[0]instanceof Uint8Array?i[e]=_r(t[e])*r:i[e]=Number(t[e])*r;return i}if(void 0===r&&"INT96"===e.type)return Array.from(t).map(wr);if("DATE"===r){const e=new Array(t.length);for(let n=0;n<e.length;n++)e[n]=new Date(t[n]*mr);return e}if("TIMESTAMP_MILLIS"===r){const e=new Array(t.length);for(let n=0;n<e.length;n++)e[n]=new Date(Number(t[n]));return e}if("TIMESTAMP_MICROS"===r){const e=new Array(t.length);for(let n=0;n<e.length;n++)e[n]=new Date(Number(t[n]/1000n));return e}if("JSON"===r){const e=new TextDecoder;return t.map((t=>JSON.parse(e.decode(t))))}if("BSON"===r)throw new Error("parquet bson not supported");if("INTERVAL"===r)throw new Error("parquet interval not supported");if("UTF8"===r||n&&"BYTE_ARRAY"===e.type){const e=new TextDecoder,n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=t[r]&&e.decode(t[r]);return n}if("UINT_64"===r){const e=new BigUint64Array(t.length);for(let n=0;n<e.length;n++)e[n]=BigInt(t[n]);return e}const i=e.logical_type?.type;if("FLOAT16"===i)return Array.from(t).map(br);if("TIMESTAMP"===i){const e=new Array(t.length);for(let n=0;n<e.length;n++)e[n]=new Date(Number(t[n]));return e}return t}function _r(t){let e=0;for(const n of t)e=e<<8|n;return e}function wr(t){const e=Number((t>>64n)-2440588n),n=Number((0xffffffffffffffffn&t)/1000000n);return new Date(e*mr+n)}function br(t){if(!t)return;const e=t[1]<<8|t[0],n=e>>15?-1:1,r=e>>10&31,i=1023&e;return 0===r?n*Math.pow(2,-14)*(i/1024):31===r?i?NaN:n*(1/0):n*Math.pow(2,r-15)*(1+i/1024)}function xr(t,e){let n=e;if(t){e instanceof Uint8Array&&!(t instanceof Uint8Array)&&(n=new t.constructor(e.length));for(let r=0;r<e.length;r++)n[r]=t[e[r]]}return n}const Er={STOP:0,TRUE:1,FALSE:2,BYTE:3,I16:4,I32:5,I64:6,DOUBLE:7,BINARY:8,LIST:9,SET:10,MAP:11,STRUCT:12,UUID:13};function Ar(t){let e=0;const n={};for(;t.offset<t.view.byteLength;){const[r,i,o]=Ir(t,e);if(e=o,r===Er.STOP)break;n[`field_${i}`]=Tr(t,r)}return n}function Tr(t,e){switch(e){case Er.TRUE:return!0;case Er.FALSE:return!1;case Er.BYTE:return t.view.getInt8(t.offset++);case Er.I16:case Er.I32:return Lr(t);case Er.I64:return Nr(t);case Er.DOUBLE:{const e=t.view.getFloat64(t.offset,!0);return t.offset+=8,e}case Er.BINARY:{const e=Mr(t),n=new Uint8Array(t.view.buffer,t.view.byteOffset+t.offset,e);return t.offset+=e,n}case Er.LIST:{const[e,n]=function(t){const e=t.view.getUint8(t.offset++),n=e>>4,r=Sr(e);return 15===n?[r,Mr(t)]:[r,n]}(t),r=new Array(n);for(let i=0;i<n;i++)r[i]=Tr(t,e);return r}case Er.STRUCT:{const e={};let n=0;for(;;){let r,i;if([r,i,n]=Ir(t,n),r===Er.STOP)break;e[`field_${i}`]=Tr(t,r)}return e}case Er.UUID:{let e="";for(let n=0;n<16;n++)e+=t.view.getUint8(t.offset++).toString(16).padStart(2,"0");return e}default:throw new Error(`thrift unhandled type: ${e}`)}}function Mr(t){let e=0,n=0;for(;;){const r=t.view.getUint8(t.offset++);if(e|=(127&r)<<n,!(128&r))return e;n+=7}}function Lr(t){const e=Mr(t);return e>>>1^-(1&e)}function Nr(t){const e=function(t){let e=0n,n=0n;for(;;){const r=t.view.getUint8(t.offset++);if(e|=BigInt(127&r)<<n,!(128&r))return e;n+=7n}}(t);return e>>BigInt(1)^-(e&BigInt(1))}function Sr(t){return 15&t}function Ir(t,e){const n=t.view.getUint8(t.offset++);if((15&n)===Er.STOP)return[0,0,e];const r=n>>4;let i;return i=0===r?Lr(t):e+r,[Sr(n),i,i]}function Or(t){if(!t)throw new Error("parquet file is required");const e=new DataView(t);if(e.byteLength<8)throw new Error("parquet file is too short");if(827474256!==e.getUint32(e.byteLength-4,!0))throw new Error("parquet file invalid (footer != PAR1)");const n=e.byteLength-8,r=e.getUint32(n,!0);if(r>e.byteLength-8)throw new Error(`parquet metadata length ${r} exceeds available buffer ${e.byteLength-8}`);const i=Ar({view:e,offset:n-r}),o=new TextDecoder;function a(t){return t&&o.decode(t)}const u=i.field_1,s=i.field_2.map((t=>({type:lr[t.field_1],type_length:t.field_2,repetition_type:pr[t.field_3],name:a(t.field_4),num_children:t.field_5,converted_type:dr[t.field_6],scale:t.field_7,precision:t.field_8,field_id:t.field_9,logical_type:kr(t.field_10)}))),f=s.filter((t=>t.type)),c=i.field_3,l=i.field_4.map((t=>({columns:t.field_1.map(((t,e)=>({file_path:a(t.field_1),file_offset:t.field_2,meta_data:t.field_3&&{type:lr[t.field_3.field_1],encodings:t.field_3.field_2?.map((t=>hr[t])),path_in_schema:t.field_3.field_3.map(a),codec:yr[t.field_3.field_4],num_values:t.field_3.field_5,total_uncompressed_size:t.field_3.field_6,total_compressed_size:t.field_3.field_7,key_value_metadata:t.field_3.field_8,data_page_offset:t.field_3.field_9,index_page_offset:t.field_3.field_10,dictionary_page_offset:t.field_3.field_11,statistics:Pr(t.field_3.field_12,f[e]),encoding_stats:t.field_3.field_13?.map((t=>({page_type:vr[t.field_1],encoding:hr[t.field_2],count:t.field_3}))),bloom_filter_offset:t.field_3.field_14,bloom_filter_length:t.field_3.field_15,size_statistics:t.field_3.field_16&&{unencoded_byte_array_data_bytes:t.field_3.field_16.field_1,repetition_level_histogram:t.field_3.field_16.field_2,definition_level_histogram:t.field_3.field_16.field_3}},offset_index_offset:t.field_4,offset_index_length:t.field_5,column_index_offset:t.field_6,column_index_length:t.field_7,crypto_metadata:t.field_7,encrypted_column_metadata:t.field_8}))),total_byte_size:t.field_2,num_rows:t.field_3,sorting_columns:t.field_4?.map((t=>({column_idx:t.field_1,descending:t.field_2,nulls_first:t.field_3}))),file_offset:t.field_5,total_compressed_size:t.field_6,ordinal:t.field_7}))),h=i.field_5?.map((t=>({key:a(t.field_1),value:a(t.field_2)})));return{version:u,schema:s,num_rows:c,row_groups:l,key_value_metadata:h,created_by:a(i.field_6),metadata_length:r}}function kr(t){return t?.field_1?{type:"STRING"}:t?.field_2?{type:"MAP"}:t?.field_3?{type:"LIST"}:t?.field_4?{type:"ENUM"}:t?.field_5?{type:"DECIMAL",scale:t.field_5.field_1,precision:t.field_5.field_2}:t?.field_6?{type:"DATE"}:t?.field_7?{type:"TIME",isAdjustedToUTC:t.field_7.field_1,unit:t.field_7.field_2}:t?.field_8?{type:"TIMESTAMP",isAdjustedToUTC:t.field_8.field_1,unit:t.field_8.field_2}:t?.field_10?{type:"INTEGER",bitWidth:t.field_10.field_1,isSigned:t.field_10.field_2}:t?.field_11?{type:"NULL"}:t?.field_12?{type:"JSON"}:t?.field_13?{type:"BSON"}:t?.field_14?{type:"UUID"}:t?.field_15?{type:"FLOAT16"}:t}function Pr(t,e){const{type:n,logical_type:r}=e;function i(t){return void 0===t?t:"BOOLEAN"===n?1===t[0]:"BYTE_ARRAY"===n?(new TextDecoder).decode(t):"INT32"===n?new DataView(t.buffer,t.byteOffset,t.byteLength).getInt32(0,!0):"INT64"===n?new DataView(t.buffer,t.byteOffset,t.byteLength).getBigInt64(0,!0):"FLOAT"===n?new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat32(0,!0):"DOUBLE"===n?new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat64(0,!0):"FLOAT16"===r?.type?br(t):t}return t&&{max:i(t.field_1),min:i(t.field_2),null_count:t.field_3,distinct_count:t.field_4,max_value:i(t.field_5),min_value:i(t.field_6),is_max_value_exact:t.field_7,is_min_value_exact:t.field_8}}function Rr(t,e,n){const r=t[e],i=[];let o=1;if(r.num_children)for(;i.length<r.num_children;){const r=t[e+o],a=Rr(t,e+o,[...n,r.name]);o+=a.count,i.push(a)}return{count:o,element:r,children:i,path:n}}function zr(t,e){let n=Rr(t,0,[]);const r=[n];for(const t of e){const i=n.children.find((e=>e.element.name===t));if(!i)throw new Error(`parquet schema element not found: ${e}`);r.push(i),n=i}return r}function Dr(t){let e=0;for(const{element:n}of t)"REPEATED"===n.repetition_type&&e++;return e}function Cr(t){let e=0;for(const{element:n}of t.slice(1))"REQUIRED"!==n.repetition_type&&e++;return e}function jr(t,e,n,r,i,o){const a=t?.length||e.length;let u=0;const s=[],f=[s];let c=s,l=0,h=0,p=0;for(let o=0;o<a;o++){const a=t?.length?t[o]:i,s=e[o];for(;l&&(s<p||"REPEATED"!==r[l]);)"REQUIRED"!==r[l]&&(f.pop(),h--),"REPEATED"===r[l]&&p--,l--;for(c=f.at(-1);(l<r.length-2||"REPEATED"===r[l+1])&&(h<a||"REQUIRED"===r[l+1]);){if(l++,"REQUIRED"!==r[l]){const t=[];c.push(t),c=t,f.push(t),h++}"REPEATED"===r[l]&&p++}a===i?c.push(n[u++]):l===r.length-2?c.push(null):c.push([])}if(0===s.length){if(n.length>0&&0===o)return n;for(let t=0;t<i;t++){const t=[];c.push(t),c=t}}return s}function Ur(t,e,n=0){const r=e.path.join("."),i="OPTIONAL"===e.element.repetition_type,o=i?n+1:n;if(function(t){if(!t)return!1;if("LIST"!==t.element.converted_type)return!1;if(t.children.length>1)return!1;const e=t.children[0];return!(e.children.length>1)&&"REPEATED"===e.element.repetition_type}(e)){let a=e.children[0],u=o;1===a.children.length&&(a=a.children[0],u++),Ur(t,a,u);const s=a.path.join("."),f=t.get(s);if(!f)throw new Error("parquet list-like column missing values");return i&&$r(f,n),t.set(r,f),void t.delete(s)}if(function(t){if(!t)return!1;if("MAP"!==t.element.converted_type)return!1;if(t.children.length>1)return!1;const e=t.children[0];if(2!==e.children.length)return!1;if("REPEATED"!==e.element.repetition_type)return!1;const n=e.children.find((t=>"key"===t.element.name));if("REPEATED"===n?.element.repetition_type)return!1;const r=e.children.find((t=>"value"===t.element.name));return"REPEATED"!==r?.element.repetition_type}(e)){const a=e.children[0].element.name;Ur(t,e.children[0].children[0],o+1),Ur(t,e.children[0].children[1],o+1);const u=t.get(`${r}.${a}.key`),s=t.get(`${r}.${a}.value`);if(!u)throw new Error("parquet map-like column missing keys");if(!s)throw new Error("parquet map-like column missing values");if(u.length!==s.length)throw new Error("parquet map-like column key/value length mismatch");const f=Br(u,s,o);return i&&$r(f,n),t.delete(`${r}.${a}.key`),t.delete(`${r}.${a}.value`),void t.set(r,f)}if(e.children.length){const a={};for(const n of e.children){Ur(t,n,o);const e=t.get(n.path.join("."));if(!e)throw new Error("parquet struct-like column missing child data");a[n.element.name]=e}for(const n of e.children)t.delete(n.path.join("."));const u=Yr(a,"REQUIRED"===e.element.repetition_type?n:n+1);i&&$r(u,n),t.set(r,u)}}function $r(t,e){for(let n=0;n<t.length;n++)e?$r(t[n],e-1):t[n]=t[n][0]}function Br(t,e,n){const r=[];for(let i=0;i<t.length;i++)if(n)r.push(Br(t[i],e[i],n-1));else if(t[i]){const n={};for(let r=0;r<t[i].length;r++){const o=e[i][r];n[t[i][r]]=void 0===o?null:o}r.push(n)}else r.push(void 0);return r}function Yr(t,e){const n=Object.keys(t),r=t[n[0]]?.length,i=[];for(let o=0;o<r;o++){const r={};for(const e of n)r[e]=t[e][o];e?i.push(Yr(r,e-1)):i.push(r)}return i}function qr(t){return 32-Math.clz32(t)}function Gr(t,e,n,r){n||(t.offset+=4);let i=0;for(;i<r.length;){const n=Mr(t);if(1&n)i=Vr(t,n,e,r,i);else{const o=n>>>1;Fr(t,o,e,r,i),i+=o}}}function Fr(t,e,n,r,i){const o=n+7>>3;let a=0;if(1===o)a=t.view.getUint8(t.offset);else if(2===o)a=t.view.getUint16(t.offset,!0);else if(4===o)a=t.view.getUint32(t.offset,!0);else if(o)throw new Error(`parquet invalid rle width ${o}`);t.offset+=o;for(let t=0;t<e;t++)r[i+t]=a}function Vr(t,e,n,r,i){let o=e>>1<<3;const a=(1<<n)-1;let u=0;if(t.offset<t.view.byteLength)u=t.view.getUint8(t.offset++);else if(a)throw new Error(`parquet bitpack offset ${t.offset} out of range`);let s=8,f=0;for(;o;)f>8?(f-=8,s-=8,u>>=8):s-f<n?(u|=t.view.getUint8(t.offset)<<s,t.offset++,s+=8):(i<r.length&&(r[i++]=u>>f&a),o--,f+=n);return i}function Xr(t,e,n,r){const i=function(t,e){switch(t){case"INT32":case"FLOAT":return 4;case"INT64":case"DOUBLE":return 8;case"FIXED_LEN_BYTE_ARRAY":if(!e)throw new Error("parquet byteWidth missing type_length");return e;default:throw new Error(`parquet unsupported type: ${t}`)}}(n,r),o=new Uint8Array(e*i);for(let n=0;n<i;n++)for(let r=0;r<e;r++)o[r*i+n]=t.view.getUint8(t.offset++);if("FLOAT"===n)return new Float32Array(o.buffer);if("DOUBLE"===n)return new Float64Array(o.buffer);if("INT32"===n)return new Int32Array(o.buffer);if("INT64"===n)return new BigInt64Array(o.buffer);if("FIXED_LEN_BYTE_ARRAY"===n){const t=new Array(e);for(let n=0;n<e;n++)t[n]=o.subarray(n*i,(n+1)*i);return t}throw new Error(`parquet byte_stream_split unsupported type: ${n}`)}function Zr(t,e,n,r){if(0===n)return[];if("BOOLEAN"===e)return function(t,e){const n=new Array(e);for(let r=0;r<e;r++){const e=t.offset+(r/8|0),i=r%8,o=t.view.getUint8(e);n[r]=!!(o&1<<i)}return t.offset+=Math.ceil(e/8),n}(t,n);if("INT32"===e)return function(t,e){const n=(t.view.byteOffset+t.offset)%4?new Int32Array(Hr(t.view.buffer,t.view.byteOffset+t.offset,4*e)):new Int32Array(t.view.buffer,t.view.byteOffset+t.offset,e);return t.offset+=4*e,n}(t,n);if("INT64"===e)return function(t,e){const n=(t.view.byteOffset+t.offset)%8?new BigInt64Array(Hr(t.view.buffer,t.view.byteOffset+t.offset,8*e)):new BigInt64Array(t.view.buffer,t.view.byteOffset+t.offset,e);return t.offset+=8*e,n}(t,n);if("INT96"===e)return function(t,e){const n=new Array(e);for(let r=0;r<e;r++){const e=t.view.getBigInt64(t.offset+12*r,!0),i=t.view.getInt32(t.offset+12*r+8,!0);n[r]=BigInt(i)<<64n|e}return t.offset+=12*e,n}(t,n);if("FLOAT"===e)return function(t,e){const n=(t.view.byteOffset+t.offset)%4?new Float32Array(Hr(t.view.buffer,t.view.byteOffset+t.offset,4*e)):new Float32Array(t.view.buffer,t.view.byteOffset+t.offset,e);return t.offset+=4*e,n}(t,n);if("DOUBLE"===e)return function(t,e){const n=(t.view.byteOffset+t.offset)%8?new Float64Array(Hr(t.view.buffer,t.view.byteOffset+t.offset,8*e)):new Float64Array(t.view.buffer,t.view.byteOffset+t.offset,e);return t.offset+=8*e,n}(t,n);if("BYTE_ARRAY"===e)return function(t,e){const n=new Array(e);for(let r=0;r<e;r++){const e=t.view.getInt32(t.offset,!0);t.offset+=4,n[r]=new Uint8Array(t.view.buffer,t.view.byteOffset+t.offset,e),t.offset+=e}return n}(t,n);if("FIXED_LEN_BYTE_ARRAY"===e){if(!r)throw new Error("parquet missing fixed length");return function(t,e,n){const r=new Array(e);for(let i=0;i<e;i++)r[i]=new Uint8Array(t.view.buffer,t.view.byteOffset+t.offset,n),t.offset+=n;return r}(t,n,r)}throw new Error(`parquet unhandled type: ${e}`)}function Hr(t,e,n){const r=new ArrayBuffer(n);return new Uint8Array(r).set(new Uint8Array(t,e,n)),r}function Qr(t,e,n,{type:r}){const i=new DataView(t.buffer,t.byteOffset,t.byteLength),o={view:i,offset:0};let a;const u=function(t,e,n){if(n.length>1){const r=Dr(n);if(r){const n=new Array(e.num_values);return Gr(t,qr(r),0,n),n}}return[]}(o,e,n),{definitionLevels:s,numNulls:f}=function(t,e,n){const r=Cr(n);if(!r)return{definitionLevels:[],numNulls:0};const i=new Array(e.num_values);Gr(t,qr(r),0,i);let o=e.num_values;for(const t of i)t===r&&o--;return 0===o&&(i.length=0),{definitionLevels:i,numNulls:o}}(o,e,n),c=e.num_values-f;if("PLAIN"===e.encoding){const{type_length:t}=n[n.length-1].element;a=Zr(o,r,c,t)}else if("PLAIN_DICTIONARY"===e.encoding||"RLE_DICTIONARY"===e.encoding||"RLE"===e.encoding){const t="BOOLEAN"===r?1:i.getUint8(o.offset++);t?(a=new Array(c),Gr(o,t,i.byteLength-o.offset,a)):a=new Uint8Array(c)}else{if("BYTE_STREAM_SPLIT"!==e.encoding)throw new Error(`parquet unsupported encoding: ${e.encoding}`);{const{type_length:t}=n[n.length-1].element;a=Xr(o,c,r,t)}}return{definitionLevels:s,repetitionLevels:u,dataPage:a}}function Kr(t,e,n,r){return Zr({view:new DataView(t.buffer,t.byteOffset,t.byteLength),offset:0},n.type,e.num_values,r)}function Wr(t,e,n){const r=n instanceof Int32Array,i=Mr(t),o=Mr(t);Mr(t);let a=Nr(t),u=0;n[u++]=r?Number(a):a;const s=i/o;for(;u<e;){const i=Nr(t),f=new Uint8Array(o);for(let e=0;e<o;e++)f[e]=t.view.getUint8(t.offset++);for(let c=0;c<o&&u<e;c++){const o=BigInt(f[c]);if(o){let f=0n,c=s;const l=(1n<<o)-1n;for(;c&&u<e;){let e=BigInt(t.view.getUint8(t.offset))>>f&l;for(f+=o;f>=8;)f-=8n,t.offset++,f&&(e|=BigInt(t.view.getUint8(t.offset))<<o-f&l);a+=i+e,n[u++]=r?Number(a):a,c--}c&&(t.offset+=Math.ceil((c*Number(o)+Number(f))/8))}else for(let t=0;t<s&&u<e;t++)a+=i,n[u++]=r?Number(a):a}}}function Jr(t,e,n,r,i){const o={view:new DataView(t.buffer,t.byteOffset,t.byteLength),offset:0},{codec:a,type:u}=r,s=e.data_page_header_v2;if(!s)throw new Error("parquet data page header v2 is undefined");const f=function(t,e,n){const r=Dr(n);if(!r)return[];const i=new Array(e.num_values);return Gr(t,qr(r),e.repetition_levels_byte_length,i),i}(o,s,n);o.offset=s.repetition_levels_byte_length;const c=function(t,e,n){const r=Cr(n);if(r){const n=new Array(e.num_values);return Gr(t,qr(r),e.definition_levels_byte_length,n),n}}(o,s,n),l=e.uncompressed_page_size-s.definition_levels_byte_length-s.repetition_levels_byte_length;let h=t.subarray(o.offset);!1!==s.is_compressed&&(h=ui(h,l,a,i));const p=new DataView(h.buffer,h.byteOffset,h.byteLength),d={view:p,offset:0};let y;const v=s.num_values-s.num_nulls;if("PLAIN"===s.encoding){const{type_length:t}=n[n.length-1].element;y=Zr(d,u,v,t)}else if("RLE"===s.encoding)y=new Array(v),Gr(d,1,0,y),y=y.map((t=>!!t));else if("PLAIN_DICTIONARY"===s.encoding||"RLE_DICTIONARY"===s.encoding){const t=p.getUint8(d.offset++);y=new Array(v),Gr(d,t,l-1,y)}else if("DELTA_BINARY_PACKED"===s.encoding)y="INT32"===u?new Int32Array(v):new BigInt64Array(v),Wr(d,v,y);else if("DELTA_LENGTH_BYTE_ARRAY"===s.encoding)y=new Array(v),function(t,e,n){const r=new Int32Array(e);Wr(t,e,r);for(let i=0;i<e;i++)n[i]=new Uint8Array(t.view.buffer,t.view.byteOffset+t.offset,r[i]),t.offset+=r[i]}(d,v,y);else if("DELTA_BYTE_ARRAY"===s.encoding)y=new Array(v),function(t,e,n){const r=new Int32Array(e);Wr(t,e,r);const i=new Int32Array(e);Wr(t,e,i);for(let o=0;o<e;o++){const e=new Uint8Array(t.view.buffer,t.view.byteOffset+t.offset,i[o]);r[o]?(n[o]=new Uint8Array(r[o]+i[o]),n[o].set(n[o-1].subarray(0,r[o])),n[o].set(e,r[o])):n[o]=e,t.offset+=i[o]}}(d,v,y);else{if("BYTE_STREAM_SPLIT"!==s.encoding)throw new Error(`parquet unsupported encoding: ${s.encoding}`);{const{type_length:t}=n[n.length-1].element;y=Xr(o,v,u,t)}}return{definitionLevels:c,repetitionLevels:f,dataPage:y}}function ti(t){const e=Ar(t);return{type:vr[e.field_1],uncompressed_page_size:e.field_2,compressed_page_size:e.field_3,crc:e.field_4,data_page_header:e.field_5&&{num_values:e.field_5.field_1,encoding:hr[e.field_5.field_2],definition_level_encoding:hr[e.field_5.field_3],repetition_level_encoding:hr[e.field_5.field_4],statistics:e.field_5.field_5&&{max:e.field_5.field_5.field_1,min:e.field_5.field_5.field_2,null_count:e.field_5.field_5.field_3,distinct_count:e.field_5.field_5.field_4,max_value:e.field_5.field_5.field_5,min_value:e.field_5.field_5.field_6}},index_page_header:e.field_6,dictionary_page_header:e.field_7&&{num_values:e.field_7.field_1,encoding:hr[e.field_7.field_2],is_sorted:e.field_7.field_3},data_page_header_v2:e.field_8&&{num_values:e.field_8.field_1,num_nulls:e.field_8.field_2,num_rows:e.field_8.field_3,encoding:hr[e.field_8.field_4],definition_levels_byte_length:e.field_8.field_5,repetition_levels_byte_length:e.field_8.field_6,is_compressed:void 0===e.field_8.field_7||e.field_8.field_7,statistics:e.field_8.field_8}}}const ei=[0,255,65535,16777215,4294967295];function ni(t,e,n,r,i){for(let o=0;o<i;o++)n[r+o]=t[e+o]}function ri(t,e,n,r){for(let i=0;i<r;i++)t[e+i]=t[e-n+i]}function ii(t,e){for(let n=0;n<e.length;n+=1e4)t.push(...e.slice(n,n+1e4))}function oi(t,e,n,r,{compressors:i,utf8:o}){const{element:a}=r[r.length-1];let u,s=0;const f=[];for(;s<e.num_rows;){const e=ti(t),c=new Uint8Array(t.view.buffer,t.view.byteOffset+t.offset,e.compressed_page_size);let l;if("DATA_PAGE"===e.type){const t=e.data_page_header;if(!t)throw new Error("parquet data page header is undefined");const h=ui(c,Number(e.uncompressed_page_size),n.codec,i),{definitionLevels:p,repetitionLevels:d,dataPage:y}=Qr(h,t,r,n);if(s+=t.num_values,l=xr(u,y),l=gr(l,a,o),d.length||p?.length){const t=Cr(r),e=Dr(r),n=r.map((({element:t})=>t.repetition_type));l=jr(p,d,l,n,t,e)}else for(let t=2;t<r.length;t++)"REQUIRED"!==r[t].element.repetition_type&&(l=Array.from(l,(t=>[t])));ii(f,l)}else if("DATA_PAGE_V2"===e.type){const t=e.data_page_header_v2;if(!t)throw new Error("parquet data page header v2 is undefined");const{definitionLevels:h,repetitionLevels:p,dataPage:d}=Jr(c,e,r,n,i);if(s+=t.num_values,l=xr(u,d),l=gr(l,a,o),p.length||h?.length){const t=Cr(r),e=Dr(r),n=r.map((({element:t})=>t.repetition_type));l=jr(h,p,l,n,t,e)}ii(f,l)}else{if("DICTIONARY_PAGE"!==e.type)throw new Error(`parquet unsupported page type: ${e.type}`);{const t=e.dictionary_page_header;if(!t)throw new Error("parquet dictionary page header is undefined");u=Kr(ui(c,Number(e.uncompressed_page_size),n.codec,i),t,n,a.type_length)}}t.offset+=e.compressed_page_size}if(f.length!==Number(e.num_rows))throw new Error(`parquet row data length ${f.length} does not match row group length ${e.num_rows}}`);return f}function ai({dictionary_page_offset:t,data_page_offset:e}){let n=t;return(!t||e<t)&&(n=e),Number(n)}function ui(t,e,n,r){let i;const o=r?.[n];if("UNCOMPRESSED"===n)i=t;else if(o)i=o(t,e);else{if("SNAPPY"!==n)throw new Error(`parquet unsupported compression codec: ${n}`);i=new Uint8Array(e),function(t,e){const n=t.byteLength,r=e.byteLength;let i=0,o=0;for(;i<n;){const e=t[i];if(i++,e<128)break}if(r&&i>=n)throw new Error("invalid snappy length header");for(;i<n;){const r=t[i];let a=0;if(i++,i>=n)throw new Error("missing eof marker");if(3&r){let u=0;switch(3&r){case 1:a=4+(r>>>2&7),u=t[i]+(r>>>5<<8),i++;break;case 2:if(n<=i+1)throw new Error("snappy error end of input");a=1+(r>>>2),u=t[i]+(t[i+1]<<8),i+=2;break;case 3:if(n<=i+3)throw new Error("snappy error end of input");a=1+(r>>>2),u=t[i]+(t[i+1]<<8)+(t[i+2]<<16)+(t[i+3]<<24),i+=4}if(0===u||isNaN(u))throw new Error(`invalid offset ${u} pos ${i} inputLength ${n}`);if(u>o)throw new Error("cannot copy from before start of buffer");ri(e,o,u,a),o+=a}else{let a=1+(r>>>2);if(a>60){if(i+3>=n)throw new Error("snappy error literal pos + 3 >= inputLength");const e=a-60;a=t[i]+(t[i+1]<<8)+(t[i+2]<<16)+(t[i+3]<<24),a=1+(a&ei[e]),i+=e}if(i+a>n)throw new Error("snappy error literal exceeds input length");ni(t,i,e,o,a),i+=a,o+=a}}if(o!==r)throw new Error("premature end of input")}(t,i)}if(i?.length!==e)throw new Error(`parquet decompressed page length ${i?.length} does not match header ${e}`);return i}async function si(t){if(!t.file)throw new Error("parquet file is required");if(t.metadata||=await async function(t,e=1<<19){if(!t)throw new Error("parquet file is required");if(!(t.byteLength>=0))throw new Error("parquet file byteLength is required");const n=Math.max(0,t.byteLength-e),r=await t.slice(n,t.byteLength),i=new DataView(r);if(827474256!==i.getUint32(r.byteLength-4,!0))throw new Error("parquet file invalid (footer != PAR1)");const o=i.getUint32(r.byteLength-8,!0);if(o>t.byteLength-8)throw new Error(`parquet metadata length ${o} exceeds available buffer ${t.byteLength-8}`);if(o+8>e){const e=t.byteLength-o-8,i=await t.slice(e,n),a=new ArrayBuffer(o+8),u=new Uint8Array(a);return u.set(new Uint8Array(i)),u.set(new Uint8Array(r),n-e),Or(a)}return Or(r)}(t.file),!t.metadata)throw new Error("parquet metadata not found");const{metadata:e,onComplete:n,rowEnd:r}=t,i=t.rowStart||0,o=[];let a=0;for(const u of e.row_groups){const e=Number(u.num_rows);if(a+e>=i&&(void 0===r||a<r)){const e=await fi(t,u,a);if(n){const t=Math.max(i-a,0),n=void 0===r?void 0:r-a;ii(o,e.slice(t,n))}}a+=e}n&&n(o)}async function fi(t,e,n){const{file:r,metadata:i,columns:o}=t;if(!i)throw new Error("parquet metadata not found");let a,[u,s]=[r.byteLength,0];if(e.columns.forEach((({meta_data:t})=>{if(!t)throw new Error("parquet column metadata is undefined");if(o&&!o.includes(t.path_in_schema[0]))return;const e=ai(t),n=e+Number(t.total_compressed_size);u=Math.min(u,e),s=Math.max(s,n)})),u>=s&&o?.length)throw new Error(`parquet columns not found: ${o.join(", ")}`);s-u<=1<<25&&(a=await r.slice(u,s));const f=[],c=[],{children:l}=zr(i.schema,[])[0],h=new Map(l.map((t=>[t.element.name,ci(t)]))),p=new Map;for(let s=0;s<e.columns.length;s++){const l=e.columns[s].meta_data;if(!l)throw new Error("parquet column metadata is undefined");const d=l.path_in_schema[0];if(o&&!o.includes(d))continue;const y=ai(l),v=y+Number(l.total_compressed_size),m=v-y;if(m>1<<30){console.warn(`parquet skipping huge column "${l.path_in_schema}" ${m.toLocaleString()} bytes`);continue}let g,_=0;a?(g=Promise.resolve(a),_=y-u):g=Promise.resolve(r.slice(y,v)),c.push(g.then((r=>{const o=zr(i.schema,l.path_in_schema);let a=oi({view:new DataView(r),offset:_},e,l,o,t);const u=l.path_in_schema.join(".");p.set(u,a),a=void 0;const s=h.get(d);if(s?.every((t=>p.has(t)))&&(Ur(p,o[1]),a=p.get(d),!a))throw new Error(`parquet column data not assembled: ${d}`);a&&(t.onChunk?.({columnName:d,columnData:a,rowStart:n,rowEnd:n+a.length}),t.onComplete&&f.push(a))})))}return await Promise.all(c),t.onComplete?f[0].map(((t,e)=>f.map((t=>t[e])))):[]}function ci(t,e=[]){if(t.children.length)for(const n of t.children)ci(n,e);else e.push(t.path.join("."));return e}function li(t){return li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},li(t)}function hi(){hi=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),u=new I(r||[]);return i(a,"_invoke",{value:M(t,n,u)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function _(){}var w={};f(w,a,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,a)&&(w=x);var E=_.prototype=m.prototype=Object.create(w);function A(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(i,o,a,u){var s=l(t[i],t,o);if("throw"!==s.type){var f=s.arg,c=f.value;return c&&"object"==li(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(c).then((function(t){f.value=t,a(f)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function M(e,n,r){var i=h;return function(o,a){if(i===d)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var s=L(u,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var f=l(e,n,r);if("normal"===f.type){if(i=r.done?y:p,f.arg===v)continue;return{value:f.arg,done:r.done}}"throw"===f.type&&(i=y,r.method="throw",r.arg=f.arg)}}}function L(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,L(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var o=l(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(li(e)+" is not iterable")}return g.prototype=_,i(E,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:g,configurable:!0}),g.displayName=f(_,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,f(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},A(T.prototype),f(T.prototype,u,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new T(c(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},A(E),f(E,s,"Generator"),f(E,a,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),f=r.call(a,"finallyLoc");if(s&&f){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function pi(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return di(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?di(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function di(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function yi(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,i)}function vi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mi(r.key),r)}}function mi(t){var e=function(t,e){if("object"!=li(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=li(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==li(e)?e:e+""}function gi(t,e,n){return e=wi(e),function(t,e){if(e&&("object"==li(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_i()?Reflect.construct(e,n||[],wi(t).constructor):e.apply(t,n))}function _i(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_i=function(){return!!t})()}function wi(t){return wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wi(t)}function bi(t,e){return bi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bi(t,e)}var xi=function(t){function e(t,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(i=gi(this,e,[t,n,r,o])).cells=[],i.infoLoadingStatus="notLoaded",i.getData(void 0),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bi(t,e)}(e,t),n=e,r=[{key:"getData",value:function(t){var e,n=this;return"notLoaded"!=this.infoLoadingStatus||(this.infoLoadingStatus="loading",(e=hi().mark((function t(){var e,r;return hi().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(n.url);case 3:return e=t.sent,t.next=6,e.arrayBuffer();case 6:return r=t.sent,t.next=9,si({file:r,onComplete:function(t){for(var e=Or(r).schema,i=[],o=[],a=1;a<e.length;a++){i.push(e[a].name);var u=e[a].type+"",s=u.includes("INT")||"FLOAT"==u||"DOUBLE"==u?"number":"string";o.push(s)}if(t=t.map((function(t){for(var e={},n=0;n<i.length;n++)e[i[n]]=t[n],e[i[n]]="number"==o[n]?Number(t[n]):t[n]+"";return e})),n.preprocess){n.cells=[];var f,c=pi(t);try{for(c.s();!(f=c.n()).done;){var l=f.value;0!=n.preprocess(l)&&n.cells.push(l)}}catch(t){c.e(t)}finally{c.f()}}else n.cells=t;n.map&&n.map.redraw(),n.infoLoadingStatus="loaded"}});case 9:t.next=17;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Could not load data from "+n.url),console.error(t.t0),n.infoLoadingStatus="failed",n.cells=[];case 17:case"end":return t.stop()}}),t,null,[[0,11]])})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(t){yi(o,r,i,a,u,"next",t)}function u(t){yi(o,r,i,a,u,"throw",t)}a(void 0)}))})()),this}},{key:"updateViewCache",value:function(t){if(this.cells){this.cellsViewCache=[];var e,n=pi(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;+r.x+this.resolution<t.xMin||+r.x-this.resolution>t.xMax||+r.y+this.resolution<t.yMin||+r.y-this.resolution>t.yMax||this.cellsViewCache.push(r)}}catch(t){n.e(t)}finally{n.f()}}}}],r&&vi(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(Cn);function Ei(t){return Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ei(t)}function Ai(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ti(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ti(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Ti(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Mi(){Mi=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof m?e:m,a=Object.create(o.prototype),u=new I(r||[]);return i(a,"_invoke",{value:M(t,n,u)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function _(){}var w={};f(w,a,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,a)&&(w=x);var E=_.prototype=m.prototype=Object.create(w);function A(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(i,o,a,u){var s=l(t[i],t,o);if("throw"!==s.type){var f=s.arg,c=f.value;return c&&"object"==Ei(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,a,u)}),(function(t){n("throw",t,a,u)})):e.resolve(c).then((function(t){f.value=t,a(f)}),(function(t){return n("throw",t,a,u)}))}u(s.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function M(e,n,r){var i=h;return function(o,a){if(i===d)throw Error("Generator is already running");if(i===y){if("throw"===o)throw a;return{value:t,done:!0}}for(r.method=o,r.arg=a;;){var u=r.delegate;if(u){var s=L(u,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var f=l(e,n,r);if("normal"===f.type){if(i=r.done?y:p,f.arg===v)continue;return{value:f.arg,done:r.done}}"throw"===f.type&&(i=y,r.method="throw",r.arg=f.arg)}}}function L(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,L(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var o=l(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var a=o.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Ei(e)+" is not iterable")}return g.prototype=_,i(E,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:g,configurable:!0}),g.displayName=f(_,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,f(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},A(T.prototype),f(T.prototype,u,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new T(c(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},A(E),f(E,s,"Generator"),f(E,a,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),f=r.call(a,"finallyLoc");if(s&&f){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function Li(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(t){return void n(t)}u.done?e(s):Promise.resolve(s).then(r,i)}function Ni(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){Li(o,r,i,a,u,"next",t)}function u(t){Li(o,r,i,a,u,"throw",t)}a(void 0)}))}}function Si(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ii(r.key),r)}}function Ii(t){var e=function(t,e){if("object"!=Ei(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Ei(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ei(e)?e:e+""}function Oi(t,e,n){return e=Pi(e),function(t,e){if(e&&("object"==Ei(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ki()?Reflect.construct(e,n||[],Pi(t).constructor):e.apply(t,n))}function ki(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ki=function(){return!!t})()}function Pi(t){return Pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pi(t)}function Ri(t,e){return Ri=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ri(t,e)}var zi=function(t){function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=Oi(this,e,[t,n,0,i])).extension=i.extension||"parquet",r.info=void 0,r.infoLoadingStatus="notLoaded",r.names=void 0,r.types=void 0,r.cache={},r.loadInfo(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ri(t,e)}(e,t),n=e,r=[{key:"loadInfo",value:function(){var t=this;return this.info||"notLoaded"!==this.infoLoadingStatus?"loaded"!==this.infoLoadingStatus&&"failed"!==this.infoLoadingStatus||this.map.redraw():Ni(Mi().mark((function e(){var n;return Mi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Un(t.url+"info.json");case 3:n=e.sent,t.info=n,t.resolution=n.resolutionGeo,t.infoLoadingStatus="loaded",t.map.redraw(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),t.infoLoadingStatus="failed";case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))(),this}},{key:"getTilingEnvelope",value:function(t){if(this.info){var e=this.info.originPoint,n=this.info.resolutionGeo,r=this.info.tileSizeCell;return{xMin:Math.floor((t.xMin-e.x)/(n*r)),xMax:Math.floor((t.xMax-e.x)/(n*r)),yMin:Math.floor((t.yMin-e.y)/(n*r)),yMax:Math.floor((t.yMax-e.y)/(n*r))}}this.loadInfo()}},{key:"getData",value:function(t){var e=this;if(!this.info)return this;var n=this.getTilingEnvelope(t);if(!n)return this;for(var r=this.info.tilingBounds,i=function(t){for(var i=function(n){if(e.cache[t]||(e.cache[t]={}),e.cache[t][n])return 1;e.cache[t][n]="loading",Ni(Mi().mark((function r(){var i,o,a,u,s,f,c,l,h,p,d;return Mi().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,fetch(e.url+t+"/"+n+"."+e.extension);case 3:return o=r.sent,r.next=6,o.arrayBuffer();case 6:return a=r.sent,r.next=9,si({file:a,onComplete:function(t){if(!e.names&&!e.types){var n=Or(a).schema;e.names=[],e.types=[];for(var r=1;r<n.length;r++){e.names.push(n[r].name);var o=n[r].type+"",u=o.includes("INT")||"FLOAT"==o||"DOUBLE"==o?"number":"string";e.types.push(u)}}if(t=t.map((function(t){for(var n={},r=0;r<e.names.length;r++)n[e.names[r]]=t[r],n[e.names[r]]="number"==e.types[r]?Number(t[r]):t[r]+"";return n})),e.preprocess){i=[];var s,f=Ai(t);try{for(f.s();!(s=f.n()).done;){var c=s.value;0!=e.preprocess(c)&&i.push(c)}}catch(t){f.e(t)}finally{f.f()}}else i=t}});case 9:r.next=15;break;case 11:return r.prev=11,r.t0=r.catch(0),e.cache[t][n]="failed",r.abrupt("return");case 15:if(e.info){r.next=18;break}return console.error("Tile info inknown"),r.abrupt("return");case 18:u=Di(i,t,n,e.info),e.cache[t][n]=u,e.map.redraw(),s=!1,f=e.map.getZoom(),c=Ai(e.map.layers),r.prev=24,c.s();case 26:if((l=c.n()).done){r.next=38;break}if(!(h=l.value).visible||h.visible(f)){r.next=30;break}return r.abrupt("continue",36);case 30:if(h.getDataset){r.next=32;break}return r.abrupt("continue",36);case 32:if(h.getDataset(f)==e){r.next=34;break}return r.abrupt("continue",36);case 34:return s=!0,r.abrupt("break",38);case 36:r.next=26;break;case 38:r.next=43;break;case 40:r.prev=40,r.t1=r.catch(24),c.e(r.t1);case 43:return r.prev=43,c.f(),r.finish(43);case 46:if(s){r.next=48;break}return r.abrupt("return");case 48:if(p=e.map.updateExtentGeo(),d=u.extGeo,!(p.xMax<=d.xMin)){r.next=52;break}return r.abrupt("return");case 52:if(!(p.xMin>=d.xMax)){r.next=54;break}return r.abrupt("return");case 54:if(!(p.yMax<=d.yMin)){r.next=56;break}return r.abrupt("return");case 56:if(!(p.yMin>=d.yMax)){r.next=58;break}return r.abrupt("return");case 58:e.map.redraw();case 59:case"end":return r.stop()}}),r,null,[[0,11],[24,40,43,46]])})))()},o=Math.max(n.yMin,r.yMin);o<=Math.min(n.yMax,r.yMax);o++)i(o)},o=Math.max(n.xMin,r.xMin);o<=Math.min(n.xMax,r.xMax);o++)i(o);return this}},{key:"updateViewCache",value:function(t){if(this.cellsViewCache=[],this.info){var e=this.getTilingEnvelope(t);if(e)for(var n=this.info.tilingBounds,r=Math.max(e.xMin,n.xMin);r<=Math.min(e.xMax,n.xMax);r++)if(this.cache[r])for(var i=Math.max(e.yMin,n.yMin);i<=Math.min(e.yMax,n.yMax);i++){var o=this.cache[r][i];if(o&&"string"!=typeof o){var a,u=Ai(o.cells);try{for(u.s();!(a=u.n()).done;){var s=a.value;+s.x+this.resolution<t.xMin||+s.x-this.resolution>t.xMax||+s.y+this.resolution<t.yMin||+s.y-this.resolution>t.yMax||this.cellsViewCache.push(s)}}catch(t){u.e(t)}finally{u.f()}}}}}}],r&&Si(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(Cn);function Di(t,e,n,r){var i={};i.cells=t,i.x=e,i.y=n;var o=r.resolutionGeo,a=r.tileSizeCell;i.extGeo={xMin:r.originPoint.x+o*a*i.x,xMax:r.originPoint.x+o*a*(i.x+1),yMin:r.originPoint.y+o*a*i.y,yMax:r.originPoint.y+o*a*(i.y+1)};var u,s=Ai(i.cells);try{for(s.s();!(u=s.n()).done;){var f=u.value;f.x=i.extGeo.xMin+f.x*o,f.y=i.extGeo.yMin+f.y*o}}catch(t){s.e(t)}finally{s.f()}return i}return e})()));